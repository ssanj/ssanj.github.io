<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Why are Default Parameter Values Considered Bad in Scala?</title>
    <meta name="viewport" content="width=device-width">
    
    <meta name="description" content="What are the pitfalls of using Default Parameter Values or default arguments?">
    
    <link rel="canonical" href="https://blog.ssanj.net/posts/2019-05-01-why-are-default-parameter-values-considered-bad-in-scala.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/main-2023-05-31.css">
    <link rel="stylesheet" href="../css/syntax-2020-09-17.css">
    <link rel="stylesheet" type="text/css" href="../css/example.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    
  </head>

    <body>
      
          <div class="page-content">
      <div class="wrap">
        <div class="post">
          <header class="post-header">
            <h1><a href="../">Why are Default Parameter Values Considered Bad in Scala?</a></h1>
            <p class="meta">May  1, 2019&nbsp;<span class="post-tag"><a title="All pages tagged 'scala'." href="../tags/scala.html">scala</a>, <a title="All pages tagged 'linting'." href="../tags/linting.html">linting</a>, <a title="All pages tagged 'wartremover'." href="../tags/wartremover.html">wartremover</a></span></p>
          </header>
          <article class="post-content">
            <p>There is a very long issue under <a href="https://github.com/wartremover">Wartremover</a> titled: <a href="https://github.com/wartremover/wartremover/issues/116">"Default arguments are insane" needs explanation</a>. Wartremover is a Scala linter that I personally love using as it definitely increases the quality of any Scala code I write.</p>
<p>The issues around using Default Arguments or
<a href="https://docs.scala-lang.org/tour/default-parameter-values.html">Default Parameter Values</a> (as Scala refers to them) are somewhat subtle. The Wartemover issue seems to go on forever, but there are lots of really great ideas in there and I though I could summarise some of them here.</p>
<h3 id="what-is-a-default-parameter-value">What is a Default Parameter Value?</h3>
<blockquote>
<p>Scala provides the ability to give parameters default values that can be used to allow a caller to omit those parameters.</p>
</blockquote>
<p>Here’s a quick example of Default Parameter Values (DPV):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">log</span><span class="op">(</span>message<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> level<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> <span class="st">&quot;INFO&quot;</span><span class="op">)</span> <span class="op">=</span> <span class="fu">println</span><span class="op">(</span><span class="ss">s&quot;$level</span><span class="st">: </span><span class="ss">$message&quot;</span><span class="op">)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span><span class="op">(</span><span class="st">&quot;System starting&quot;</span><span class="op">)</span>  <span class="co">//We didn't supply level which defaults to INFO; prints INFO: System starting</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span><span class="op">(</span><span class="st">&quot;User not found&quot;</span><span class="op">,</span> <span class="st">&quot;WARNING&quot;</span><span class="op">)</span>  <span class="co">// prints </span><span class="al">WARNING</span><span class="co">: User not found</span></span></code></pre></div>
<p>One of the main benefits of DPV is that you don’t need to supply all the parameters to a method - just the ones that are mandatory. This sounds like a really useful idea, so why are people recommending that we don’t use it?</p>
<h3 id="issues">Issues</h3>
<h4 id="unclear-code">1. Unclear Code</h4>
<p>Here’s an example of some code that uses DPV:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> streamName<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> <span class="op">...</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>KinesisStream<span class="op">.</span><span class="fu">fromUrl</span><span class="op">(</span>streamName<span class="op">)</span></span></code></pre></div>
<p>Now if you just read the above method it looks like it might be doing the wrong thing. Why are we supplying a Stream name to a method that clearly states that it needs a Url?</p>
<p>The method is defined as:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">object</span> KinesisStream <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">fromUrl</span><span class="op">(</span>streamName<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> url<span class="op">:</span> <span class="ex">Option</span><span class="op">[</span><span class="ex">String</span><span class="op">]</span> <span class="op">=</span> <span class="bu">None</span><span class="op">):</span> <span class="op">...</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>The default value for <code>url</code> hides the true nature of what this method needs. The <code>url</code> parameter has been made optional because under some circumstances it is not needed.</p>
<h4 id="breaks-currying-and-partial-application">2. <del>Breaks Currying and Partial Application</del></h4>
<p><a href="https://twitter.com/tpolecat">Rob Norris</a> has a nice article on <a href="https://tpolecat.github.io/2014/06/09/methods-functions.html">Methods are not Functions</a> which covers why currying and partial Application of Functions is broken with DPV. Here’s a simple example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">log</span><span class="op">(</span>message<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> level<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> <span class="st">&quot;INFO&quot;</span><span class="op">)</span> <span class="op">=</span> <span class="fu">println</span><span class="op">(</span><span class="ss">s&quot;$level</span><span class="st">: </span><span class="ss">$message&quot;</span><span class="op">)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">log</span><span class="op">(</span><span class="st">&quot;hello!&quot;</span><span class="op">)</span> <span class="co">//one param</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>INFO<span class="op">:</span> hello<span class="op">!</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">log</span><span class="op">(</span><span class="st">&quot;hello!&quot;</span><span class="op">,</span> <span class="st">&quot;WARN&quot;</span><span class="op">)</span> <span class="co">//both params</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>WARN<span class="op">:</span> hello<span class="op">!</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">//can we map over log?</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> messages <span class="op">=</span> <span class="ex">List</span><span class="op">(</span><span class="st">&quot;hello&quot;</span><span class="op">,</span> <span class="st">&quot;world&quot;</span><span class="op">)</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>messages<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="ex">String</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span>hello<span class="op">,</span> world<span class="op">)</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a> <span class="co">//does not work</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> messages<span class="op">.</span><span class="fu">map</span><span class="op">(</span>log<span class="op">)</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>console<span class="op">&gt;:</span><span class="dv">14</span><span class="op">:</span> error<span class="op">:</span> <span class="kw">type</span> mismatch<span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a> found   <span class="op">:</span> <span class="op">(</span><span class="ex">String</span><span class="op">,</span> <span class="ex">String</span><span class="op">)</span> <span class="op">=&gt;</span> <span class="bu">Unit</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a> required<span class="op">:</span> <span class="ex">String</span> <span class="op">=&gt;</span> <span class="op">?</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>       messages<span class="op">.</span><span class="fu">map</span><span class="op">(</span>log<span class="op">)</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                    <span class="op">^</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a> <span class="co">//does not work</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> messages<span class="op">.</span><span class="fu">map</span><span class="op">(</span>log _<span class="op">)</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>console<span class="op">&gt;:</span><span class="dv">14</span><span class="op">:</span> error<span class="op">:</span> <span class="kw">type</span> mismatch<span class="op">;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a> found   <span class="op">:</span> <span class="op">(</span><span class="ex">String</span><span class="op">,</span> <span class="ex">String</span><span class="op">)</span> <span class="op">=&gt;</span> <span class="bu">Unit</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a> required<span class="op">:</span> <span class="ex">String</span> <span class="op">=&gt;</span> <span class="op">?</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>       messages<span class="op">.</span><span class="fu">map</span><span class="op">(</span>log _<span class="op">)</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">//works!</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> messages<span class="op">.</span><span class="fu">map</span><span class="op">(</span><span class="fu">log</span><span class="op">(</span>_<span class="op">))</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>INFO<span class="op">:</span> hello</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>INFO<span class="op">:</span> world</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>res6<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="bu">Unit</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">((),</span> <span class="op">())</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co">//also works</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> messages<span class="op">.</span><span class="fu">map</span><span class="op">(</span>x <span class="op">=&gt;</span> <span class="fu">log</span><span class="op">(</span>x<span class="op">))</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>INFO<span class="op">:</span> hello</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>INFO<span class="op">:</span> world</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>res7<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="bu">Unit</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">((),</span> <span class="op">())</span></span></code></pre></div>
<p>Weird. So it seems like you can use Currying and Partial Application if you tweak the syntax a little.</p>
<p>Let’s have a go with Rob’s example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">def</span> <span class="fu">foo</span><span class="op">(</span>n<span class="op">:</span> <span class="bu">Int</span> <span class="op">=</span> <span class="dv">3</span><span class="op">,</span> s<span class="op">:</span> <span class="ex">String</span><span class="op">)</span> <span class="op">=</span> s <span class="op">*</span> n</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>foo<span class="op">:</span> <span class="op">(</span>n<span class="op">:</span> <span class="bu">Int</span><span class="op">,</span> s<span class="op">:</span> <span class="ex">String</span><span class="op">)</span><span class="ex">String</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">//works</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">foo</span><span class="op">(</span>s <span class="op">=</span> <span class="st">&quot;$$&quot;</span><span class="op">)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>res36<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> $$$$$$</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">//works</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> p1 <span class="op">=</span> <span class="fu">foo</span><span class="op">(</span><span class="dv">42</span><span class="op">,</span> _<span class="op">:</span><span class="ex">String</span><span class="op">)</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>p1<span class="op">:</span> <span class="ex">String</span> <span class="op">=&gt;</span> <span class="ex">String</span> <span class="op">=</span> $$Lambda$<span class="dv">1192</span><span class="op">/</span><span class="dv">1172016038</span>@6c826924</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">p1</span><span class="op">(</span><span class="st">&quot;@&quot;</span><span class="op">)</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>res38<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">//can we get defaults for free after conversion to a function?</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> f1 <span class="op">=</span> foo _</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>f1<span class="op">:</span> <span class="op">(</span><span class="bu">Int</span><span class="op">,</span> <span class="ex">String</span><span class="op">)</span> <span class="op">=&gt;</span> <span class="ex">String</span> <span class="op">=</span> $$Lambda$<span class="dv">1193</span><span class="op">/</span><span class="dv">1526085518</span>@205b3a1a</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">//does not work</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">f1</span><span class="op">(</span><span class="dv">10</span><span class="op">)</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>console<span class="op">&gt;:</span><span class="dv">13</span><span class="op">:</span> error<span class="op">:</span> not enough arguments <span class="cf">for</span> method apply<span class="op">:</span> <span class="op">(</span>v1<span class="op">:</span> <span class="bu">Int</span><span class="op">,</span> v2<span class="op">:</span> <span class="ex">String</span><span class="op">)</span><span class="ex">String</span> in <span class="kw">trait</span> Function2<span class="op">.</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>Unspecified value parameter v2<span class="op">.</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>       <span class="fu">f1</span><span class="op">(</span><span class="dv">10</span><span class="op">)</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">//works</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> p2 <span class="op">=</span> <span class="fu">f1</span><span class="op">(</span><span class="dv">10</span><span class="op">,</span> _<span class="op">:</span> <span class="ex">String</span><span class="op">)</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>p2<span class="op">:</span> <span class="ex">String</span> <span class="op">=&gt;</span> <span class="ex">String</span> <span class="op">=</span> $$Lambda$<span class="dv">1408</span><span class="op">/</span><span class="dv">1660635397</span>@7f8ac326</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">p2</span><span class="op">(</span><span class="st">&quot;*&quot;</span><span class="op">)</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>res44<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> <span class="op">**********</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> p3 <span class="op">=</span> <span class="fu">f1</span><span class="op">(</span>_<span class="op">:</span><span class="bu">Int</span><span class="op">,</span> <span class="st">&quot;$&quot;</span><span class="op">)</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>p3 <span class="op">=&gt;</span> <span class="ex">String</span> <span class="op">=</span> $$Lambda$<span class="dv">1409</span><span class="op">/</span><span class="dv">1435397638</span>@4047789d</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">p3</span><span class="op">(</span><span class="dv">5</span><span class="op">)</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>res48<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> $$$$$</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co">//we can also supply all arguments</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">f1</span><span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="st">&quot;*&quot;</span><span class="op">)</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>res50<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> <span class="op">**********</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="co">//use in higher-order functions</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> messages<span class="op">.</span><span class="fu">map</span><span class="op">(</span>p1<span class="op">)</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>res51<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="ex">String</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span>hellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohello<span class="op">,</span> worldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworld<span class="op">)</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> messages<span class="op">.</span><span class="fu">map</span><span class="op">(</span>p2<span class="op">)</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>res52<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="ex">String</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span>hellohellohellohellohellohellohellohellohellohello<span class="op">,</span> worldworldworldworldworldworldworldworldworldworld<span class="op">)</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="ex">List</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">).</span><span class="fu">map</span><span class="op">(</span>p3<span class="op">)</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>res53<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="ex">String</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span>$<span class="op">,</span> $$<span class="op">,</span> $$$<span class="op">)</span></span></code></pre></div>
<p>This seems to be a moot issue. While the syntax is more awkward than necessary, Currying and Partial Application is certainly possible with DPV. Once we η-expand the method <code>foo</code> to the value <code>f1</code>, we lose the defaulted values defined in <code>foo</code> though; which seems a little odd.</p>
<p>Another way to partially apply methods with default parameters is create a wrapper method with only the mandatory fields:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">def</span> <span class="fu">foo</span><span class="op">(</span>n<span class="op">:</span> <span class="bu">Int</span> <span class="op">=</span> <span class="dv">3</span><span class="op">,</span> s<span class="op">:</span> <span class="ex">String</span><span class="op">)</span> <span class="op">=</span> s <span class="op">*</span> n</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>foo<span class="op">:</span> <span class="op">(</span>n<span class="op">:</span> <span class="bu">Int</span><span class="op">,</span> s<span class="op">:</span> <span class="ex">String</span><span class="op">)</span><span class="ex">String</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">//wrap foo with foo2</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">def</span> <span class="fu">foo2</span><span class="op">(</span>s<span class="op">:</span> <span class="ex">String</span><span class="op">)</span> <span class="op">=</span> <span class="fu">foo</span><span class="op">(</span>s <span class="op">=</span> s<span class="op">)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>foo2<span class="op">:</span> <span class="op">(</span>s<span class="op">:</span> <span class="ex">String</span><span class="op">)</span><span class="ex">String</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="fu">foo2</span><span class="op">(</span><span class="st">&quot;#&quot;</span><span class="op">)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>res29<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> ###</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">//now we can use foo2 in higher-order functions</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> messages<span class="op">.</span><span class="fu">map</span><span class="op">(</span>foo2<span class="op">)</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>res30<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="ex">String</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span>hellohellohello<span class="op">,</span> worldworldworld<span class="op">)</span></span></code></pre></div>
<p>The above technique alludes that there should have been two separate methods all along.</p>
<h4 id="bugs-of-convenience">3. Bugs of Convenience</h4>
<p>In a project I worked on we had some asynchronous tasks that split a workload into chunks using a sliding window of ten elements. Here’s a simplified version of the code:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> elements <span class="op">=</span> <span class="op">(</span><span class="dv">1</span> to <span class="dv">30</span><span class="op">).</span>toList</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>elements<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="bu">Int</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">16</span><span class="op">,</span> <span class="dv">17</span><span class="op">,</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">19</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">21</span><span class="op">,</span> <span class="dv">22</span><span class="op">,</span> <span class="dv">23</span><span class="op">,</span> <span class="dv">24</span><span class="op">,</span> <span class="dv">25</span><span class="op">,</span> <span class="dv">26</span><span class="op">,</span> <span class="dv">27</span><span class="op">,</span> <span class="dv">28</span><span class="op">,</span> <span class="dv">29</span><span class="op">,</span> <span class="dv">30</span><span class="op">)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> it <span class="op">=</span> elements<span class="op">.</span><span class="fu">sliding</span><span class="op">(</span><span class="dv">10</span><span class="op">)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>it<span class="op">:</span> <span class="ex">Iterator</span><span class="op">[</span><span class="ex">List</span><span class="op">[</span><span class="bu">Int</span><span class="op">]]</span> <span class="op">=</span> non<span class="op">-</span>empty iterator</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> it<span class="op">.</span>next</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>res22<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="bu">Int</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">10</span><span class="op">)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>it<span class="op">.</span>next <span class="op">???</span> <span class="co">//what does this print?</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>it<span class="op">.</span>next <span class="op">???</span> <span class="co">//what does this print?</span></span></code></pre></div>
<p>We witnessed a subtle bug where performance of our processing pipeline was terrible. What was going on?</p>
<p>The actual definition of <code>sliding</code> is:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sliding<span class="op">[</span>B <span class="op">&gt;:</span> A<span class="op">](</span>size<span class="op">:</span> <span class="bu">Int</span><span class="op">,</span> step<span class="op">:</span> <span class="bu">Int</span> <span class="op">=</span> <span class="dv">1</span><span class="op">):</span> GroupedIterator<span class="op">[</span>B<span class="op">]</span></span></code></pre></div>
<p>Notice the default <strong>step</strong> of 1. When we used the <code>sliding</code> function we assumed that the <code>size</code> supplied would also be the step. Everything compiled and there were no warnings. Here is the output of the above example:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> it<span class="op">.</span>next</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>res22<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="bu">Int</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">10</span><span class="op">)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> it<span class="op">.</span>next</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>res23<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="bu">Int</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">11</span><span class="op">)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> it<span class="op">.</span>next</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>res24<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="bu">Int</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">12</span><span class="op">)</span></span></code></pre></div>
<p>As you can see we were processing the same items multiple times. If the <code>step</code> parameter were explicit this would not have happened. Once the mistake was corrected:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> <span class="kw">val</span> it <span class="op">=</span> elements<span class="op">.</span><span class="fu">sliding</span><span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>it<span class="op">:</span> <span class="ex">Iterator</span><span class="op">[</span><span class="ex">List</span><span class="op">[</span><span class="bu">Int</span><span class="op">]]</span> <span class="op">=</span> non<span class="op">-</span>empty iterator</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> it<span class="op">.</span>next</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>res25<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="bu">Int</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">10</span><span class="op">)</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> it<span class="op">.</span>next</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>res26<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="bu">Int</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">16</span><span class="op">,</span> <span class="dv">17</span><span class="op">,</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">19</span><span class="op">,</span> <span class="dv">20</span><span class="op">)</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>scala<span class="op">&gt;</span> it<span class="op">.</span>next</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>res27<span class="op">:</span> <span class="ex">List</span><span class="op">[</span><span class="bu">Int</span><span class="op">]</span> <span class="op">=</span> <span class="ex">List</span><span class="op">(</span><span class="dv">21</span><span class="op">,</span> <span class="dv">22</span><span class="op">,</span> <span class="dv">23</span><span class="op">,</span> <span class="dv">24</span><span class="op">,</span> <span class="dv">25</span><span class="op">,</span> <span class="dv">26</span><span class="op">,</span> <span class="dv">27</span><span class="op">,</span> <span class="dv">28</span><span class="op">,</span> <span class="dv">29</span><span class="op">,</span> <span class="dv">30</span><span class="op">)</span></span></code></pre></div>
<p>We can see the code slides over ten elements at a time as expected. These kind of bugs are hard to find. We lean on the compiler a lot to point out our mistakes. With DPV while our lives are more convenient because we have less parameters to supply our functions, the compiler fails to see our errors and omissions and can’t help.</p>
<h4 id="bugs-due-to-refactoring">4. Bugs due to Refactoring</h4>
<p>Consider an API at version 1.x that has the following method:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">object</span> Database</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">fromUrl</span><span class="op">(</span>url<span class="op">:</span> <span class="ex">String</span><span class="op">):</span> <span class="op">...</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>A client of the library may use it like:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Database<span class="op">.</span><span class="fu">fromUrl</span><span class="op">(</span><span class="st">&quot;someUrl&quot;</span><span class="op">)</span></span></code></pre></div>
<p>The developer of the library decides to add a <code>tableName</code> parameter as the <code>url</code> is optional when run locally.
Not wanting to introduce an additional method for this our developer then decides to make <code>url</code> a DPV.</p>
<p>As this is a breaking change, he bumps the version of the library to 2.x.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">object</span> Database <span class="op">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">fromUrl</span><span class="op">(</span>tableName<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> url<span class="op">:</span> <span class="ex">Option</span><span class="op">[</span><span class="ex">String</span><span class="op">]</span> <span class="op">=</span> <span class="bu">None</span><span class="op">):</span> <span class="op">...</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Now this all seems fine. The major version of the library has been bumped so it indicates potential for a breaking change.</p>
<p>Unfortunately, the client code still compiles after moving to version 2.x of the library:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Database<span class="op">.</span><span class="fu">fromUrl</span><span class="op">(</span><span class="st">&quot;someUrl&quot;</span><span class="op">)</span></span></code></pre></div>
<p>But now we have problem. Since the location of the <code>url</code> parameter has changed, we are supplying a url as the <code>tableName</code> parameter, and the compiler can’t inform us that anything is broken. We have to find out at runtime that we have a problem.</p>
<h3 id="alternate-designs">Alternate Designs</h3>
<p>Here are some ways to get around using DPV.</p>
<h4 id="supply-all-parameters">Supply all Parameters</h4>
<p>Replace developer convenience for software correctness. Get the developer to supply all parameters. We can change the <code>log</code> function from:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">log</span><span class="op">(</span>message<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> level<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> <span class="st">&quot;INFO&quot;</span><span class="op">)</span> <span class="op">=</span> <span class="fu">println</span><span class="op">(</span><span class="ss">s&quot;$level</span><span class="st">: </span><span class="ss">$message&quot;</span><span class="op">)</span></span></code></pre></div>
<p>to:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">log</span><span class="op">(</span>message<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> level<span class="op">:</span> <span class="ex">String</span><span class="op">)</span> <span class="op">=</span> <span class="fu">println</span><span class="op">(</span><span class="ss">s&quot;$level</span><span class="st">: </span><span class="ss">$message&quot;</span><span class="op">)</span></span></code></pre></div>
<p>Callers of the <code>log</code> method have to now supply both the <code>message</code> and the <code>level</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span><span class="op">(</span><span class="st">&quot;System starting&quot;</span><span class="op">,</span> <span class="st">&quot;INFO&quot;</span><span class="op">)</span></span></code></pre></div>
<p>Better yet, convert the <code>level</code> parameter to an ADT so that the callers can’t pass through invalid values.</p>
<p>However this technique can get tedious if you have a lot of parameters that you don’t really care about.</p>
<h4 id="breakout-separate-methods">Breakout Separate Methods</h4>
<p>If you don’t want to supply all the parameters each time, consider creating separate methods for the situations you care about.</p>
<p>In the case of the bug with the Database refactoring, we could have pulled out some extra methods:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">object</span> Database <span class="op">{</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">remote</span><span class="op">(</span>url<span class="op">:</span> DatabaseUrl<span class="op">):</span> <span class="op">...</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">remoteWithTable</span><span class="op">(</span>tableName<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> url<span class="op">:</span> DatabaseUrl<span class="op">):</span> <span class="op">...</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">local</span><span class="op">(</span>tableName<span class="op">:</span> <span class="ex">String</span><span class="op">):</span> <span class="op">...</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><a href="https://github.com/wartremover/wartremover/issues/116#issuecomment-51173792">Rob Norris on splitting out methods</a>:</p>
<blockquote>
<p>If you have a method with a single default arg you could reasonably suggest splitting it into two methods (as you might do with a single option or boolean arg)</p>
</blockquote>
<h4 id="have-a-default-object">Have a Default Object</h4>
<p>If you have a lot of parameters to your function (and this might be a problem by itself) you could use a default object.</p>
<p>Take <code>tcpConnect</code> as an example:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">tcpConnect</span><span class="op">(</span>host<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> port<span class="op">:</span> <span class="bu">Int</span> <span class="op">=</span> <span class="dv">80</span><span class="op">,</span> sslEncryption<span class="op">:</span> <span class="ex">Boolean</span> <span class="op">=</span> <span class="kw">false</span><span class="op">,</span> localAddress<span class="op">:</span> <span class="ex">Option</span><span class="op">[</span><span class="ex">String</span><span class="op">]</span> <span class="op">=</span> <span class="bu">None</span><span class="op">):</span>  <span class="ex">String</span> <span class="op">=</span> <span class="st">&quot;connected&quot;</span></span></code></pre></div>
<p>This could be re-written with a default object:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">//original method with defaults removed</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">tcpConnect</span><span class="op">(</span>host<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> port<span class="op">:</span> <span class="bu">Int</span><span class="op">,</span> sslEncryption<span class="op">:</span> <span class="ex">Boolean</span><span class="op">,</span> localAddress<span class="op">:</span> <span class="ex">Option</span><span class="op">[</span><span class="ex">String</span><span class="op">]):</span>  <span class="ex">String</span> <span class="op">=</span> <span class="st">&quot;connected&quot;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">//config class</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">class</span> <span class="fu">TcpConnection</span><span class="op">(</span>host<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> port<span class="op">:</span> <span class="bu">Int</span><span class="op">,</span> sslEncryption<span class="op">:</span> <span class="ex">Boolean</span><span class="op">,</span> localAddress<span class="op">:</span> <span class="ex">Option</span><span class="op">[</span><span class="ex">String</span><span class="op">])</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">//function that calls tcpConnect</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">fromTcpConnection</span><span class="op">(</span>tcpConnection<span class="op">:</span> TcpConnection<span class="op">):</span> <span class="ex">String</span> <span class="op">=</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tcpConnect</span><span class="op">(</span>tcpConnection<span class="op">.</span>host<span class="op">,</span> tcpConnection<span class="op">.</span>port<span class="op">,</span> tcpConnection<span class="op">.</span>sslEncryption<span class="op">,</span> tcpConnection<span class="op">.</span>localAddress<span class="op">)</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">//default object</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> defaultTcpConnection<span class="op">:</span> TcpConnection <span class="op">=</span> <span class="fu">TcpConnction</span><span class="op">(</span>host<span class="op">:</span> <span class="ex">String</span> <span class="op">=</span> <span class="st">&quot;localhost&quot;</span><span class="op">,</span> port<span class="op">:</span> <span class="bu">Int</span> <span class="op">=</span> <span class="dv">80</span><span class="op">,</span> sslEncryption<span class="op">:</span> <span class="ex">Boolean</span> <span class="op">=</span> <span class="kw">false</span><span class="op">,</span> localAddress<span class="op">:</span> <span class="ex">Option</span><span class="op">[</span><span class="ex">String</span><span class="op">]</span> <span class="op">=</span> <span class="bu">None</span><span class="op">)</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">//usage for a specific URL</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">fromTcpConnection</span><span class="op">(</span>defaultTcpConnection<span class="op">.</span><span class="fu">copy</span><span class="op">(</span>host <span class="op">=</span> <span class="st">&quot;http://....&quot;</span><span class="op">))</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">//usage for a specific port</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="fu">fromTcpConnection</span><span class="op">(</span>defaultTcpConnection<span class="op">.</span><span class="fu">copy</span><span class="op">(</span>port <span class="op">=</span> <span class="dv">8080</span><span class="op">))</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">//usage for a secure URL</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="fu">fromTcpConnection</span><span class="op">(</span>defaultTcpConnection<span class="op">.</span><span class="fu">copy</span><span class="op">(</span>host <span class="op">=</span> <span class="st">&quot;https://...&quot;</span><span class="op">,</span> port <span class="op">=</span> <span class="dv">443</span><span class="op">,</span> sslEncryption <span class="op">=</span> <span class="kw">true</span><span class="op">))</span></span></code></pre></div>
<p><a href="https://github.com/wartremover/wartremover/issues/116#issuecomment-51173792">Rob Norris on using default config objects</a>:</p>
<blockquote>
<p>… right, but then you have the awful copy method to contend with, then you add lenses, then you add phantom types to ensure that options haven’t been set more than once, etc., etc., and I’m not convinced that the complexity is warranted, given the lack thus far of any convincing reason not to use default args</p>
</blockquote>
<p>As Rob mentions, depending on how far you want to take it, avoiding DPVs might lead to very complex solutions.</p>
<p>As <a href="https://github.com/wartremover/wartremover/issues/116#issuecomment-51172733">Maxwell Swadling points out</a> you could also break out separate methods for this:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">connectHTTP</span><span class="op">(</span>host<span class="op">:</span> <span class="ex">String</span><span class="op">):</span>  <span class="ex">String</span> <span class="co">//where port = 80, sslEncryption = false, localAddress = None</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">connectHTTPPort</span><span class="op">(</span>host<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> port<span class="op">:</span> <span class="bu">Int</span><span class="op">):</span>  <span class="ex">String</span> <span class="co">//where sslEncryption = false, localAddress = None</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">connectHTTPS</span><span class="op">(</span>host<span class="op">:</span> <span class="ex">String</span><span class="op">):</span>  <span class="ex">String</span> <span class="co">//where port = 443, sslEncryption = true, , localAddress = None</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">tcpConnect</span><span class="op">(</span>host<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> port<span class="op">:</span> <span class="bu">Int</span><span class="op">,</span> sslEncryption<span class="op">:</span> <span class="ex">Boolean</span><span class="op">,</span> localAddress<span class="op">:</span> <span class="ex">Option</span><span class="op">[</span><span class="ex">String</span><span class="op">]):</span>  <span class="ex">String</span> <span class="co">//the normal connect with all the arguments.</span></span></code></pre></div>
<p>If none of these alternates seem attractive, go ahead and use DPV but think hard about how it may introduce bugs into your code base.</p>
<h3 id="parting-thoughts">Parting Thoughts</h3>
<p><a href="https://twitter.com/markhibberd">Mark Hibberd</a> recommends not using DPV for the <a href="https://github.com/wartremover/wartremover/issues/116#issuecomment-51326211">following</a>:</p>
<ol type="1">
<li><strong>Allocation of resources</strong> (there are even examples of this in scalaz) - which is utterly wrong. Anything that is allocated by a default argument has no reasonable lifecycle and is unlikely (or impossible) to be closed properly.</li>
<li><strong>Default configurations</strong> - these are a developer convenience that lead to operational bugs. There is no such thing as a “safe” default, where it could mean forgetting to set something in production leads to an incorrect value rather than an error (this is closely related to what Minsky says as mentioned by Eric above).</li>
<li><strong>Common arguments through delegating methods</strong> - these are representative of what <span class="citation" data-cites="maxpow4h">@maxpow4h</span> originally stated. That if you have multiple methods with optional arguments, it is extremely easy for incorrect code to compile by forgetting to delegate one of the arguments.</li>
<li><strong>Faux overloading</strong> - it is cool to hate on overloading so I will avoid it by using named arguments with defaults, ending up with the exact same situation. Code that is subtly wrong (such as forgetting to pass argument) still compiles. This is not an acceptable situation.</li>
</ol>
<p><a href="https://github.com/wartremover/wartremover/issues/116#issuecomment-51268242">Eric Torreborre on when to use DPV</a>:</p>
<blockquote>
<p>So my own conclusion is that default arguments (and overloading) still have some value (for non-critical DSLs) but you need to be very careful where you use them.</p>
</blockquote>
<p><a href="https://github.com/wartremover/wartremover/issues/116#issuecomment-51280344">Mark Hibberd on focussing on correct programs</a>:</p>
<blockquote>
<p>But the most troublesome part of this thread, is that almost all of the discussion is about what developers find “convenient” and aesthetically pleasing, when we should be asking how a language feature adds or removes from our ability to build robust, correct programs - and, as quickly as possible. When held in this light, default arguments do not hold up. They are a mere syntactic convenience - that does not help us with this goal. This might be ok, if they didn’t come with risk or issues, but even the gentler arguments in this thread should be enough to highlight their use in a linting tool - especially given their inherent lack of motivation to begin with.</p>
</blockquote>
<blockquote>
<p>But yeh. Everyone gets to live in their own teams codebases. I just prefer mine without these undue risks.</p>
</blockquote>
<p>So in summary:</p>
<ol type="1">
<li>Don’t use DPV in production code. This could lead to bugs that are hard to find</li>
<li>Possibly use DPV in non-production code like such as test DSLs</li>
<li>If DPV helps to reduce the number of methods or the complexity of your solution, consider using it but be aware of the consequences. Alternatively redesign your code so it does not require DPV.</li>
</ol>
          </article>
        </div>
        
          <div id="disqus_thread"></div>
          <script>
              /**
              *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
              *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */

              var disqus_config = function () {
              this.page.url = 'https://ssanj.github.io' + '/posts/2019-05-01-why-are-default-parameter-values-considered-bad-in-scala.html';
              this.page.identifier = '/posts/2019-05-01-why-are-default-parameter-values-considered-bad-in-scala.html';
              };

              (function() { // DON'T EDIT BELOW THIS LINE
              var d = document, s = d.createElement('script');
              s.src = 'https://babyloncandle.disqus.com/embed.js';
              s.setAttribute('data-timestamp', +new Date());
              (d.head || d.body).appendChild(s);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        
    </div>


      
    </body>
    <script src="../js/jquery-1.11.1.min.js"></script>
    <script src="../js/typeahead.bundle.min.js"></script>
    <script src="../js/handlebars-v1.3.0.js"></script>
    <script src="../js/babyloncandle.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55156872-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-55156872-1');
    </script>
</html>
