<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"
    xmlns:dc="http://purl.org/dc/elements/1.1/">
    <channel>
        <title>BabylonCandle</title>
        <link>http://blog.ssanj.net</link>
        <description><![CDATA[The blog of Sanjiv Sahayam]]></description>
        <atom:link href="http://blog.ssanj.net/feed.xml" rel="self"
                   type="application/rss+xml" />
        <lastBuildDate>Wed, 11 Jan 2023 00:00:00 UT</lastBuildDate>
        <item>
    <title>How To Connect The Brother Hl-2170W To Wifi on macOSX</title>
    <link>http://blog.ssanj.net/posts/2023-01-11-how-to-connect-the-brother-hl-2170w-to-wifi-.html</link>
    <description><![CDATA[<p>I recently wanted to connect my <a href="https://support.brother.com/g/b/spec.aspx?c=us&amp;lang=en&amp;prod=hl2170w_all">Brother HL-2170W</a> laser printer to my Wifi network. I had always used the wired Ethernet connection prior. The <a href="https://support.brother.com/g/s/id/htmldoc/printer/cv_hl2140/eng/html/nug/index.html">Network User’s Guide</a> mentioned installing a Brother application to configure the printer to use Wifi:</p>
<blockquote>
<p>To connect your printer to your wireless network, you need to follow the steps in the Quick Setup Guide or the Network User’s Guide. We recommend that you use the Brother installer application on the CD-ROM which we have provided with the printer. By using this application, you can easily connect your printer to your wireless network and install the network software and printer driver which you need to complete the configuration of your printer for a wireless network. You will be guided by the on-screen instructions until you are able to use your Brother wireless network printer.</p>
</blockquote>
<p>Have a read of the <a href="https://support.brother.com/g/s/id/htmldoc/printer/cv_hl2140/eng/html/index.html">HL-2170W manual</a> for more specific information.</p>
<p>Given how old this printer was, I didn’t fancy my chances of getting their software to work on the current version of macOSX (12.6.3). Also MacBooks have not shipped with a CD-ROM for many years, so using the CD-ROM was not a viable option. I also didn’t see the utility mentioned available for download on their download site, so that was a no go. :|</p>
<p>Most network printers have some sort of web admin application where you can update settings. I hit the IP address of the printer in a browser: <code>http://printer_ip_address</code> and was greeted by an admin panel:</p>
<div class="figure">
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-admin-panel.png" alt="Admin Panel" />
<p class="caption">Admin Panel</p>
</div>
<p>If you don’t know what the IP address of your printer is you have two options:</p>
<ol style="list-style-type: decimal">
<li>Find the DHCP address of your printer from your Router. This is assuming that the printer is using DHCP from your router.</li>
<li>Press the “Go” button (the big white button on the bottom left side of your printer) three times and the printer should printer out a bunch of statistics about the printer along with its IP address.</li>
</ol>
<div class="figure">
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/go-button.png" alt="Go Button" />
<p class="caption">Go Button</p>
</div>
<h2 id="update-the-admin-and-user-passwords">Update the admin and user Passwords</h2>
<p>The default admin credentials to the admin settings (red key) are:</p>
<ul>
<li>login: admin</li>
<li>password: access</li>
</ul>
<p>The default user credentials to the user settings (green key) are:</p>
<ul>
<li>login: user</li>
<li>password: access</li>
</ul>
<div class="figure">
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-key-settings.png" alt="Setting Types" />
<p class="caption">Setting Types</p>
</div>
<p>It’s a good idea to change the above credentials to something stronger.</p>
<p>One issue I ran across when entering long or complex passwords (over 20 alphanumeric and symbolic characters), was that the system would accept it but you would not be able to log into the admin with those updated credentials. Boo! If this happens you will need to reset your printer to factory defaults. See <a href="#reset-printer-to-factory-defaults">Reset Printer to Factory Defaults</a> for details.</p>
<p>What seems to work best is a short alphanumeric password. I tried up to seven characters and left it at that. It may support higher lengths but given that I had already had to reset my printer multiple times, I chose to stop there.</p>
<p>While this is not great, it’s better than the default combinations.</p>
<h2 id="update-firmware">Update Firmware</h2>
<p>Next it would be good to update the printer to its latest firmware to get any bug fixes and security patches etc.</p>
<p>You can download the latest (1.17 as of writing this) from <a href="https://support.brother.com/g/b/downloadtop.aspx?c=au&amp;lang=en&amp;prod=hl2170w_all">Brother’s 2170W Downloads page</a>. Please choose the OS version you want to download the firmware for.</p>
<p>For macOSX, the latest macOSX version is <a href="https://support.brother.com/g/b/downloadlist.aspx?c=au&amp;lang=en&amp;prod=hl2170w_all&amp;os=10060">10.15.x</a>. It seemed to work on macOSX 12.6.3 without a hitch.</p>
<h2 id="activate-wifi">Activate Wifi</h2>
<ul>
<li>Log into the admin panel as the admin user</li>
<li>Choose the <code>Network Configuration</code> link</li>
</ul>
<div class="figure">
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-admin-panel-choose-network-configuration.png" alt="Network Configuration" />
<p class="caption">Network Configuration</p>
</div>
<ul>
<li>Choose the <code>Wireless</code> interface</li>
<li>Verify that the Wireless interface is <code>Inactive</code></li>
<li>Choose the <code>Configure Wireless</code> link</li>
</ul>
<div class="figure">
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-admin-panel-wireless-network-configuration.png" alt="Configure Wireless" />
<p class="caption">Configure Wireless</p>
</div>
<ul>
<li>Choose the following settings:</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">Setting</th>
<th align="left">Value</th>
<th align="left">Comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Communication Mode</td>
<td align="left"><code>Infrastructure Mode</code></td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">Wireless Network Name (SSID)</td>
<td align="left">-</td>
<td align="left"><code>Browse</code> to choose your SSID and channel. This can take a while</td>
</tr>
<tr class="odd">
<td align="left">Authentication Method</td>
<td align="left">WPA/WPA2-PSK</td>
<td align="left">Or your authentication method</td>
</tr>
<tr class="even">
<td align="left">Encryption Mode</td>
<td align="left">AES</td>
<td align="left">or your encryption mode</td>
</tr>
<tr class="odd">
<td align="left">Passphrase</td>
<td align="left"><strong>Your Wifi Password</strong></td>
<td align="left">-</td>
</tr>
</tbody>
</table>
<div class="figure">
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-wifi-settings.png" alt="Wifi Settings" />
<p class="caption">Wifi Settings</p>
</div>
<ul>
<li>Click <code>Submit</code></li>
<li>Wait for the following message to display:</li>
</ul>
<div class="figure">
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-wifi-settings-saved.png" alt="Confirmation-1" />
<p class="caption">Confirmation-1</p>
</div>
<ul>
<li>Wait for the second confirmation message to display:</li>
</ul>
<div class="figure">
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-wifi-settings-enable-wireless-confirmation.png" alt="Confirmation-2" />
<p class="caption">Confirmation-2</p>
</div>
<ul>
<li>Click <code>Yes</code>. This disables your wired Ethernet connection to the printer</li>
<li>Wait for the third confirmation message:</li>
</ul>
<div class="figure">
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-wifi-settings-wireless-restart.png" alt="Confirmation-3" />
<p class="caption">Confirmation-3</p>
</div>
<ul>
<li>Unplug the Ethernet cable and restart the printer</li>
<li>Give the printer a few minutes to connect to your wireless network</li>
<li>Find the IP address of the printer from your Router</li>
<li>Try and open the admin panel again using your new IP address: <code>http://&lt;wifi_ip_address&gt;</code></li>
</ul>
<p>If you can access the admin panel of the printer you’re all set! Well done! If you can’t see the <a href="#troubleshooting">troubleshooting</a> section.</p>
<p>Once you’re satisfied your printer is working correctly, assign a static IP address to MAC address of your printer’s wireless network card through your router. This ensures that the printer will always get the same IP address.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>If the printer does not turn up as a wireless client on your router’s DHCP lease table, something’s gone wrong! Oh noes! Since you’ve switched to the Wireless interface, your wired network interface does not work. Your only option is to <a href="#reset-printer-to-factory-defaults">Reset Printer to Factory Defaults</a> and try the steps again, ensuring all your Wifi connection details are correct.</p>
<p>I had to do this number of times so I feel your pain.</p>
<h2 id="reset-printer-to-factory-defaults">Reset Printer to Factory Defaults</h2>
<p>If you need to <a href="https://support.brother.com/g/s/id/htmldoc/printer/cv_hl2140/eng/html/ug/index.html?page=chapter4_3_4.html&amp;search=reset&amp;mySearch=reset">reset your printer</a> to factory defaults by doing the following:</p>
<ol style="list-style-type: decimal">
<li>Turn off the printer</li>
<li>Make sure that the front cover is closed and the power cord is plugged in</li>
<li>Hold down the Go button as you turn on the power switch. Keep the Go button pressed down until the Toner, Drum and Error LEDs light up. Release the Go button. Make sure that all the LEDs turn off</li>
<li>Press the Go button seven times. Make sure that all the LEDs light up to indicate the print server has been reset to its default settings</li>
</ol>
<h2 id="links">Links</h2>
<ul>
<li><a href="https://discussions.apple.com/thread/7408889">set up a Brother HL2170W to print wireless to Mac book Air</a></li>
</ul>]]></description>
    <pubDate>Wed, 11 Jan 2023 00:00:00 UT</pubDate>
    <guid>http://blog.ssanj.net/posts/2023-01-11-how-to-connect-the-brother-hl-2170w-to-wifi-.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>macOS Loses Connection To Bluetooth Mouse</title>
    <link>http://blog.ssanj.net/posts/2022-11-16-macos-loses-connection-to-bluetooth-mouse.html</link>
    <description><![CDATA[<p>I am not a big fan of using Bluetooth for connecting to peripherals. They inevitably stop working at some point and you’re left without a working keyboard or mouse or both.</p>
<p>Recently I suspended my scepticism and purchased the <a href="https://www.logitech.com/en-au/products/mice/lift-vertical-ergonomic-mouse-mac.910-006470.html">Logitech Lift for Mac</a>. I was getting some RSI and wanted to try out this vertical mouse.</p>
<div class="figure">
<img src="/images/macos-loses-connection-to-bluetooth-mouse/logitech-lift-for-mac.png" alt="Logitech Lift for Mac" />
<p class="caption">Logitech Lift for Mac</p>
</div>
<p>The mouse is exceptional. It was working really well, until one day, as expected, the mouse could not be detected by macOS (Monterey).</p>
<blockquote>
<p>Curse your sudden but inevitable betrayal!</p>
</blockquote>
<p>Since I knew this day would come, I had a handy wired USB mouse close by. Surprisingly even after disabling and enabling Bluetooth the mouse would not pair on its previous channel.</p>
<p>I changed channels and finally got the mouse to pair. This was quite annoying as now I had two channels bound to the same computer. I did some Googling and found that <a href="https://apple.stackexchange.com/questions/251842/how-to-restart-bluetooth-service-from-command-line">killing the Bluetooth daemon</a> seemed to solve the problem. Once the daemon is killed, a new instance is automatically started.</p>
<h2 id="script-it">Script it</h2>
<p>I created a small Bash script to do that. In order to use the script I had use <code>gnu-sed</code> as opposed to the default <code>sed</code> implementation that ships with macOS, because I wanted to do some Regex replacements.</p>
<p>You can install it via <a href="https://brew.sh/">brew</a>:</p>
<pre class="terminal scrollx"><code>brew install gnu-sed</code></pre>
<p>If you want to make <code>gnu-sed</code> your default <code>sed</code>, then you can just add it to your path as mentioned in <a href="https://medium.com/@bramblexu/install-gnu-sed-on-mac-os-and-set-it-as-default-7c17ef1b8f64">this</a> article.</p>
<p>The kill script: <code>kill-bluetooth.sh</code> is as follows:</p>
<div class="sourceCode"><pre class="sourceCode bash scrollx"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="ot">PROC_ID=$(</span><span class="kw">ps</span> aux <span class="kw">|</span> <span class="kw">grep</span> <span class="st">&#39;bluetoothd&#39;</span> <span class="kw">|</span> <span class="kw">grep</span> -v <span class="st">&#39;grep&#39;</span> <span class="kw">|</span> <span class="kw">/usr/local/opt/gnu-sed/libexec/gnubin/sed</span> -E <span class="st">&#39;s/\s+/ /g&#39;</span> <span class="kw">|</span> <span class="kw">cut</span> -d<span class="st">&#39; &#39;</span> -f2<span class="ot">)</span>

<span class="kw">echo</span> <span class="st">&quot;bluetoothd Proc Id: </span><span class="ot">$PROC_ID</span><span class="st">&quot;</span>

<span class="kw">sudo</span> kill -9 <span class="st">&quot;</span><span class="ot">$PROC_ID</span><span class="st">&quot;</span></code></pre></div>
<p>These are the steps followed in the script:</p>
<ol style="list-style-type: decimal">
<li>Find any processes named “bluetoothd” (<code>ps aux | grep 'bluetoothd'</code>)</li>
<li>Unfortunately this also returns the grep we ran above. Exclude it. (<code>grep -v 'grep'</code>)</li>
<li>Any time we have more than a single space, replace it with a single space (<code>sed -E 's/\s+/ /g'</code>)</li>
<li>Split the output by spaces and get the second field which is the process id(<code>cut -d' ' -f2</code>)</li>
<li>Assign the process id to <code>PROC_ID</code></li>
<li>Write out <code>PROC_ID</code> to the terminal (<code>echo &quot;bluetoothd Proc Id: $PROC_ID&quot;</code>)</li>
<li>Kill the process with the process id of <code>PROC_ID</code> (<code>sudo kill -9 &quot;$PROC_ID&quot;</code>)</li>
</ol>
<p>I’ve explicitly specified the path to the <code>gnu-sed</code> implementation because I want to run this script through <a href="https://www.alfredapp.com/">Alfred</a>. More on that later.</p>
<p>Running the above script fixes the problem when Bluetooth fails to detect my mouse!</p>
<div class="figure">
<img src="https://media.giphy.com/media/uJw7UcWYutgQM/giphy.gif" alt="Hooray" />
<p class="caption">Hooray</p>
</div>
<h2 id="make-alfred-do-it">Make Alfred do it</h2>
<p>But what if we could make it even easier? And we can, by running it through an <a href="https://www.alfredapp.com/help/workflows/actions/run-script/">Alfred Workflow script</a>.</p>
<p>One thing we will need is to give the script administrative privileges in order to run the <code>sudo</code> command. We can do this by wrapping it in an <a href="https://developer.apple.com/library/archive/technotes/tn2065/_index.html#//apple_ref/doc/uid/DTS10003093-CH1-TNTAG1-HOW_DO_I_PASS_AN_APPLESCRIPT_VARIABLE_TO_MY_SHELL_COMMAND_">AppleScript</a>:</p>
<pre class="command scrollx"><code>do shell script &quot;/bin/bash PATH_TO_SCRIPT/kill-bluetooth.sh&quot; with administrator privileges</code></pre>
<div class="figure">
<img src="/images/macos-loses-connection-to-bluetooth-mouse/alfred-workflow-script.png" alt="Alfred Workflow Script" />
<p class="caption">Alfred Workflow Script</p>
</div>
<p>This will now prompt you for the administrator password when running the script.</p>
<p>And now you can simply define a keyword to such as “Relaunch Bluetooth” to launch your Alfred Workflow and restart your <code>bluetoothd</code> daemon.</p>
<div class="figure">
<img src="/images/macos-loses-connection-to-bluetooth-mouse/alfred-workflow.png" alt="Alfred Workflow" />
<p class="caption">Alfred Workflow</p>
</div>
<div class="figure">
<img src="/images/macos-loses-connection-to-bluetooth-mouse/relaunch-bluetooth.png" alt="Relaunch Bluetooth" />
<p class="caption">Relaunch Bluetooth</p>
</div>]]></description>
    <pubDate>Wed, 16 Nov 2022 00:00:00 UT</pubDate>
    <guid>http://blog.ssanj.net/posts/2022-11-16-macos-loses-connection-to-bluetooth-mouse.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>How To Automate Spotify Through Alfred</title>
    <link>http://blog.ssanj.net/posts/2022-10-26-how-to-automate-spotify-through-alfred.html</link>
    <description><![CDATA[<p>I recently found myself thinking it would be cool to control <a href="https://www.spotify.com/">Spotify</a> through <a href="https://www.alfredapp.com/">Alfred</a>.</p>
<div class="figure">
<img src="https://media.giphy.com/media/cnuS67F8IoVTYRvJXE/giphy.gif" alt="That’s Cool" />
<p class="caption">That’s Cool</p>
</div>
<p>I use Alfred as my defacto launcher app and search tool on MacOSX. You can achieve this through Alfred <a href="https://www.alfredapp.com/workflows/">Workflows</a>. One way to do this is by using the <a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html">AppleScript</a> integration provided in the Workflow editor.</p>
<div class="figure">
<img src="https://www.alfredapp.com/help/workflows/workflow-canvas.png" alt="Alfred Workflow Editor" />
<p class="caption">Alfred Workflow Editor</p>
</div>
<p>See <a href="https://www.alfredapp.com/blog/tips-and-tricks/learn-to-create-workflows-with-alfreds-built-in-examples/">Learn to Create Workflows with Alfred’s Built-In Examples</a> if you’re new to creating Alfred Workflows.</p>
<p>The challenging part, for me at least, was crafting the AppleScript necessary. I’ve documented some scripts below that can be plugged into an Alfred workflow.</p>
<p>The basic outline of an AppleScript to use Spotify is of the form:</p>
<pre class="command scrollx"><code>on run
  tell application &quot;Spotify&quot;
    &lt;your Spotify functionality&gt;
  end tell
end run</code></pre>
<p>To see a full list of Spotify functionality supported through AppleScript, do the following:</p>
<ol style="list-style-type: decimal">
<li>Open the <code>Script Editor</code> application</li>
<li>Choose <code>Window</code> &gt; <code>Library</code> from the main menu or use the shortcut <code>CMD</code> + <code>ALT</code> + <code>L</code></li>
<li>If you don’t see the Spotify icon in the list, then click on the + icon at the top left of the window to <code>Add an item to Library</code>. Browse to the <code>Application</code> folder on your machine and choose the Spotify application.</li>
</ol>
<div class="figure">
<img src="/images/how-to-automate-spotify-through-alfred/script-editor-spotify.png" alt="Spotify Library" />
<p class="caption">Spotify Library</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Double click on the Spotify Library to view the available functions:</li>
</ol>
<div class="figure">
<img src="/images/how-to-automate-spotify-through-alfred/script-editor-spotify-suite.png" alt="Spotify Library" />
<p class="caption">Spotify Library</p>
</div>
<h2 id="toggle-a-track">Toggle a Track</h2>
<p>Rather than playing and stopping Spotify, my workflow is to toggle playing or stopping a track.</p>
<pre class="command scrollx"><code>on run
  tell application &quot;Spotify&quot;
    playpause
  end tell
end run</code></pre>
<p>As expected this would stop a playing track or play a stopped track.</p>
<h2 id="next-track">Next Track</h2>
<pre class="command scrollx"><code>on run
  tell application &quot;Spotify&quot;
    next track
  end tell
end run</code></pre>
<h2 id="previous-track">Previous Track</h2>
<pre class="command scrollx"><code>on run
  tell application &quot;Spotify&quot;
    previous track
  end tell
end run</code></pre>
<h2 id="playing-an-album">Playing an Album</h2>
<p>The general syntax is for the AppleScript automation is:</p>
<pre class="command scrollx"><code>on run
  tell application &quot;Spotify&quot;
        play track &quot;spotify:track:&lt;first_track_id&gt;&quot; in context &quot;spotify:album:&lt;album_id&gt;&quot;
  end tell
end run</code></pre>
<p>Copy the album link as right-clicking on the ellipses next to the album and choosing <code>Share</code> &gt; <code>Copy Album Link</code>.</p>
<div class="figure">
<img src="/images/how-to-automate-spotify-through-alfred/album_id.png" alt="Album" />
<p class="caption">Album</p>
</div>
<p>The link will be of the form:</p>
<pre class="terminal scrollx"><code>https://open.spotify.com/album/41Ywc4XSD3GChkeAfzhRIR?si=htPbJS67QB6GapPw-p6W0w</code></pre>
<p>The <code>album_id</code> in the above link is <code>41Ywc4XSD3GChkeAfzhRIR</code> and as usual we can ignore everything else.</p>
<p>The <code>first_track_id</code> of the album can be found by clicking on the ellipses near the right of the first track of the album, and choosing <code>share</code> &gt; <code>Copy Song Link</code></p>
<div class="figure">
<img src="/images/how-to-automate-spotify-through-alfred/album_track_id.png" alt="First Track of Album" />
<p class="caption">First Track of Album</p>
</div>
<p>The link will be of the form:</p>
<pre class="terminal scrollx"><code>https://open.spotify.com/track/7tWyfy3ySgLMbH9R0xeqzZ?si=20d78c906e7e462f</code></pre>
<p>The first_song_id is <code>7tWyfy3ySgLMbH9R0xeqzZ</code> in the above link.</p>
<p>Putting it all together we get:</p>
<pre class="command scrollx"><code>on run
  tell application &quot;Spotify&quot;
        play track &quot;spotify:track:7tWyfy3ySgLMbH9R0xeqzZ&quot; in context &quot;spotify:album:41Ywc4XSD3GChkeAfzhRIR&quot;
  end tell
end run</code></pre>
<h2 id="playing-a-playlist">Playing a Playlist</h2>
<p>The general syntax is for the AppleScript automation is:</p>
<pre class="command scrollx"><code>on run
  tell application &quot;Spotify&quot;
        play track &quot;spotify:track:&lt;first_track_id&gt;&quot; in context &quot;spotify:user:&lt;user_id&gt;:playlist:&lt;playlist_id&gt;&quot;
  end tell
end run</code></pre>
<p>The <code>user_id</code> is the owner of the playlist. More on that later.</p>
<p>It’s also important to note that you need to specify the playlist <strong>and</strong> the first track you want to start playing when you run the playlist. The track has to be played <code>in context</code> of the playlist.</p>
<div class="figure">
<img src="https://media.giphy.com/media/720g7C1jz13wI/giphy.gif" alt="Shrug" />
<p class="caption">Shrug</p>
</div>
<h3 id="spotify-playlist">Spotify Playlist</h3>
<p>For the example below I will be using the <a href="https://open.spotify.com/playlist/37i9dQZF1DWVvXA824aCbn?si=e31800da15c0430e">The Piano Bar</a> playlist is created by Spotify.</p>
<div class="figure">
<img src="/images/how-to-automate-spotify-through-alfred/public-playlist.png" alt="The Piano Bar Playlist" />
<p class="caption">The Piano Bar Playlist</p>
</div>
<p>The <code>user_id</code> of any user can be retrieved by right-clicking on the user name of the owner of the playlist and selecting <code>Copy link to profile</code>. The <code>user_id</code> can be extracted from the link copied as described below.</p>
<div class="figure">
<img src="/images/how-to-automate-spotify-through-alfred/spotify-user.png" alt="Spotify User" />
<p class="caption">Spotify User</p>
</div>
<p>The link is of the form:</p>
<pre class="terminal scrollx"><code>https://open.spotify.com/user/spotify?si=ba05be61cab84242</code></pre>
<p>The <code>user_id</code> from the above link is <code>spotify</code>. The <code>?si=</code> part can be ignored for our purposes.</p>
<p>The displayed user name and the actual <code>user_id</code> can be different. This is why we try to find the actual <code>user_id</code> from the profile link.</p>
<p>The <code>playlist_id</code> can be found by clicking on the ellipses near the top left of the playlist, and choosing <code>share</code> &gt; <code>copy link to playlist</code></p>
<div class="figure">
<img src="/images/how-to-automate-spotify-through-alfred/playlist_id.png" alt="Playlist Share Link" />
<p class="caption">Playlist Share Link</p>
</div>
<p>The share link is:</p>
<pre class="terminal scrollx"><code>https://open.spotify.com/playlist/37i9dQZF1DWVvXA824aCbn?si=04e7f5def59f4f93</code></pre>
<p>The playlist id in the above url is <code>37i9dQZF1DWVvXA824aCbn</code>. The <code>?si=</code> part can be ignored for our purposes.</p>
<p>The <code>first_track_id</code> of the playlist can be found by clicking on the ellipses near the right of the first track of the playlist, and choosing <code>share</code> &gt; <code>Copy Song Link</code></p>
<div class="figure">
<img src="/images/how-to-automate-spotify-through-alfred/first_track_id.png" alt="Track Share Link" />
<p class="caption">Track Share Link</p>
</div>
<p>The share link to the first track is:</p>
<pre class="terminal scrollx"><code>https://open.spotify.com/track/1nsMASRDWwUwlBMmOuh80d?si=eaa86c63aa504858</code></pre>
<p>The <code>first_track_id</code> in the above url is: <code>1nsMASRDWwUwlBMmOuh80d</code>. The <code>?si=</code> part can be ignored for our purposes.</p>
<p>Below is the ApplesSript code, to run the <code>The Piano Bar</code> playlist using the attributes: <code>first_track_id</code>, <code>playlist_id</code> and <code>user_id</code>, collected above:</p>
<pre class="command scrollx"><code>on run
  tell application &quot;Spotify&quot;
        play track &quot;spotify:track:1nsMASRDWwUwlBMmOuh80d&quot; in context &quot;spotify:user:spotify:playlist:37i9dQZF1DWVvXA824aCbn&quot;
  end tell
end run</code></pre>
<p>As a second example we can take my <a href="https://open.spotify.com/playlist/7znakCCH9jS9fpl0GmJYah?si=78fb6db9954a41ba">Folk</a> playlist:</p>
<div class="figure">
<img src="/images/how-to-automate-spotify-through-alfred/folk-playlist.png" alt="Folk Playlist" />
<p class="caption">Folk Playlist</p>
</div>
<p>Right click on the user name and select <code>Copy link to profile</code>.</p>
<p>The link will be of the form:</p>
<pre class="terminal scrollx"><code>https://open.spotify.com/user/ssanjs?si=0c84ec2c4811471c</code></pre>
<p>In the above link, my Spotify user id is <code>ssanjs</code> and as usual we can ignore everything else.</p>
<p>Given the following attributes:</p>
<table>
<thead>
<tr class="header">
<th align="left">Attibute</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">user</td>
<td align="left">ssanjs</td>
</tr>
<tr class="even">
<td align="left">playlist_id</td>
<td align="left">7znakCCH9jS9fpl0GmJYah</td>
</tr>
<tr class="odd">
<td align="left">first_song_id</td>
<td align="left">5PAnntRTBk6qgst5Fw84Y8</td>
</tr>
</tbody>
</table>
<p>Our script is:</p>
<pre class="command scrollx"><code>on run
  tell application &quot;Spotify&quot;
       play track &quot;spotify:track:5PAnntRTBk6qgst5Fw84Y8&quot; in context &quot;spotify:user:ssanj:playlist:7znakCCH9jS9fpl0GmJYah&quot;
  end tell
end run</code></pre>
<h2 id="magic-happens">Magic Happens</h2>
<p>Once you’ve setup your Alfred Workflows for Spotify you can simply change to your favourite album or playlist from the search box:</p>
<div class="figure">
<img src="/images/how-to-automate-spotify-through-alfred/alfred-spotify.gif" alt="Folk Playlist" />
<p class="caption">Folk Playlist</p>
</div>
<h2 id="links">Links</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/11607618/applescript-play-track-spotify">Applescript play track spotify</a></li>
<li><a href="https://gist.github.com/NoobsArePeople2/5121597">Sample AppleScript to Control Spotify</a></li>
<li><a href="https://stackoverflow.com/questions/8901556/controlling-spotify-with-applescript">Controlling Spotify with AppleScript</a></li>
</ul>]]></description>
    <pubDate>Wed, 26 Oct 2022 00:00:00 UT</pubDate>
    <guid>http://blog.ssanj.net/posts/2022-10-26-how-to-automate-spotify-through-alfred.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>Connecting To An Existing Tmux Session</title>
    <link>http://blog.ssanj.net/posts/2022-10-21-connecting-to-an-existing-tmux-session.html</link>
    <description><![CDATA[<p>One of the cool things about <a href="https://github.com/tmux/tmux">tmux</a> is that, even if you close the terminal that tmux runs in, the tmux server process keeps your session around. That also means that you can reconnect to it from another terminal.</p>
<p>If you accidentally or purposely closed a terminal session that was running tmux, you can simply launch a new terminal instance and list your existing tmux sessions with:</p>
<pre class="terminal scrollx"><code>tmux ls</code></pre>
<p>You might get a list of the sort:</p>
<pre class="command scrollx"><code>git: 2 windows (created Tue Oct  4 09:30:12 2022) (attached)
projects: 6 windows (created Tue Oct  4 09:30:44 2022) (attached)</code></pre>
<p>Now to connect to any of the existing session simply use:</p>
<pre class="terminal scrollx"><code>tmux attach -t &lt;session_name&gt;</code></pre>
<p>For example to reconnect to the <code>projects</code> tmux session use:</p>
<pre class="terminal scrollx"><code>tmux attach -t projects</code></pre>
<p>And you’re back to where you left of!</p>
<p>There’s even a way to <a href="https://timvisee.com/blog/reconnect-to-broken-tmux-session/">Reconnect to Broken tmux Session</a></p>]]></description>
    <pubDate>Fri, 21 Oct 2022 00:00:00 UT</pubDate>
    <guid>http://blog.ssanj.net/posts/2022-10-21-connecting-to-an-existing-tmux-session.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>How To Add Different Icons To Application Instances On Macosx</title>
    <link>http://blog.ssanj.net/posts/2022-10-19-how-to-add-different-icons-to-application-instances-on-macosx.html</link>
    <description><![CDATA[<p>I run multiple <a href="https://alacritty.org/">Alacritty</a> instances for my development workflow. Each instance uses <a href="https://github.com/tmux/tmux">tmux</a> to manage multiple windows - one per project. I have one Alacritty instance that runs <a href="https://github.com/Extrawurst/gitui">GitUI</a> in full screen mode and the other instance runs the continuous compilation of each project in its own window. Oh, and they also run on separate monitors.</p>
<h2 id="monitor-configuration">Monitor Configuration</h2>
<p>I have one horizontal 32&quot; monitor which is my primary screen and a 27&quot; monitor turned vertical for my secondary screen.</p>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/monitors.png" alt="Monitors" />
<p class="caption">Monitors</p>
</div>
<h3 id="primary-monitor">Primary Monitor</h3>
<p>The main monitor runs Alacritty with GitUI.</p>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/gitui.png" alt="Gitui" />
<p class="caption">Gitui</p>
</div>
<h3 id="secondary-monitor">Secondary Monitor</h3>
<p>The secondary monitor runs another Alacritty instance with continuous compilation with the respective project’s compiler. If the project doesn’t have a compiler, the window opens to the project location from which I can run various commands.</p>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/compilation.png" alt="Continuous Compilation" />
<p class="caption">Continuous Compilation</p>
</div>
<h3 id="the-issue">The Issue</h3>
<p>So what’s the problem that requires different application icons per instance?</p>
<p>When I run two instances of Alacritty, this is what my Application Switcher (<code>CMD</code> + <code>TAB</code>) looks like:</p>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/application-switcher.png" alt="Application Switcher" />
<p class="caption">Application Switcher</p>
</div>
<p>It becomes very hard to distinguish between the <code>Gitgui</code> Alacritty and the <code>Project</code> Alacritty instances. More often than not I pick the wrong one and have to try and choose a second time. It’s a little annoying.</p>
<p>I can use <a href="https://support.apple.com/en-us/HT204100">Misson Control</a> to display all the windows and choose from there.</p>
<div class="figure">
<img src="https://support.apple.com/library/content/dam/edam/applecare/images/en_US/macos/Catalina/macos-catalina-mission-control-add-space-callout.jpg" alt="Mission Control - Apple.com" />
<p class="caption">Mission Control - Apple.com</p>
</div>
<p>The reason I don’t want to do this is because I’ve got an old MacBook Pro and zooming into Misson Control is slow. The whole process of:</p>
<ul>
<li>Go to Mission Control</li>
<li>Choose your Alacritty Window</li>
<li>Switch to that Window</li>
</ul>
<p>takes about 2 seconds. That’s way too long to maintain any kind of flow state when coding.</p>
<h3 id="the-solution">The Solution</h3>
<ol style="list-style-type: decimal">
<li>Create a copy of the application folder</li>
</ol>
<p>For example to create an Alacritty instance for <code>Whatever</code>s I can create a copy with:</p>
<pre class="terminal scrollx"><code>cp -r /Applications/Alacritty.app /Applications/Alacritty-Whatever.app</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Open <code>Finder</code> and browse to the freshly copied application folder (<code>/Applications/Alacritty-Whatever.app</code> in the above example)</li>
</ol>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/whatever-app.png" alt="Alacritty-Whatever.app" />
<p class="caption">Alacritty-Whatever.app</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Open the information panel with <code>CMD</code> + <code>I</code>:</li>
</ol>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/icon-placeholder.png" alt="Icon Placeholder" />
<p class="caption">Icon Placeholder</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Find a new image (use <a href="https://images.google.com">Google Images</a>, <a href="https://macosicons.com/#/">macosicons</a> etc)</li>
<li>Drag the new image to the icon placeholder</li>
</ol>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/drag-icon.png" alt="Drag in the New Image" />
<p class="caption">Drag in the New Image</p>
</div>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/replace-icon.png" alt="Update Icon" />
<p class="caption">Update Icon</p>
</div>
<ol start="6" style="list-style-type: decimal">
<li>Launch Copied app through Spotlight or <a href="https://www.alfredapp.com/">Alfred</a></li>
</ol>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/launch-new-app.png" alt="Launch Copied App" />
<p class="caption">Launch Copied App</p>
</div>
<ol start="7" style="list-style-type: decimal">
<li>Check the Application Switcher</li>
</ol>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/updated-app-switcher.png" alt="Updated Icon" />
<p class="caption">Updated Icon</p>
</div>
<h3 id="final-result">Final Result</h3>
<p>I used the above steps to create custom icons for Alacritty for both my projects and GitUI instances.</p>
<div class="figure">
<img src="/images/add-different-icons-to-applications-macos/custom-icons-workflow.png" alt="Alacritty Icons" />
<p class="caption">Alacritty Icons</p>
</div>
<p>The key is to launch the Alacritty-Projects application for projects and Alacritty-GitUI application for git-related work.</p>
<h3 id="downsides">Downsides</h3>
<p>This is the simplest way to give different application instances different icons that I have found. You have to essentially create a new application (by copying an existing one) just to change an icon for a different instance. You need one copy per instance you want to customise the icon for. This seems a little crazy.</p>
<div class="figure">
<img src="https://media.giphy.com/media/tn9LtuEXQRJqT6dWrx/giphy.gif" alt="Make it Easier" />
<p class="caption">Make it Easier</p>
</div>
<p>If you know of an easier/better way to do this please drop me comment.</p>
<p>Unfortunately any time you update the original application (Alacritty in this instance) you need to recreate your copies and do the whole updating icon dance.</p>
<h3 id="scripting">Scripting</h3>
<p>This whole process is pretty easy to script, providing you can create an icns file for the image you require or already have an alternate icns file. But it is not as reliable as the steps outlined above, as sometimes icon caching issues makes it hard to refresh the new icons. See below for more details</p>
<h4 id="generating-an-icns-file">Generating an icns File</h4>
<p>There’s a program called <a href="http://www.amnoid.de/icns/makeicns.html">mkicns</a> that lets you convert images from various formats like jpg, png etc to icns files that are used for your application icons.</p>
<p>You can install it through <a href="https://brew.sh/">Homebrew</a>:</p>
<pre class="terminal scrollx"><code>brew install makeicns</code></pre>
<p>You can generate an icns file for a given image with:</p>
<pre class="terminal scrollx"><code>makeicns -in your-image_file -out your.icns</code></pre>
<p>There are a bunch <a href="http://www.amnoid.de/icns/makeicns.html">more options for makeicn</a>, so make sure to check the <code>--help</code> option for any customizations you want to make.</p>
<h4 id="icon-refresh-issues">Icon Refresh Issues</h4>
<p>Now that we have our own icns file, we can do the following:</p>
<ol style="list-style-type: decimal">
<li>Create a copy of the application folder as above</li>
<li>Copy across the custom icns file into the <code>Content/Resources</code> folder and replace the <strong>existing</strong> icns file you want to replace.</li>
</ol>
<p>For example for Alacritty, the main ics file is <code>Content/Resources/alacritty.icns</code>, so you’d do:</p>
<pre class="terminal scrollx"><code>cp your.icns /Applications/Alacritty-Whatever.app/Content/Resources/alacritty.icns</code></pre>
<p>Now if you try to launch your custom application with your new shiny icon you will notice that it has not been updated.</p>
<div class="figure">
<img src="https://media.giphy.com/media/OPU6wzx8JrHna/giphy.gif" alt="Sad Face" />
<p class="caption">Sad Face</p>
</div>
<p>In order to do that you need to help macos understand that the application has changed and you may need to some or all of the steps below:</p>
<ol style="list-style-type: decimal">
<li>touch the application folder</li>
</ol>
<pre class="terminal scrollx"><code>touch /Applications/Alacritty-Whatever.app</code></pre>
<p>If that doesn’t work you may also need to do the following:</p>
<ol start="2" style="list-style-type: decimal">
<li>Kill all the things</li>
</ol>
<pre class="terminal scrollx"><code>sudo killall Finder
sudo killall Dock</code></pre>
<p>These steps are from <a href="https://www.sethvargo.com/replace-icons-osx/">Changing Mac OS X Application Icons Programmatically</a>.</p>
<p>A full working script:</p>
<pre class="terminal scrollx"><code>#!/bin/bash

cp -r /Applications/Alacritty.app /Applications/Alacritty-Whatever.app
cp whatever.icns /Applications/Alacritty-Whatever.app/Content/Resources/alacritty.icns
touch /Applications/Alacritty-Whatever.app
sudo killall Finder &amp;&amp; sudo killall Dock</code></pre>
<p>And hopefully that should be it. But sometimes it isn’t.</p>
<div class="figure">
<img src="https://media.giphy.com/media/22CEvbj04nLLq/giphy.gif" alt="Aaaaaaaaaaaaaaaargh" />
<p class="caption">Aaaaaaaaaaaaaaaargh</p>
</div>
<p>If that doesn’t work you may need more <a href="https://osxdaily.com/2022/05/23/clear-icon-cache-mac/">drastic</a> workarounds.</p>
<p>And at end of those drastic workarounds you might revert to just using the list of steps at the top of this article.</p>
<div class="figure">
<img src="https://media.giphy.com/media/B0vFTrb0ZGDf2/giphy.gif" alt="Small Smile" />
<p class="caption">Small Smile</p>
</div>
<p>A big thank you to Apple for making all this so damn hard.</p>
<div class="figure">
<img src="https://media.giphy.com/media/l0MYJlyOwdlT0SeU8/giphy.gif" alt="The End" />
<p class="caption">The End</p>
</div>
<h3 id="links">Links</h3>
<ul>
<li><a href="https://www.sethvargo.com/replace-icons-osx/">Changing Mac OS X Application Icons Programmatically</a></li>
<li><a href="https://osxdaily.com/2022/05/23/clear-icon-cache-mac/">How to Clear Icon Cache on Mac</a></li>
<li><a href="https://stackoverflow.com/questions/646671/how-do-i-set-the-icon-for-my-applications-mac-os-x-app-bundle">How do I set the icon for my application’s Mac OS X app bundle?</a></li>
<li><a href="https://stackoverflow.com/questions/14362063/icon-for-mac-osx-bundle">Icon for Mac OSX bundle</a></li>
</ul>]]></description>
    <pubDate>Wed, 19 Oct 2022 00:00:00 UT</pubDate>
    <guid>http://blog.ssanj.net/posts/2022-10-19-how-to-add-different-icons-to-application-instances-on-macosx.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>Extending Scala Case Class With NoStackTrace Leads To Unexpected toString Behaviour</title>
    <link>http://blog.ssanj.net/posts/2022-07-20-extending-scala-case-class-with-nostacktrace-leads-to-unexpected-tostring-behaviour.html</link>
    <description><![CDATA[<p>Say you had an ADT similar to this:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">import</span> scala.<span class="fu">util</span>.<span class="fu">control</span>.<span class="fu">NoStackTrace</span>

<span class="kw">sealed</span> <span class="kw">trait</span> MyError <span class="kw">extends</span> NoStackTrace
<span class="kw">final</span> <span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError1</span>(message: String) <span class="kw">extends</span>  MyError
<span class="kw">final</span> <span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError2</span>(message: String) <span class="kw">extends</span>  MyError</code></pre></div>
<p>This might seem weird to some. Why are we extending <code>NoStackTrace</code> ? This allows us to use the <code>MyError</code> as a return value through something like an <code>Either</code>:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">sanitiseInput</span>(value: String): Either[MyError, ValidInput]</code></pre></div>
<p>We can also use it as an error that can be thrown or raised into <a href="https://typelevel.org/cats-effect/">cats.IO</a>, <a href="https://fs2.io/#/">fs2.Stream</a>, <a href="https://monix.io/">Monix.eval.Task</a> or equivalent:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">object</span> IO {
  <span class="kw">def</span> raiseError[A](t: Throwable): IO[A] <span class="co">//`t` has to extend Throwable if we want to use this function.</span>

  <span class="co">//other functions</span>
}</code></pre></div>
<p>You can also read about some related ideas in <a href="https://nrinaudo.github.io/scala-best-practices/adts/errors_extend_exception.html">Make error ADTs subtypes of Exception</a>.</p>
<p>Now if we use <code>MyError</code> in a test:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">import</span> scala.<span class="fu">util</span>.<span class="fu">control</span>.<span class="fu">NoStackTrace</span>

<span class="kw">object</span> MyErrorSuite <span class="kw">extends</span> weaver.<span class="fu">FunSuite</span> {

<span class="kw">sealed</span> <span class="kw">trait</span> MyError <span class="kw">extends</span> NoStackTrace
<span class="kw">final</span> <span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError1</span>(message: String) <span class="kw">extends</span>  MyError
<span class="kw">final</span> <span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError2</span>(message: String) <span class="kw">extends</span>  MyError

  <span class="fu">test</span>(<span class="st">&quot;error message&quot;</span>) {
    expect.<span class="fu">same</span>(<span class="fu">MyError1</span>(<span class="st">&quot;error1&quot;</span>), <span class="fu">MyError2</span>(<span class="st">&quot;error2&quot;</span>)) <span class="co">//this is an error</span>
  }

}</code></pre></div>
<p>the test output from <a href="https://disneystreaming.github.io/weaver-test/">Weaver-Test</a> gets truncated somewhat:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala">[info] com.<span class="fu">example</span>.<span class="fu">validation</span>.<span class="fu">extra</span>.<span class="fu">MyErrorSuite</span>
[info] - error message 30ms
[info] *************FAILURES**************
[info] com.<span class="fu">example</span>.<span class="fu">validation</span>.<span class="fu">extra</span>.<span class="fu">MyErrorSuite</span>
[error] - error message 30ms
[error]   Values not equal: (src/test/scala/com/example/validation/extra/MyErrorSuite.<span class="fu">scala</span>:<span class="dv">12</span>)
[error]
[error]   com.<span class="fu">example</span>.<span class="fu">validation</span>.<span class="fu">extra</span>.<span class="fu">MyErrorSuite</span>$[MyError1]  |  com.<span class="fu">example</span>.<span class="fu">validation</span>.<span class="fu">extra</span>.<span class="fu">MyErrorSuite</span>$[MyError2]</code></pre></div>
<p>All we get are the class names returned in the diff:</p>
<pre class="terminal scrollx"><code>com.example.validation.extra.MyErrorSuite$[MyError1]  |  com.example.validation.extra.MyErrorSuite$[MyError2]</code></pre>
<p>The diff we expected was something like:</p>
<pre class="terminal scrollx"><code> [MyError1]([error1]) | [MyError2]([error2]) //we can see that the class and error messages are different</code></pre>
<p>When you create a case class it generates a <code>toString</code> implementation of the form: <code>ClassName(field1Value, field2Value, ....)</code>.</p>
<p>So why are we loosing our <code>toString</code> implementation?</p>
<h2 id="cause">Cause</h2>
<p>Let’s try a simpler example in the REPL:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError1</span>(message: String)

scala&gt; <span class="fu">MyError1</span>(<span class="st">&quot;Oh noes&quot;</span>)
<span class="kw">val</span> res35: MyError1 = <span class="fu">MyError1</span>(Oh noes) <span class="co">//&quot;Oh noes&quot; is output</span></code></pre></div>
<p>We can see that we do get the contents of all fields of the case class written out.</p>
<p>Let’s try extending <code>NoStackTrace</code> and see if it makes a difference:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">import</span> scala.<span class="fu">util</span>.<span class="fu">control</span>.<span class="fu">NoStackTrace</span>

<span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError2</span>(message: String) <span class="kw">extends</span> NoStackTrace

scala&gt; <span class="fu">MyError2</span>(<span class="st">&quot;Oh noes&quot;</span>)
<span class="kw">val</span> res36: MyError2 = MyError2 <span class="co">//no message output</span></code></pre></div>
<p>We can see that although the class name is output the contents of the <code>message</code> field has not.</p>
<p>Interesting. This seems to be the cause of our issue in the test.</p>
<p>It turns out a case class doesn’t generate a <code>toString</code> method (and other implementations such has hashCode etc) if you <strong>already</strong> have a custom implementation for that method in a super type.</p>
<p><a href="https://github.com/scala/bug/issues/1549">It’s not a bug, it’s a feature</a>.</p>
<div class="figure">
<img src="https://media.giphy.com/media/l41YqG5h9gIWrcSBy/giphy.gif" alt="Nope" />
<p class="caption">Nope</p>
</div>
<p>So where does our <code>MyError2</code> class get a custom <code>toString</code> implementation from?</p>
<p>Lets have a look at the <code>NoStackTrace</code> class, since <code>MyError2</code> extends that:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">trait</span> NoStackTrace <span class="kw">extends</span> Throwable {
  <span class="kw">override</span> <span class="kw">def</span> <span class="fu">fillInStackTrace</span>(): Throwable =
    <span class="kw">if</span> (NoStackTrace.<span class="fu">noSuppression</span>) <span class="kw">super</span>.<span class="fu">fillInStackTrace</span>()
    <span class="kw">else</span> <span class="kw">this</span>

  ...
}</code></pre></div>
<p>No <code>toString</code> implementation here. Let’s follow the inheritance trail to <code>java.lang.Throwable</code>. Here, we see that it <a href="https://github.com/EricChows/JDK-1.8-sourcecode/blob/d34a693ffa76fdbb0fea022b5bb7bfbd2c6df0bd/java/lang/Throwable.java#L390">does</a> have a custom <code>toString</code> implementation:</p>
<div class="sourceCode"><pre class="sourceCode java scrollx"><code class="sourceCode java"><span class="kw">public</span> String <span class="fu">toString</span>() {
    String s = <span class="fu">getClass</span>().<span class="fu">getName</span>();
    String message = <span class="fu">getLocalizedMessage</span>();
    <span class="kw">return</span> (message != <span class="kw">null</span>) ? (s + <span class="st">&quot;: &quot;</span> + message) : s;
}</code></pre></div>
<p>From the above implementation we can deduce that for <code>MyError2</code> the <code>getLocalizedMessage</code> method returns <code>null</code> because we only get back the class name <code>s</code> as output: (<code>MyError2</code>) as opposed to: <code>MyError2: message</code>.</p>
<p>Let’s follow along to <code>getLocalizedMessage</code> to see how <code>message</code> is calculated:</p>
<div class="sourceCode"><pre class="sourceCode java scrollx"><code class="sourceCode java"><span class="kw">public</span> String <span class="fu">getLocalizedMessage</span>() {
    <span class="kw">return</span> <span class="fu">getMessage</span>();
}</code></pre></div>
<p>and also to <code>getMessage</code>:</p>
<div class="sourceCode"><pre class="sourceCode java scrollx"><code class="sourceCode java"><span class="kw">public</span> String <span class="fu">getMessage</span>() {
    <span class="kw">return</span> detailMessage;
}</code></pre></div>
<p>The <code>detailMessage</code> field is set through the many of the constructor methods for <code>Throwable</code>:</p>
<div class="sourceCode"><pre class="sourceCode java scrollx"><code class="sourceCode java"><span class="kw">public</span> Throwable(String message) {
    <span class="fu">fillInStackTrace</span>();
    detailMessage = message; <span class="co">//set</span>
}

<span class="co">//or</span>

<span class="kw">public</span> Throwable(String message, Throwable cause) {
    <span class="fu">fillInStackTrace</span>();
    detailMessage = message; <span class="co">//set</span>
    <span class="kw">this</span>.<span class="fu">cause</span> = cause;
}

<span class="co">//or</span>

<span class="kw">public</span> Throwable(Throwable cause) {
    <span class="fu">fillInStackTrace</span>();
    detailMessage = (cause==<span class="kw">null</span> ? <span class="kw">null</span> : cause.<span class="fu">toString</span>());  <span class="co">//set</span>
    <span class="kw">this</span>.<span class="fu">cause</span> = cause;
}

<span class="co">//or</span>

<span class="kw">protected</span> Throwable(String message, Throwable cause,
                    <span class="dt">boolean</span> enableSuppression,
                    <span class="dt">boolean</span> writableStackTrace) {
    <span class="kw">if</span> (writableStackTrace) {
        <span class="fu">fillInStackTrace</span>();
    } <span class="kw">else</span> {
        stackTrace = <span class="kw">null</span>;
    }
    detailMessage = message;  <span class="co">//set</span>
    <span class="kw">this</span>.<span class="fu">cause</span> = cause;
    <span class="kw">if</span> (!enableSuppression)
        suppressedExceptions = <span class="kw">null</span>;
}</code></pre></div>
<p>Since we have a field named <code>message</code> and not <code>detailMessage</code>, we don’t really override the value used by <code>Throwable</code> to generate its <code>toString</code> implementation.</p>
<h2 id="workarounds">Workarounds</h2>
<p>If we renamed our <code>message</code> field in <code>MyError2</code> to <code>detailMessage</code> we should be able to get our <code>toString</code> implementation working:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">import</span> scala.<span class="fu">util</span>.<span class="fu">control</span>.<span class="fu">NoStackTrace</span>

<span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError2</span>(detailMessage: String) <span class="kw">extends</span> NoStackTrace

scala&gt; <span class="fu">MyError2</span>(<span class="st">&quot;Oh noes&quot;</span>)
<span class="kw">val</span> res37: MyError2 = MyError2 <span class="co">//Doesn&#39;t work</span></code></pre></div>
<p>Wow! That didn’t work either. Why though?</p>
<p>If we look at the definition of the <code>detailMessage</code> field on <code>java.lang.Throwable</code> we see that it’s <strong>private</strong>:</p>
<div class="sourceCode"><pre class="sourceCode java scrollx"><code class="sourceCode java"><span class="kw">private</span> String detailMessage;</code></pre></div>
<p>This means we can’t override it from a sub class. Boo!</p>
<p>From our previous investigation we can see that all we need to do is override either <code>getLocalizedMessage</code> or <code>getMessage</code> or <code>toString</code> which are all <strong>public</strong>:</p>
<pre><code>public String toString() {
    String s = getClass().getName();
    String message = getLocalizedMessage(); //message calculated from here
    return (message != null) ? (s + &quot;: &quot; + message) : s;
}


public String getLocalizedMessage() {
    return getMessage(); //message content retrieved from here
}


public String getMessage() {
    return detailMessage; //message content
}</code></pre>
<h3 id="override-getmessage-or-getlocalizedmessage">Override getMessage or getLocalizedMessage</h3>
<p>By overriding <code>getMessage</code> or <code>getLocalizedMessage</code> in our case class, we can get some form of <code>toString</code>-ery happening. While this is not ideal, it “works”.</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">import</span> scala.<span class="fu">util</span>.<span class="fu">control</span>.<span class="fu">NoStackTrace</span>

<span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError2</span>(<span class="kw">override</span> <span class="kw">val</span> getMessage: String) <span class="kw">extends</span> NoStackTrace

scala&gt; <span class="fu">MyError2</span>(<span class="st">&quot;Oh noes&quot;</span>)
<span class="kw">val</span> res38: MyError2 = MyError2: Oh noes <span class="co">//We did it!</span></code></pre></div>
<h3 id="override-tostring">Override toString</h3>
<p>If you want a more case classy <code>toString</code> implementation, you’re going to have to do it yourself:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError2</span>(message: String) <span class="kw">extends</span> NoStackTrace {
  <span class="kw">override</span> <span class="kw">def</span> toString: String = s<span class="st">&quot;MyError2($message)&quot;</span>
}

scala&gt; <span class="fu">MyError2</span>(<span class="st">&quot;Oh noes&quot;</span>)
<span class="kw">val</span> res39: MyError2 = <span class="fu">MyError2</span>(Oh noes) <span class="co">//we have case classiness</span></code></pre></div>
<p>Now we can get our test to fail with a better error message:</p>
<div class="sourceCode"><pre class="sourceCode scala scrollx"><code class="sourceCode scala"><span class="kw">import</span> scala.<span class="fu">util</span>.<span class="fu">control</span>.<span class="fu">NoStackTrace</span>

<span class="kw">object</span> MyErrorSuiteTake2 <span class="kw">extends</span> weaver.<span class="fu">FunSuite</span> {

<span class="kw">sealed</span> <span class="kw">trait</span> MyError <span class="kw">extends</span> NoStackTrace {
  <span class="kw">val</span> message: String

  <span class="kw">override</span> <span class="kw">def</span> toString: String = {
    <span class="kw">val</span> className = getClass.<span class="fu">getName</span>
    s<span class="st">&quot;$className($message)&quot;</span>
   }
}

<span class="kw">final</span> <span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError1</span>(message: String) <span class="kw">extends</span>  MyError
<span class="kw">final</span> <span class="kw">case</span> <span class="kw">class</span> <span class="fu">MyError2</span>(message: String) <span class="kw">extends</span>  MyError

  <span class="fu">test</span>(<span class="st">&quot;error message&quot;</span>) {
    expect.<span class="fu">same</span>(<span class="fu">MyError1</span>(<span class="st">&quot;error1&quot;</span>), <span class="fu">MyError2</span>(<span class="st">&quot;error2&quot;</span>))
  }
}</code></pre></div>
<p>Which results in:</p>
<pre class="terminal scrollx"><code>info] com.example.validation.extra.MyErrorSuiteTake2
[error] - error message 38ms
[error]   Values not equal: (src/test/scala/com/example/validation/extra/MyErrorSuiteTake2.scala:20)
[error]
[error]   com.example.validation.extra.MyErrorSuiteTake2$[MyError1]([error1])  |  com.example.validation.extra.MyErrorSuiteTake2$[MyError2]([error2])
</code></pre>
<p>All this seems a bit tedious… as does extending the <code>Exception</code> hierarchy. If you do decide to go this route, hopefully this will help you stave off at least one of the issues with extending <code>java.lang.Throwable</code> and friends.</p>]]></description>
    <pubDate>Wed, 20 Jul 2022 00:00:00 UT</pubDate>
    <guid>http://blog.ssanj.net/posts/2022-07-20-extending-scala-case-class-with-nostacktrace-leads-to-unexpected-tostring-behaviour.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>Naming a tmux Session</title>
    <link>http://blog.ssanj.net/posts/2022-07-16-naming-a-tmux-session.html</link>
    <description><![CDATA[<p>When you start a new <a href="https://github.com/tmux/tmux">tmux</a> session with:</p>
<pre class="terminal scrollx"><code>tmux</code></pre>
<p>If you list your tmux session with:</p>
<pre class="terminal scrollx"><code>tmux ls</code></pre>
<p>You’ll see a default name used for your sessions:</p>
<pre class="terminal scrollx"><code>2: 1 windows (created Sat Jul 16 15:59:49 2022) (attached)</code></pre>
<p>In the above the name of the tmux session is <strong>2</strong>. Remembering these numbers can become unwheldly when you have many tmux sessions running, each with a different purpose.</p>
<p>The easier way to create a new session is by giving it a name of your choosing:</p>
<pre class="terminal scrollx"><code>tmux new -s your_cool_name_here</code></pre>
<p>And now when you list your tmux sessions, you can easily find the session you just created:</p>
<pre class="terminal scrollx"><code>your_cool_name_here: 1 windows (created Sat Jul 16 16:03:46 2022) (attached)</code></pre>]]></description>
    <pubDate>Sat, 16 Jul 2022 00:00:00 UT</pubDate>
    <guid>http://blog.ssanj.net/posts/2022-07-16-naming-a-tmux-session.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>How to Move a Tab Between Split Panes in Sublime Text</title>
    <link>http://blog.ssanj.net/posts/2022-06-29-how-to-move-a-tab-between-split-panes-in-sublime-text.html</link>
    <description><![CDATA[<p>When looking up definitions of a complex <a href="https://scala-lang.org/">Scala</a> class in <a href="https://www.sublimetext.com/">Sublime Text</a> it’s quite common to open up a lot of related classes; each in a separate tab. 🤦🏾</p>
<div class="figure">
<img src="/images/how-to-move-between-split-panes-st/many-tabs.png" alt="Related Classes" />
<p class="caption">Related Classes</p>
</div>
<p>In the past, I opened related classes in a new tab with the <code>goto_definition</code> command. This opens the class in a new tab in the current pane. I would repeat this for every definition I needed to look up. This very quickly leads to a lot of open tabs as shown in the image above.</p>
<p>It becomes very hard to keep track of the original class you were working on because there are so many tabs open. This can get overwhelming in more complex projects, sometimes leading to tens of related classes open in separate tabs.</p>
<p>One way I’ve found to manage this “tab overload” is to move these related classes to another split pane. For example you can create a vertical split pane with the <code>CMD</code> + <code>ALT</code> + <code>SHIFT</code> + <code>2</code> key combo.</p>
<div class="figure">
<img src="/images/how-to-move-between-split-panes-st/horizontal-split.png" alt="Vertical Split Pane" />
<p class="caption">Vertical Split Pane</p>
</div>
<p>I used to click-and-drag the required tabs between split panes.</p>
<div class="figure">
<img src="/images/how-to-move-between-split-panes-st/click-drag-between-panes.gif" alt="Dragging Tabs Between Panes" />
<p class="caption">Dragging Tabs Between Panes</p>
</div>
<p>While this is fine it does become a little tedious when you have many open tabs that you want to move. It’s much easier if you can do it through a keyboard shortcut.</p>
<p>To my surprise, Sublime Text already had this feature buried in the <code>View</code> menu. Sublime Text refers to the split panes as “groups” and lets you move files between these “groups”.</p>
<div class="figure">
<img src="/images/how-to-move-between-split-panes-st/st-menu.png" alt="Sublime Text View Menu" />
<p class="caption">Sublime Text View Menu</p>
</div>
<p>Now I can seamlessly move tabs to pane below with <code>CTRL</code> + <code>SHIFT</code> + <code>2</code>. So much easier :) What would make this even better is if Sublime Text selected the tab to the <code>right</code> after a move instead of the one on the <code>left</code>. That way you could combo your way through all the open tabs (assuming they were stacked to the right) without moving your mouse .</p>
<div class="figure">
<img src="/images/how-to-move-between-split-panes-st/move-views-between-panes.gif" alt="Move to Split Pane 2" />
<p class="caption">Move to Split Pane 2</p>
</div>
<p>More generally you can move tabs to a pane with a given number with <code>CTRL</code> + <code>SHIFT</code> + <code>PANE_NUMBER</code></p>]]></description>
    <pubDate>Wed, 29 Jun 2022 00:00:00 UT</pubDate>
    <guid>http://blog.ssanj.net/posts/2022-06-29-how-to-move-a-tab-between-split-panes-in-sublime-text.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>Feedback on Java Planet Enum in Haskell</title>
    <link>http://blog.ssanj.net/posts/2021-09-09-feedback-on-java-planet-enum-in-Haskell.html</link>
    <description><![CDATA[<p>A few weeks ago I <a href="https://sanj.ink/posts/2021-08-26-java-planet-enum-in-Haskell.html">posted</a> my attempt at implementing <a href="https://docs.oracle.com/javase/tutorial/java/javaOO/enum.html">Java’s Planet Enumeration example</a> in Haskell. There was some useful feedback from <a href="https://www.reddit.com/r/haskell/comments/petl9t/encoding_the_java_planet_enumeration_example_in/">Reddit</a>, so I though I’d discuss the different implementation options mentioned.</p>
<p><a href="https://www.reddit.com/user/brandonchinn178/">brandonchinn178</a> mentioned some great changes. The first was to do away with <code>PlanetStat</code> and replace it with functions that pulled out the necessary data when given a Planet:</p>
<blockquote>
<p>You mentioned Java having a “mapping for free”. In Haskell, you can also get mappings for free with functions; after all, functions are maps from inputs to outputs</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="ot">radius ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Radius</span>
radius <span class="dt">Mercury</span> <span class="fu">=</span> <span class="fu">...</span>
radius <span class="fu">...</span> <span class="fu">=</span> <span class="fu">...</span>

<span class="ot">mass ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Mass</span>
mass <span class="dt">Mercury</span> <span class="fu">=</span> <span class="fu">...</span>
mass <span class="fu">...</span> <span class="fu">=</span> <span class="fu">...</span></code></pre></div>
<blockquote>
<p>This gets rid of the need for the PlanetStat data type, which I think is better, but wouldnt be good if eventually, you want to load the stats from a JSON file (for example)</p>
</blockquote>
<p>This is more idiotmatic Haskell. The only down side is that you don’t pull out all the information you need at the same time and have to write two functions in this case.</p>
<p>He also mentioned a few other changes:</p>
<blockquote>
<p>you dont need type annotations for minBound/maxBound, since you have the final result typed as [Planet]</p>
</blockquote>
<p>This is true and an easy fix.</p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="ot">planetValues ::</span> [<span class="dt">Planet</span>]
planetValues <span class="fu">=</span> [minBound <span class="fu">..</span> maxBound]</code></pre></div>
<blockquote>
<p>I personally wouldnt have a newtype for literally every single function output. I would say its fine to just return a Double for surface gravity / weight</p>
</blockquote>
<p>I erred on the side of “readability” for this one, but adding in a lot of newtypes does add noise.</p>
<blockquote>
<p>“massOnEarth” is misleading: its the mass regardless of what planet youre on</p>
</blockquote>
<p>I am not so sure about this one. From the Java example it does seem like the mass supplied is the one on Earth which is then compared to its mass on other planets.</p>
<blockquote>
<p>instead of traversing a simple putStrLn over a formatted list of strings, I would defer the string rendering as much as possible, e.g.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="kw">let</span> planetToWeight <span class="fu">=</span> map (\p <span class="ot">-&gt;</span> (p, surfaceWeight massOnEarth p)) [minBound <span class="fu">..</span> maxBound]
    render (p, weight) <span class="fu">=</span> <span class="st">&quot;Your weight on &quot;</span> <span class="fu">&lt;&gt;</span> show p <span class="fu">&lt;&gt;</span> <span class="fu">...</span>
<span class="kw">in</span> mapM_ (putStrLn <span class="fu">.</span> render) planetToWeight</code></pre></div>
<p>I’ve always found Haskell’s String concatenation/interpolation a bit clunky so I’ve taken to separating the String generation to separate functions. But this suggestion makes a lot of sense - collect all your data and then render it once without rendering pieces of your data as you go.</p>
<blockquote>
<p>or even just go all-in with the iteration</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell">runPlanets earthWeight <span class="fu">=</span>
  forM_ [minBound <span class="fu">..</span> maxBound] <span class="fu">$</span> \planet <span class="ot">-&gt;</span> <span class="kw">do</span>
    <span class="kw">let</span> newWeight <span class="fu">=</span> surfaceWeight mass planet
    putStrLn <span class="fu">$</span> <span class="st">&quot;Your mass on &quot;</span> <span class="fu">&lt;&gt;</span> show planet <span class="fu">&lt;&gt;</span> <span class="fu">...</span>
  <span class="kw">where</span>
    mass <span class="fu">=</span>
      <span class="kw">let</span> <span class="dt">SurfaceGravity</span> earthGravity <span class="fu">=</span> surfaceGravity <span class="dt">EARTH</span>
      <span class="kw">in</span> <span class="dt">Mass</span> <span class="fu">$</span> earthWeight <span class="fu">/</span> earthGravity</code></pre></div>
<p>Another interesting suggestion.</p>
<p>I think the biggest trap I fell into while encoding the Java solution into Haskell was just that - Encoding a Java solution into Haskell. Instead, I should have solved it in the way Haskell enables you to.</p>
<p><a href="https://www.reddit.com/user/asthetaperlight/">asthetaperlight</a> had some ideas on the use of newtypes:</p>
<blockquote>
<p>For throwaway code like this, sure. But it would also be fine to write it as a shell script, if for some reason you really felt like it. Dimensional analysis is the static typing of physics. Not the fancy stuff that makes you want to use Haskell instead of Java - the “has literally any types at all” that makes you want to use C instead of B. Better to build good habits before you need them.</p>
</blockquote>
<blockquote>
<p>That said, SurfaceWeight doesn’t make much sense as written. Either go all in and tag it with a phantom Planet …</p>
</blockquote>
<p><code>SurfaceWeight</code> didn’t really make much sense on its own. I love the idea about saying “this is the weight on this planet” and tagging the weight with a phantom Planet.</p>
<p>The warning around using the above technique is funny and cautions against using unnecessary complexity:</p>
<blockquote>
<p>Then seriously rethink whatever aspect of your design made that seem necessary …</p>
</blockquote>
<p>😂</p>
<blockquote>
<p>or make it what it is: newtype Weight = Weight Double.</p>
</blockquote>
<p><code>SurfaceWeight</code> seems too specific and <code>Weight</code> seems like a more natural wrapper type.</p>
<p><a href="https://www.reddit.com/user/friedbrice/">friedbrice</a> has some interesting insights:</p>
<blockquote>
<p>Nice post, I hope you’re enjoying Haskell.</p>
</blockquote>
<blockquote>
<p>One thing that I find interesting, you bring up a decisive difference between object oriented programming and functional programming: how object oriented programming packages data and behavior together, and how functional programming separates data and behavior. it may seem like a bummer at first that you have to write each enum value twice, once when the data is defined, and once when the behavior is defined, but there’s a very good reason that functional programming encourages this separation.</p>
</blockquote>
<blockquote>
<p>I think we anthropomorphize the computer too much, and so I don’t like calling it behavior. I like calling it interpretation, specifically interpretation of the data. One common theme of object oriented programming is that the downstream user is not allowed to interpret the data. The data is hidden from them, and the interpretation is defined solely by the upstream user. sometimes, this is exactly what you want. Haskell has many ways to hide data, not least of all are simple things like partial application and closures, hiding through scope instead of access modifiers.</p>
</blockquote>
<blockquote>
<p>The problem is that object oriented programming insists that you always hide your data like this. most of the time, you don’t want to hide your data. Your behavior, your planet stats, is one interpretation of the data. The power of functional programming is that it need not be the only interpretation.</p>
</blockquote>
<p>This idea of “data” having multiple “interpretations” is pretty cool. It’s something I had not thought of explicitly before. As previously mentioned by brandonchinn178, we could define a function each to get the <code>mass</code> and <code>radius</code> from a <code>Planet</code> as opposed to a <code>PlanetStat</code>. This is yet another interpretation of the <code>Planet</code> “data”.</p>
<h2 id="code-with-recommendations">Code with Recommendations</h2>
<p><details> <summary>brandonchinn178’s recommendations</summary></p>
<h3 id="brandonchinn178---1">brandonchinn178 - 1</h3>
<p><a href="https://github.com/ssanj/java-plants-enum-in-haskell/blob/main/src/Recommendations/Brandonchinn178/Planets_1.hs">code</a></p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="kw">module</span> <span class="dt">Recommendations.Brandonchinn178.Planets_1</span>(runPlanets) <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Data.Foldable</span> (traverse_)

<span class="co">-- Haskell implementation of the Java Enum: Planets example</span>
<span class="co">-- https://docs.oracle.com/javase/tutorial/java/javaOO/enum.html</span>

<span class="kw">import </span><span class="dt">Data.Foldable</span> (traverse_)


<span class="kw">data</span> <span class="dt">Planet</span> <span class="fu">=</span> <span class="dt">MERCURY</span>
            <span class="fu">|</span> <span class="dt">VENUS</span>
            <span class="fu">|</span> <span class="dt">EARTH</span>
            <span class="fu">|</span> <span class="dt">MARS</span>
            <span class="fu">|</span> <span class="dt">JUPITER</span>
            <span class="fu">|</span> <span class="dt">SATURN</span>
            <span class="fu">|</span> <span class="dt">URANUS</span>
            <span class="fu">|</span> <span class="dt">NEPTUNE</span> <span class="kw">deriving</span> (<span class="dt">Enum</span>, <span class="dt">Bounded</span>, <span class="dt">Show</span>)


<span class="kw">newtype</span> <span class="dt">Mass</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="dt">Double</span>


<span class="kw">newtype</span> <span class="dt">Radius</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="dt">Double</span>


<span class="ot">gConstant ::</span> <span class="dt">Double</span>
gConstant <span class="fu">=</span> <span class="fl">6.67300E-11</span>


<span class="ot">radius ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Radius</span>
radius <span class="dt">MERCURY</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">2.4397e6</span>
radius <span class="dt">VENUS</span>   <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">6.0518e6</span>
radius <span class="dt">EARTH</span>   <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">6.37814e6</span>
radius <span class="dt">MARS</span>    <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">3.3972e6</span>
radius <span class="dt">JUPITER</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">7.1492e7</span>
radius <span class="dt">SATURN</span>  <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">6.0268e7</span>
radius <span class="dt">URANUS</span>  <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">2.5559e7</span>
radius <span class="dt">NEPTUNE</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">2.4746e7</span>


<span class="ot">mass ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Mass</span>
mass <span class="dt">MERCURY</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">3.303e+23</span>
mass <span class="dt">VENUS</span>   <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">4.869e+24</span>
mass <span class="dt">EARTH</span>   <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">5.976e+24</span>
mass <span class="dt">MARS</span>    <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">6.421e+23</span>
mass <span class="dt">JUPITER</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">1.9e+27</span>
mass <span class="dt">SATURN</span>  <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">5.688e+26</span>
mass <span class="dt">URANUS</span>  <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">8.686e+25</span>
mass <span class="dt">NEPTUNE</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">1.024e+26</span>


<span class="ot">surfaceGravity ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Double</span>
surfaceGravity planet <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">Mass</span> m)   <span class="fu">=</span> mass planet
        (<span class="dt">Radius</span> r) <span class="fu">=</span> radius planet
    <span class="kw">in</span> gConstant <span class="fu">*</span> m <span class="fu">/</span> (r <span class="fu">*</span> m)


<span class="ot">surfaceWeight ::</span> <span class="dt">Mass</span> <span class="ot">-&gt;</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Double</span>
surfaceWeight (<span class="dt">Mass</span> otherMass) planet <span class="fu">=</span>
    <span class="kw">let</span> sg <span class="fu">=</span> surfaceGravity planet
    <span class="kw">in</span> otherMass <span class="fu">*</span> sg


<span class="ot">runPlanets ::</span> <span class="dt">Double</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()
runPlanets sampleWeight <span class="fu">=</span>
    <span class="kw">let</span> earthSurfaceGravity <span class="fu">=</span> surfaceGravity <span class="dt">EARTH</span>

<span class="ot">        massOnEarth ::</span> <span class="dt">Mass</span>
        massOnEarth <span class="fu">=</span> <span class="dt">Mass</span> <span class="fu">$</span> sampleWeight <span class="fu">/</span> earthSurfaceGravity

        planetToWeight <span class="fu">=</span> map (\p <span class="ot">-&gt;</span> (p, surfaceWeight massOnEarth p)) [minBound <span class="fu">..</span> maxBound]
        render (p, weight) <span class="fu">=</span> <span class="st">&quot;Your weight on &quot;</span> <span class="fu">&lt;&gt;</span> show p <span class="fu">&lt;&gt;</span> <span class="st">&quot; is &quot;</span> <span class="fu">&lt;&gt;</span> (show weight)

    <span class="kw">in</span> mapM_ (putStrLn <span class="fu">.</span> render) planetToWeight</code></pre></div>
<h3 id="brandonchinn178---2">brandonchinn178 - 2</h3>
<p><a href="https://github.com/ssanj/java-plants-enum-in-haskell/blob/main/src/Recommendations/Brandonchinn178/Planets_2.hs">code</a></p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="kw">module</span> <span class="dt">Recommendations.Brandonchinn178.Planets_2</span>(runPlanets) <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Data.Foldable</span> (forM_, traverse_)

<span class="co">-- Haskell implementation of the Java Enum: Planets example</span>
<span class="co">-- https://docs.oracle.com/javase/tutorial/java/javaOO/enum.html</span>

<span class="kw">import </span><span class="dt">Data.Foldable</span> (traverse_)


<span class="kw">data</span> <span class="dt">Planet</span> <span class="fu">=</span> <span class="dt">MERCURY</span>
            <span class="fu">|</span> <span class="dt">VENUS</span>
            <span class="fu">|</span> <span class="dt">EARTH</span>
            <span class="fu">|</span> <span class="dt">MARS</span>
            <span class="fu">|</span> <span class="dt">JUPITER</span>
            <span class="fu">|</span> <span class="dt">SATURN</span>
            <span class="fu">|</span> <span class="dt">URANUS</span>
            <span class="fu">|</span> <span class="dt">NEPTUNE</span> <span class="kw">deriving</span> (<span class="dt">Enum</span>, <span class="dt">Bounded</span>, <span class="dt">Show</span>)


<span class="kw">newtype</span> <span class="dt">Mass</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="dt">Double</span>


<span class="kw">newtype</span> <span class="dt">Radius</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="dt">Double</span>


<span class="ot">gConstant ::</span> <span class="dt">Double</span>
gConstant <span class="fu">=</span> <span class="fl">6.67300E-11</span>


<span class="ot">radius ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Radius</span>
radius <span class="dt">MERCURY</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">2.4397e6</span>
radius <span class="dt">VENUS</span>   <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">6.0518e6</span>
radius <span class="dt">EARTH</span>   <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">6.37814e6</span>
radius <span class="dt">MARS</span>    <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">3.3972e6</span>
radius <span class="dt">JUPITER</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">7.1492e7</span>
radius <span class="dt">SATURN</span>  <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">6.0268e7</span>
radius <span class="dt">URANUS</span>  <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">2.5559e7</span>
radius <span class="dt">NEPTUNE</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">2.4746e7</span>


<span class="ot">mass ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Mass</span>
mass <span class="dt">MERCURY</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">3.303e+23</span>
mass <span class="dt">VENUS</span>   <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">4.869e+24</span>
mass <span class="dt">EARTH</span>   <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">5.976e+24</span>
mass <span class="dt">MARS</span>    <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">6.421e+23</span>
mass <span class="dt">JUPITER</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">1.9e+27</span>
mass <span class="dt">SATURN</span>  <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">5.688e+26</span>
mass <span class="dt">URANUS</span>  <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">8.686e+25</span>
mass <span class="dt">NEPTUNE</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">1.024e+26</span>


<span class="ot">surfaceGravity ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Double</span>
surfaceGravity planet <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">Mass</span> m)   <span class="fu">=</span> mass planet
        (<span class="dt">Radius</span> r) <span class="fu">=</span> radius planet
    <span class="kw">in</span> gConstant <span class="fu">*</span> m <span class="fu">/</span> (r <span class="fu">*</span> m)


<span class="ot">surfaceWeight ::</span> <span class="dt">Mass</span> <span class="ot">-&gt;</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Double</span>
surfaceWeight (<span class="dt">Mass</span> otherMass) planet <span class="fu">=</span>
    <span class="kw">let</span> sg <span class="fu">=</span> surfaceGravity planet
    <span class="kw">in</span> otherMass <span class="fu">*</span> sg


<span class="ot">runPlanets ::</span> <span class="dt">Double</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()
runPlanets earthWeight <span class="fu">=</span>
  forM_ [minBound <span class="fu">..</span> maxBound] <span class="fu">$</span> \planet <span class="ot">-&gt;</span> <span class="kw">do</span>
    <span class="kw">let</span> newWeight <span class="fu">=</span> surfaceWeight mass planet
    putStrLn <span class="fu">$</span> <span class="st">&quot;Your weight on &quot;</span> <span class="fu">&lt;&gt;</span> show planet <span class="fu">&lt;&gt;</span> <span class="st">&quot; is &quot;</span> <span class="fu">&lt;&gt;</span> (show newWeight)
  <span class="kw">where</span>
    mass <span class="fu">=</span>
      <span class="kw">let</span> earthGravity <span class="fu">=</span> surfaceGravity <span class="dt">EARTH</span>
      <span class="kw">in</span> <span class="dt">Mass</span> <span class="fu">$</span> earthWeight <span class="fu">/</span> earthGravity</code></pre></div>
<p></details></p>
<p><details> <summary>asthetaperlight’s recommendations</summary></p>
<h3 id="asthetaperlight">asthetaperlight</h3>
<p><a href="https://github.com/ssanj/java-plants-enum-in-haskell/blob/main/src/Recommendations/Asthetaperlight/Planets.hs">code</a></p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="kw">module</span> <span class="dt">Recommendations.Asthetaperlight.Planets</span>(runPlanets) <span class="kw">where</span>

<span class="co">-- Haskell implementation of the Java Enum: Planets example</span>
<span class="co">-- https://docs.oracle.com/javase/tutorial/java/javaOO/enum.html</span>

<span class="kw">import </span><span class="dt">Data.Foldable</span> (traverse_)


<span class="kw">data</span> <span class="dt">Planet</span> <span class="fu">=</span> <span class="dt">MERCURY</span>
            <span class="fu">|</span> <span class="dt">VENUS</span>
            <span class="fu">|</span> <span class="dt">EARTH</span>
            <span class="fu">|</span> <span class="dt">MARS</span>
            <span class="fu">|</span> <span class="dt">JUPITER</span>
            <span class="fu">|</span> <span class="dt">SATURN</span>
            <span class="fu">|</span> <span class="dt">URANUS</span>
            <span class="fu">|</span> <span class="dt">NEPTUNE</span> <span class="kw">deriving</span> (<span class="dt">Enum</span>, <span class="dt">Bounded</span>, <span class="dt">Show</span>)


<span class="kw">newtype</span> <span class="dt">Mass</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="dt">Double</span>


<span class="kw">newtype</span> <span class="dt">Radius</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="dt">Double</span>


<span class="kw">data</span> <span class="dt">PlanetStat</span> <span class="fu">=</span>
    <span class="dt">PlanetStat</span> {
<span class="ot">        mass   ::</span> <span class="dt">Mass</span>
    ,<span class="ot">   radius ::</span> <span class="dt">Radius</span>
    }


<span class="kw">newtype</span> <span class="dt">SurfaceGravity</span> <span class="fu">=</span> <span class="dt">SurfaceGravity</span> <span class="dt">Double</span>


<span class="kw">newtype</span> <span class="dt">Weight</span> <span class="fu">=</span> <span class="dt">Weight</span> <span class="dt">Double</span>


<span class="ot">gConstant ::</span> <span class="dt">Double</span>
gConstant <span class="fu">=</span> <span class="fl">6.67300E-11</span>

<span class="ot">planetStat ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">PlanetStat</span>
planetStat <span class="dt">MERCURY</span> <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">3.303e+23</span>) (<span class="dt">Radius</span> <span class="fl">2.4397e6</span> )
planetStat <span class="dt">VENUS</span>   <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">4.869e+24</span>) (<span class="dt">Radius</span> <span class="fl">6.0518e6</span> )
planetStat <span class="dt">EARTH</span>   <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">5.976e+24</span>) (<span class="dt">Radius</span> <span class="fl">6.37814e6</span>)
planetStat <span class="dt">MARS</span>    <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">6.421e+23</span>) (<span class="dt">Radius</span> <span class="fl">3.3972e6</span> )
planetStat <span class="dt">JUPITER</span> <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">1.9e+27</span>  ) (<span class="dt">Radius</span> <span class="fl">7.1492e7</span> )
planetStat <span class="dt">SATURN</span>  <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">5.688e+26</span>) (<span class="dt">Radius</span> <span class="fl">6.0268e7</span> )
planetStat <span class="dt">URANUS</span>  <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">8.686e+25</span>) (<span class="dt">Radius</span> <span class="fl">2.5559e7</span> )
planetStat <span class="dt">NEPTUNE</span> <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">1.024e+26</span>) (<span class="dt">Radius</span> <span class="fl">2.4746e7</span> )


<span class="ot">surfaceGravity ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">SurfaceGravity</span>
surfaceGravity planet <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">PlanetStat</span> (<span class="dt">Mass</span> mass) (<span class="dt">Radius</span> radius)) <span class="fu">=</span> planetStat planet
    <span class="kw">in</span> <span class="dt">SurfaceGravity</span> <span class="fu">$</span> gConstant <span class="fu">*</span> mass <span class="fu">/</span> (radius <span class="fu">*</span> radius)


<span class="ot">surfaceWeight ::</span> <span class="dt">Mass</span> <span class="ot">-&gt;</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Weight</span>
surfaceWeight (<span class="dt">Mass</span> otherMass) planet <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">SurfaceGravity</span> sg)<span class="fu">=</span> surfaceGravity planet
    <span class="kw">in</span> <span class="dt">Weight</span> <span class="fu">$</span> otherMass <span class="fu">*</span> sg


<span class="ot">runPlanets ::</span> <span class="dt">Double</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()
runPlanets earthWeight <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">SurfaceGravity</span> earthSurfaceGravity) <span class="fu">=</span> surfaceGravity <span class="dt">EARTH</span>

<span class="ot">        massOnEarth ::</span> <span class="dt">Mass</span>
        massOnEarth <span class="fu">=</span> <span class="dt">Mass</span> <span class="fu">$</span> earthWeight <span class="fu">/</span> earthSurfaceGravity

<span class="ot">        planetValues ::</span> [<span class="dt">Planet</span>]
        planetValues <span class="fu">=</span> [(minBound<span class="ot"> ::</span> <span class="dt">Planet</span>) <span class="fu">..</span> (maxBound<span class="ot"> ::</span> <span class="dt">Planet</span>)]

<span class="ot">        printSurfaceWeight ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Weight</span> <span class="ot">-&gt;</span> <span class="dt">String</span>
        printSurfaceWeight planet (<span class="dt">Weight</span> sw) <span class="fu">=</span> <span class="st">&quot;Your weight on &quot;</span> <span class="fu">&lt;&gt;</span> (show planet) <span class="fu">&lt;&gt;</span> <span class="st">&quot; is &quot;</span> <span class="fu">&lt;&gt;</span> (show sw)

<span class="ot">        planetStatsStrings ::</span> [<span class="dt">String</span>]
        planetStatsStrings <span class="fu">=</span> (\p <span class="ot">-&gt;</span> printSurfaceWeight p (surfaceWeight massOnEarth p)) <span class="fu">&lt;$&gt;</span> planetValues
    <span class="kw">in</span>
       traverse_ putStrLn planetStatsStrings</code></pre></div>
<p></details></p>
<p><details open> <summary>Final Update</summary></p>
<p>And here’s the final implementation I decided to use given the above recommendations:</p>
<p><a href="https://github.com/ssanj/java-plants-enum-in-haskell/blob/main/src/Final/Planets.hs">code</a></p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="kw">module</span> <span class="dt">Final.Planets</span>(runPlanets) <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Data.Foldable</span> (traverse_)

<span class="co">-- Haskell implementation of the Java Enum: Planets example</span>
<span class="co">-- https://docs.oracle.com/javase/tutorial/java/javaOO/enum.html</span>

<span class="kw">import </span><span class="dt">Data.Foldable</span> (traverse_)


<span class="kw">data</span> <span class="dt">Planet</span> <span class="fu">=</span> <span class="dt">MERCURY</span>
            <span class="fu">|</span> <span class="dt">VENUS</span>
            <span class="fu">|</span> <span class="dt">EARTH</span>
            <span class="fu">|</span> <span class="dt">MARS</span>
            <span class="fu">|</span> <span class="dt">JUPITER</span>
            <span class="fu">|</span> <span class="dt">SATURN</span>
            <span class="fu">|</span> <span class="dt">URANUS</span>
            <span class="fu">|</span> <span class="dt">NEPTUNE</span> <span class="kw">deriving</span> (<span class="dt">Enum</span>, <span class="dt">Bounded</span>, <span class="dt">Show</span>)


<span class="kw">newtype</span> <span class="dt">Mass</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="dt">Double</span>


<span class="kw">newtype</span> <span class="dt">Radius</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="dt">Double</span>


<span class="ot">gConstant ::</span> <span class="dt">Double</span>
gConstant <span class="fu">=</span> <span class="fl">6.67300E-11</span>


<span class="ot">radius ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Radius</span>
radius <span class="dt">MERCURY</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">2.4397e6</span>
radius <span class="dt">VENUS</span>   <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">6.0518e6</span>
radius <span class="dt">EARTH</span>   <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">6.37814e6</span>
radius <span class="dt">MARS</span>    <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">3.3972e6</span>
radius <span class="dt">JUPITER</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">7.1492e7</span>
radius <span class="dt">SATURN</span>  <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">6.0268e7</span>
radius <span class="dt">URANUS</span>  <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">2.5559e7</span>
radius <span class="dt">NEPTUNE</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="fl">2.4746e7</span>


<span class="ot">mass ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Mass</span>
mass <span class="dt">MERCURY</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">3.303e+23</span>
mass <span class="dt">VENUS</span>   <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">4.869e+24</span>
mass <span class="dt">EARTH</span>   <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">5.976e+24</span>
mass <span class="dt">MARS</span>    <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">6.421e+23</span>
mass <span class="dt">JUPITER</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">1.9e+27</span>
mass <span class="dt">SATURN</span>  <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">5.688e+26</span>
mass <span class="dt">URANUS</span>  <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">8.686e+25</span>
mass <span class="dt">NEPTUNE</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="fl">1.024e+26</span>


<span class="kw">newtype</span> <span class="dt">Gravity</span> <span class="fu">=</span> <span class="dt">Gravity</span> <span class="dt">Double</span> <span class="kw">deriving</span> <span class="dt">Show</span>

<span class="kw">newtype</span> <span class="dt">Weight</span> <span class="fu">=</span> <span class="dt">Weight</span> <span class="dt">Double</span> <span class="kw">deriving</span> <span class="dt">Show</span>


<span class="ot">surfaceGravity ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Gravity</span>
surfaceGravity planet <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">Mass</span> mass&#39;)     <span class="fu">=</span> mass planet
        (<span class="dt">Radius</span> radius&#39;) <span class="fu">=</span> radius planet
    <span class="kw">in</span> <span class="dt">Gravity</span> <span class="fu">$</span> gConstant <span class="fu">*</span> mass&#39; <span class="fu">/</span> (radius&#39; <span class="fu">*</span> radius&#39;)


<span class="ot">surfaceWeight ::</span> <span class="dt">Mass</span> <span class="ot">-&gt;</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">Weight</span>
surfaceWeight (<span class="dt">Mass</span> otherMass) planet <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">Gravity</span> sg)<span class="fu">=</span> surfaceGravity planet
    <span class="kw">in</span> <span class="dt">Weight</span> <span class="fu">$</span> otherMass <span class="fu">*</span> sg


<span class="ot">runPlanets ::</span> <span class="dt">Double</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()
runPlanets sampleWeight <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">Gravity</span> earthSurfaceGravity) <span class="fu">=</span> surfaceGravity <span class="dt">EARTH</span>

<span class="ot">        massOnEarth ::</span> <span class="dt">Mass</span>
        massOnEarth <span class="fu">=</span> <span class="dt">Mass</span> <span class="fu">$</span> sampleWeight <span class="fu">/</span> earthSurfaceGravity

<span class="ot">        planetToWeight ::</span> [(<span class="dt">Planet</span>, <span class="dt">Weight</span>)]
        planetToWeight <span class="fu">=</span> map (\p <span class="ot">-&gt;</span> (p, surfaceWeight massOnEarth p)) [minBound <span class="fu">..</span> maxBound]

<span class="ot">        render ::</span> (<span class="dt">Planet</span>, <span class="dt">Weight</span>) <span class="ot">-&gt;</span> <span class="dt">String</span>
        render (p, weight) <span class="fu">=</span> <span class="st">&quot;Your weight on &quot;</span> <span class="fu">&lt;&gt;</span> show p <span class="fu">&lt;&gt;</span> <span class="st">&quot; is &quot;</span> <span class="fu">&lt;&gt;</span> (show weight)

    <span class="kw">in</span> mapM_ (putStrLn <span class="fu">.</span> render) planetToWeight</code></pre></div>
<p></details></p>]]></description>
    <pubDate>Thu, 09 Sep 2021 00:00:00 UT</pubDate>
    <guid>http://blog.ssanj.net/posts/2021-09-09-feedback-on-java-planet-enum-in-Haskell.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>Java Planet Enum in Haskell</title>
    <link>http://blog.ssanj.net/posts/2021-08-26-java-planet-enum-in-Haskell.html</link>
    <description><![CDATA[<p>A while back I was trying to implement the <a href="https://docs.oracle.com/javase/tutorial/java/javaOO/enum.html">Java Planet Enum example</a> in Haskell. Below is the Java source taken directly from the Oracle documentation:</p>
<div class="sourceCode"><pre class="sourceCode java scrollx"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">enum</span> Planet {
    <span class="fu">MERCURY</span> (<span class="fl">3.303e+23</span>, <span class="fl">2.4397e6</span>),
    <span class="fu">VENUS</span>   (<span class="fl">4.869e+24</span>, <span class="fl">6.0518e6</span>),
    <span class="fu">EARTH</span>   (<span class="fl">5.976e+24</span>, <span class="fl">6.37814e6</span>),
    <span class="fu">MARS</span>    (<span class="fl">6.421e+23</span>, <span class="fl">3.3972e6</span>),
    <span class="fu">JUPITER</span> (<span class="fl">1.9e+27</span>,   <span class="fl">7.1492e7</span>),
    <span class="fu">SATURN</span>  (<span class="fl">5.688e+26</span>, <span class="fl">6.0268e7</span>),
    <span class="fu">URANUS</span>  (<span class="fl">8.686e+25</span>, <span class="fl">2.5559e7</span>),
    <span class="fu">NEPTUNE</span> (<span class="fl">1.024e+26</span>, <span class="fl">2.4746e7</span>);

    <span class="kw">private</span> <span class="dt">final</span> <span class="dt">double</span> mass;   <span class="co">// in kilograms</span>
    <span class="kw">private</span> <span class="dt">final</span> <span class="dt">double</span> radius; <span class="co">// in meters</span>
    <span class="fu">Planet</span>(<span class="dt">double</span> mass, <span class="dt">double</span> radius) {
        <span class="kw">this</span>.<span class="fu">mass</span> = mass;
        <span class="kw">this</span>.<span class="fu">radius</span> = radius;
    }
    <span class="kw">private</span> <span class="dt">double</span> <span class="fu">mass</span>() { <span class="kw">return</span> mass; }
    <span class="kw">private</span> <span class="dt">double</span> <span class="fu">radius</span>() { <span class="kw">return</span> radius; }

    <span class="co">// universal gravitational constant  (m3 kg-1 s-2)</span>
    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="dt">double</span> G = <span class="fl">6.67300E-11</span>;

    <span class="dt">double</span> <span class="fu">surfaceGravity</span>() {
        <span class="kw">return</span> G * mass / (radius * radius);
    }
    <span class="dt">double</span> <span class="fu">surfaceWeight</span>(<span class="dt">double</span> otherMass) {
        <span class="kw">return</span> otherMass * <span class="fu">surfaceGravity</span>();
    }
    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {
        <span class="kw">if</span> (args.<span class="fu">length</span> != <span class="dv">1</span>) {
            System.<span class="fu">err</span>.<span class="fu">println</span>(<span class="st">&quot;Usage: java Planet &lt;earth_weight&gt;&quot;</span>);
            System.<span class="fu">exit</span>(-<span class="dv">1</span>);
        }
        <span class="dt">double</span> earthWeight = Double.<span class="fu">parseDouble</span>(args[<span class="dv">0</span>]);
        <span class="dt">double</span> mass = earthWeight/EARTH.<span class="fu">surfaceGravity</span>();
        <span class="kw">for</span> (Planet p : Planet.<span class="fu">values</span>())
           System.<span class="fu">out.printf</span>(<span class="st">&quot;Your weight on </span><span class="ch">%s</span><span class="st"> is </span><span class="ch">%f%n</span><span class="st">&quot;</span>,
                             p, p.<span class="fu">surfaceWeight</span>(mass));
    }
}</code></pre></div>
<p>This seemed fairly easy. I started off by modelling a Planet and associated data:</p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="kw">data</span> <span class="dt">Planet</span> <span class="fu">=</span> <span class="dt">MERCURY</span>
            <span class="fu">|</span> <span class="dt">VENUS</span>
            <span class="fu">|</span> <span class="dt">EARTH</span>
            <span class="fu">|</span> <span class="dt">MARS</span>
            <span class="fu">|</span> <span class="dt">JUPITER</span>
            <span class="fu">|</span> <span class="dt">SATURN</span>
            <span class="fu">|</span> <span class="dt">URANUS</span>
            <span class="fu">|</span> <span class="dt">NEPTUNE</span> <span class="kw">deriving</span> (<span class="dt">Enum</span>, <span class="dt">Bounded</span>, <span class="dt">Show</span>)


<span class="kw">newtype</span> <span class="dt">Mass</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="dt">Double</span>


<span class="kw">newtype</span> <span class="dt">Radius</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="dt">Double</span>


<span class="kw">data</span> <span class="dt">PlanetStat</span> <span class="fu">=</span>
    <span class="dt">PlanetStat</span> {
<span class="ot">        mass   ::</span> <span class="dt">Mass</span>
    ,<span class="ot">   radius ::</span> <span class="dt">Radius</span>
    }

<span class="kw">newtype</span> <span class="dt">SurfaceGravity</span> <span class="fu">=</span> <span class="dt">SurfaceGravity</span> <span class="dt">Double</span>


<span class="kw">newtype</span> <span class="dt">SurfaceWeight</span> <span class="fu">=</span> <span class="dt">SurfaceWeight</span> <span class="dt">Double</span>

<span class="ot">gConstant ::</span> <span class="dt">Double</span>
gConstant <span class="fu">=</span> <span class="fl">6.67300E-11</span></code></pre></div>
<p>One difference between Haskell and OOP languages is that Haskell separates out data from behaviour while OOP languages combine data (or state) and behaviour into one construct - a class.</p>
<div class="figure">
<img src="/images/java-planet-enum/java-haskell-state-behaviour.png" alt="State and Behaviour in OOP vs FP" />
<p class="caption">State and Behaviour in OOP vs FP</p>
</div>
<p>In Java, <code>surfaceGravity</code> and <code>surfaceWeight</code> are bound to a particular Planet instance. In Haskell, as mentioned above, we don’t have behaviour and state stored together. How do we go about implementing these functions in Haskell?</p>
<p>Instead of having state and behaviour combined, we can <strong>use</strong> the state to derive any behaviour we need:</p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="ot">surfaceGravity ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">SurfaceGravity</span>
surfaceGravity planet <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">PlanetStat</span> (<span class="dt">Mass</span> mass) (<span class="dt">Radius</span> radius)) <span class="fu">=</span> planetStat planet
    <span class="kw">in</span> <span class="dt">SurfaceGravity</span> <span class="fu">$</span> gConstant <span class="fu">*</span> mass <span class="fu">/</span> (radius <span class="fu">*</span> radius)


<span class="ot">surfaceWeight ::</span> <span class="dt">Mass</span> <span class="ot">-&gt;</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">SurfaceWeight</span>
surfaceWeight (<span class="dt">Mass</span> otherMass) planet <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">SurfaceGravity</span> sg)<span class="fu">=</span> surfaceGravity planet
    <span class="kw">in</span> <span class="dt">SurfaceWeight</span> <span class="fu">$</span> otherMass <span class="fu">*</span> sg</code></pre></div>
<p>Notice how we pass in the <code>Planet</code> instance we need to each function above. We don’t have a <code>this</code> reference as in most OOP languages. Here’s the Java implementation of the above functions with an explicit <code>this</code> reference added:</p>
<div class="sourceCode"><pre class="sourceCode java scrollx"><code class="sourceCode java">    <span class="dt">double</span> <span class="fu">surfaceGravity</span>() {
        <span class="kw">return</span> G * <span class="kw">this</span>.<span class="fu">mass</span> / (<span class="kw">this</span>.<span class="fu">radius</span> * <span class="kw">this</span>.<span class="fu">radius</span>);
    }

    <span class="dt">double</span> <span class="fu">surfaceWeight</span>(<span class="dt">double</span> otherMass) {
        <span class="kw">return</span> otherMass * <span class="kw">this</span>.<span class="fu">surfaceGravity</span>();
    }</code></pre></div>
<p>That solves one problem, but there’s another. It has to do with retrieving all the values of an enumeration. In the Java example we use:</p>
<div class="sourceCode"><pre class="sourceCode java scrollx"><code class="sourceCode java">Planet.<span class="fu">values</span>()</code></pre></div>
<p>How do we get all the values of an enumeration in Haskell?</p>
<p>You may have noticed the <code>deriving (Enum, Bounded ...)</code> syntax against the <code>Planet</code> data type. Using the <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Prelude.html#t:Enum">Enum</a> and <a href="https://hackage.haskell.org/package/base-4.15.0.0/docs/Prelude.html#t:Bounded">Bounded</a> type classes we can retrieve all the values of the <code>Planet</code> sum type:</p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="ot">planetValues ::</span> [<span class="dt">Planet</span>]
planetValues <span class="fu">=</span> [(minBound<span class="ot"> ::</span> <span class="dt">Planet</span>) <span class="fu">..</span> (maxBound<span class="ot"> ::</span> <span class="dt">Planet</span>)]</code></pre></div>
<p>The above code, grabs the first (<code>minBound</code>) and last (<code>maxBound</code>) values of the <code>Planet</code> sum type and the range syntax (<code>..</code>) makes it possible to enumerate all the values in between. Pretty nifty! The range syntax is made possible by having an <code>Enum</code> instance for a data type. See the <code>enumFrom</code>, <code>enumFromThen</code>, <code>enumFromThenTo</code> and <code>enumFromTo</code> functions on the <code>Enum</code> type class for more information.</p>
<p>It’s starting to look like we’ve got this solved pretty easily. Unfortunately we have another small problem. The <code>planetValues</code> function only gives us the <code>Planet</code> sum type - essentially the names of the planets. We also need to retrieve the mass and radius for each planet as per Java:</p>
<div class="sourceCode"><pre class="sourceCode java scrollx"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">enum</span> Planet {
    <span class="fu">MERCURY</span> (<span class="fl">3.303e+23</span>, <span class="fl">2.4397e6</span>),
    <span class="fu">VENUS</span>   (<span class="fl">4.869e+24</span>, <span class="fl">6.0518e6</span>),
    <span class="fu">EARTH</span>   (<span class="fl">5.976e+24</span>, <span class="fl">6.37814e6</span>),
    <span class="fu">MARS</span>    (<span class="fl">6.421e+23</span>, <span class="fl">3.3972e6</span>),
    <span class="fu">JUPITER</span> (<span class="fl">1.9e+27</span>,   <span class="fl">7.1492e7</span>),
    <span class="fu">SATURN</span>  (<span class="fl">5.688e+26</span>, <span class="fl">6.0268e7</span>),
    <span class="fu">URANUS</span>  (<span class="fl">8.686e+25</span>, <span class="fl">2.5559e7</span>),
    <span class="fu">NEPTUNE</span> (<span class="fl">1.024e+26</span>, <span class="fl">2.4746e7</span>);
    ...</code></pre></div>
<p>How do we go about doing this?</p>
<p>We could create a <a href="https://hackage.haskell.org/package/containers-0.6.5.1/docs/Data-Map-Strict.html">Map</a> with <code>Planet</code> as the key and <code>PlanetStat</code> as the value. So far so good. But when we go to look up a value we have to use the <a href="https://hackage.haskell.org/package/containers-0.6.5.1/docs/Data-Map-Strict.html#g:9">lookup</a> function:</p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell">lookup<span class="ot"> ::</span> <span class="dt">Ord</span> k <span class="ot">=&gt;</span> k <span class="ot">-&gt;</span> <span class="dt">Map</span> k a <span class="ot">-&gt;</span> <span class="dt">Maybe</span> a</code></pre></div>
<p>The return type of the <code>lookup</code> function is a <a href="https://hackage.haskell.org/package/base-4.14.1.0/docs/Data-Maybe.html#t:Maybe">Maybe</a>. This means we have to deal with the possibility of not finding a particular <code>Planet</code> (the <code>Nothing</code> case):</p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="co">-- planetMap :: Map Planet PlanetStat</span>

<span class="kw">case</span> (lookup somePlanet planetMap) <span class="kw">of</span>
  <span class="dt">Just</span> planet <span class="ot">-&gt;</span> <span class="co">-- cool planet-related stuff</span>
  <span class="dt">Nothing</span>     <span class="ot">-&gt;</span> <span class="co">-- this should never happen!</span></code></pre></div>
<p>We know this is impossible because we have a sum type for <code>Planet</code>, but because we are using a <code>Map</code> we need to deal with it.</p>
<p>Another way to encode this mapping is like this:</p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="ot">planetStat ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">PlanetStat</span>
planetStat <span class="dt">MERCURY</span> <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">3.303e+23</span>) (<span class="dt">Radius</span> <span class="fl">2.4397e6</span> )
planetStat <span class="dt">VENUS</span>   <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">4.869e+24</span>) (<span class="dt">Radius</span> <span class="fl">6.0518e6</span> )
planetStat <span class="dt">EARTH</span>   <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">5.976e+24</span>) (<span class="dt">Radius</span> <span class="fl">6.37814e6</span>)
planetStat <span class="dt">MARS</span>    <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">6.421e+23</span>) (<span class="dt">Radius</span> <span class="fl">3.3972e6</span> )
planetStat <span class="dt">JUPITER</span> <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">1.9e+27</span>  ) (<span class="dt">Radius</span> <span class="fl">7.1492e7</span> )
planetStat <span class="dt">SATURN</span>  <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">5.688e+26</span>) (<span class="dt">Radius</span> <span class="fl">6.0268e7</span> )
planetStat <span class="dt">URANUS</span>  <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">8.686e+25</span>) (<span class="dt">Radius</span> <span class="fl">2.5559e7</span> )
planetStat <span class="dt">NEPTUNE</span> <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">1.024e+26</span>) (<span class="dt">Radius</span> <span class="fl">2.4746e7</span> )</code></pre></div>
<p>This way we don’t have to deal with any optionality; this is a total function.</p>
<p>It’s interesting that Java gives us this mapping for “free” because it combines state and behaviour. In Haskell you need to bring state and behaviour together as required. A big thanks to my friend <a href="http://twitter.com/ajfitzpatrick">Adam</a> for pointing this out. In hindsight it seems obvious.</p>
<p>And that’s about it for surprises. Here’s the full solution:</p>
<div class="sourceCode"><pre class="sourceCode haskell scrollx"><code class="sourceCode haskell"><span class="kw">import </span><span class="dt">Data.Foldable</span> (traverse_)


<span class="kw">data</span> <span class="dt">Planet</span> <span class="fu">=</span> <span class="dt">MERCURY</span>
            <span class="fu">|</span> <span class="dt">VENUS</span>
            <span class="fu">|</span> <span class="dt">EARTH</span>
            <span class="fu">|</span> <span class="dt">MARS</span>
            <span class="fu">|</span> <span class="dt">JUPITER</span>
            <span class="fu">|</span> <span class="dt">SATURN</span>
            <span class="fu">|</span> <span class="dt">URANUS</span>
            <span class="fu">|</span> <span class="dt">NEPTUNE</span> <span class="kw">deriving</span> (<span class="dt">Enum</span>, <span class="dt">Bounded</span>, <span class="dt">Show</span>)


<span class="kw">newtype</span> <span class="dt">Mass</span> <span class="fu">=</span> <span class="dt">Mass</span> <span class="dt">Double</span>


<span class="kw">newtype</span> <span class="dt">Radius</span> <span class="fu">=</span> <span class="dt">Radius</span> <span class="dt">Double</span>


<span class="kw">data</span> <span class="dt">PlanetStat</span> <span class="fu">=</span>
    <span class="dt">PlanetStat</span> {
<span class="ot">        mass   ::</span> <span class="dt">Mass</span>
    ,<span class="ot">   radius ::</span> <span class="dt">Radius</span>
    }


<span class="kw">newtype</span> <span class="dt">SurfaceGravity</span> <span class="fu">=</span> <span class="dt">SurfaceGravity</span> <span class="dt">Double</span>


<span class="kw">newtype</span> <span class="dt">SurfaceWeight</span> <span class="fu">=</span> <span class="dt">SurfaceWeight</span> <span class="dt">Double</span>

<span class="ot">gConstant ::</span> <span class="dt">Double</span>
gConstant <span class="fu">=</span> <span class="fl">6.67300E-11</span>

<span class="ot">planetStat ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">PlanetStat</span>
planetStat <span class="dt">MERCURY</span> <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">3.303e+23</span>) (<span class="dt">Radius</span> <span class="fl">2.4397e6</span> )
planetStat <span class="dt">VENUS</span>   <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">4.869e+24</span>) (<span class="dt">Radius</span> <span class="fl">6.0518e6</span> )
planetStat <span class="dt">EARTH</span>   <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">5.976e+24</span>) (<span class="dt">Radius</span> <span class="fl">6.37814e6</span>)
planetStat <span class="dt">MARS</span>    <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">6.421e+23</span>) (<span class="dt">Radius</span> <span class="fl">3.3972e6</span> )
planetStat <span class="dt">JUPITER</span> <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">1.9e+27</span>  ) (<span class="dt">Radius</span> <span class="fl">7.1492e7</span> )
planetStat <span class="dt">SATURN</span>  <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">5.688e+26</span>) (<span class="dt">Radius</span> <span class="fl">6.0268e7</span> )
planetStat <span class="dt">URANUS</span>  <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">8.686e+25</span>) (<span class="dt">Radius</span> <span class="fl">2.5559e7</span> )
planetStat <span class="dt">NEPTUNE</span> <span class="fu">=</span> <span class="dt">PlanetStat</span> (<span class="dt">Mass</span> <span class="fl">1.024e+26</span>) (<span class="dt">Radius</span> <span class="fl">2.4746e7</span> )


<span class="ot">surfaceGravity ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">SurfaceGravity</span>
surfaceGravity planet <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">PlanetStat</span> (<span class="dt">Mass</span> mass) (<span class="dt">Radius</span> radius)) <span class="fu">=</span> planetStat planet
    <span class="kw">in</span> <span class="dt">SurfaceGravity</span> <span class="fu">$</span> gConstant <span class="fu">*</span> mass <span class="fu">/</span> (radius <span class="fu">*</span> radius)


<span class="ot">surfaceWeight ::</span> <span class="dt">Mass</span> <span class="ot">-&gt;</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">SurfaceWeight</span>
surfaceWeight (<span class="dt">Mass</span> otherMass) planet <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">SurfaceGravity</span> sg)<span class="fu">=</span> surfaceGravity planet
    <span class="kw">in</span> <span class="dt">SurfaceWeight</span> <span class="fu">$</span> otherMass <span class="fu">*</span> sg


<span class="ot">runPlanets ::</span> <span class="dt">Double</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()
runPlanets earthWeight <span class="fu">=</span>
    <span class="kw">let</span> (<span class="dt">SurfaceGravity</span> earthSurfaceGravity) <span class="fu">=</span> surfaceGravity <span class="dt">EARTH</span>

<span class="ot">        massOnEarth ::</span> <span class="dt">Mass</span>
        massOnEarth <span class="fu">=</span> <span class="dt">Mass</span> <span class="fu">$</span> earthWeight <span class="fu">/</span> earthSurfaceGravity

<span class="ot">        planetValues ::</span> [<span class="dt">Planet</span>]
        planetValues <span class="fu">=</span> [(minBound<span class="ot"> ::</span> <span class="dt">Planet</span>) <span class="fu">..</span> (maxBound<span class="ot"> ::</span> <span class="dt">Planet</span>)]

<span class="ot">        printSurfaceWeight ::</span> <span class="dt">Planet</span> <span class="ot">-&gt;</span> <span class="dt">SurfaceWeight</span> <span class="ot">-&gt;</span> <span class="dt">String</span>
        printSurfaceWeight planet (<span class="dt">SurfaceWeight</span> sw) <span class="fu">=</span> <span class="st">&quot;Your weight on &quot;</span> <span class="fu">&lt;&gt;</span> (show planet) <span class="fu">&lt;&gt;</span> <span class="st">&quot; is &quot;</span> <span class="fu">&lt;&gt;</span> (show sw)

<span class="ot">        planetStatsStrings ::</span> [<span class="dt">String</span>]
        planetStatsStrings <span class="fu">=</span> (\p <span class="ot">-&gt;</span> printSurfaceWeight p (surfaceWeight massOnEarth p)) <span class="fu">&lt;$&gt;</span> planetValues
    <span class="kw">in</span>
       traverse_ putStrLn planetStatsStrings</code></pre></div>
<p>The <a href="https://github.com/ssanj/java-plants-enum-in-haskell">source code</a> for the example can be found on Github.</p>
<p>If there are any easier/better ways to encode this example in Haskell, please free to drop in comment.</p>]]></description>
    <pubDate>Thu, 26 Aug 2021 00:00:00 UT</pubDate>
    <guid>http://blog.ssanj.net/posts/2021-08-26-java-planet-enum-in-Haskell.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>

    </channel>
</rss>
