<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"
    xmlns:dc="http://purl.org/dc/elements/1.1/">
    <channel>
        <title>BabylonCandle</title>
        <link>https://blog.ssanj.net</link>
        <description><![CDATA[The blog of Sanjiv Sahayam]]></description>
        <atom:link href="https://blog.ssanj.net/feed.xml" rel="self"
                   type="application/rss+xml" />
        <lastBuildDate>Sun, 26 Nov 2023 00:00:00 UT</lastBuildDate>
        <item>
    <title>How To Replace A Failing Drive On a ZFS Pool in a TerraMaster D4-300</title>
    <link>https://blog.ssanj.net/posts/2023-11-26-how-to-replace-a-failing-drive-on-a-zfs-pool-in-a-terramaster-d4-300.html</link>
    <description><![CDATA[<p>Having a faulty drive can be stressful. You hope that you’ve backed up all the data you need from it on a regular basis. Also while you source another drive of the same or higher capacity, you hope that any other drives you have don’t also fail.</p>
<p>A real issue is knowing when a drive is about to fail. Have you been regularly running <a href="https://linux.die.net/man/8/smartctl">smartctrl</a> checks? Even if you did chances are that you won’t detect any errors until the drive is about to completely fail. That gives you very little time to rectify the issue.</p>
<p><a href="https://docs.oracle.com/cd/E19253-01/819-5461/zfsover-2/">ZFS</a> can help with <em>some</em> of the above. It can detect when a drive is about to fail and notify you as soon as a failure is detected. Your ZFS pool has you covered (if you have enough disks for redundancy) while you source a replacement drive. Replacing the drive once you get it is “easy” once you know what to do. Hence the reason for this article to document those steps.</p>
<p>To complicate things a little more, I’m running ZFS on an array of disks inside of a <a href="https://www.amazon.com.au/gp/product/B08CN4Z4PC">TerraMaster D4-300</a> via USB-C. The host machine is a <a href="https://www.zimaboard.com/zimaboard/product">Zimaboard 832</a>.</p>
<figure>
<img src="/images/2023-11-26-how-to-replace-a-failing-drive-on-a-zfs-pool-in-a-terramaster-d4-300/terramaster-d4-300.png" alt="Terramaster d4-300" />
<figcaption aria-hidden="true">Terramaster d4-300</figcaption>
</figure>
<p>One thing ZFS doesn’t do for you is to backup your data. It’s recommended that you run regular backups on your data. Having destroyed a ZFS pool in the past, I can attest that the <code>ZFS is not a backup</code>, is a valid statement.</p>
<h2 id="workflow">Workflow</h2>
<p>If a hardware fault occurs and if you regularly schedule ZFS <a href="https://docs.oracle.com/cd/E19253-01/819-5461/gbbxi/index.html">scrub</a>s, it will detect it and marks the drives as <code>FAULTED</code>, <code>OFFLINE</code> or <code>DEGRADED</code>. It’s important to note that if you don’t run regular ZFS scrubs, that it can take a while for the error to be detected. I run scrubs three times a day; around every 8 hours.</p>
<h3 id="verify-the-status-of-the-drive">Verify the status of the drive</h3>
<p>Run a <code>zpool status &lt;YOUR POOL NAME&gt;</code> and verify the status of the faulty drive. You should see something like this:</p>
<pre class="command scrollx"><code>  pool: YOUR POOL NAME
 state: DEGRADED
status: One or more devices are faulted in response to persistent errors.
        Sufficient replicas exist for the pool to continue functioning in a
        degraded state.
action: Replace the faulted device, or use &#39;zpool clear&#39; to mark the device
        repaired.
  scan: scrub in progress since Sun Nov 26 05:30:02 2023
        1013G scanned at 1.20G/s, 297G issued at 359M/s, 1.41T total
        0B repaired, 20.51% done, 00:54:38 to go
config:

        NAME                                     STATE     READ WRITE CKSUM
        YOUR POOL NAME                           DEGRADED     0     0     0
          raidz1-0                               DEGRADED     0     0     0
            scsi-STDAS_TerraMaster_9DB202102202  ONLINE       0     0     0
            scsi-STDAS_TerraMaster_ADB202102202  FAULTED     97     0     0  too many errors
            scsi-STDAS_TerraMaster_BDB202102202  ONLINE       0     0     0
            scsi-STDAS_TerraMaster_CDB202102202  ONLINE       0     0     0</code></pre>
<p>Notice that <code>state</code> is <code>DEGRADED</code> and <code>STDAS_TerraMaster_ADB202102202</code> is <code>FAULTED</code> with <code>too many errors</code>.</p>
<p>The <code>action</code> section tells us what to do:</p>
<blockquote>
<p>Replace the faulted device, or use ‘zpool clear’ to mark the device repaired.</p>
</blockquote>
<p>Note down the degrade drive id <code>STDAS_TerraMaster_ADB202102202</code> for use when replacing the drive.</p>
<h3 id="finding-information-about-the-failed-drive">Finding information about the failed drive</h3>
<p><img src="https://media.giphy.com/media/8vOF5hcAuSa6BkBWFD/giphy.gif" /></p>
<p>The following details will help you identify the physical drive to replace in the enclosure.</p>
<h4 id="find-the-drive-id-and-mappings">Find the drive id and mappings</h4>
<p>Find the <code>drive id</code> and <code>drive mappings</code> for the failed drive with <code>lsblk</code>:</p>
<pre class="terminal scroll"><code>lsblk -o NAME,SIZE,SERIAL,LABEL,FSTYPE,PATH,MODEL</code></pre>
<p>which will have an output similar to:</p>
<pre class="command scrollx"><code>NAME              SIZE SERIAL       LABEL  FSTYPE      PATH                              MODEL
loop0            63.3M                     squashfs    /dev/loop0
loop1            63.3M                     squashfs    /dev/loop1
loop2           111.9M                     squashfs    /dev/loop2
loop3            49.8M                     squashfs    /dev/loop3
loop4            53.2M                     squashfs    /dev/loop4
sda             931.5G 2250E693A93F                    /dev/sda                          CT1000BX500SSD1
├─sda1              1G                     vfat        /dev/sda1
├─sda2              2G                     ext4        /dev/sda2
└─sda3          928.5G                     LVM2_member /dev/sda3
  └─ubuntu--vg-ubuntu--lv
                928.5G                     ext4        /dev/mapper/ubuntu--vg-ubuntu--lv
sdb               2.7T 9DB202102202                    /dev/sdb                          TerraMaster
├─sdb1            2.7T              fspool zfs_member  /dev/sdb1
└─sdb9              8M                                 /dev/sdb9
sdc               3.6T ADB202102202                    /dev/sdc                          TerraMaster
├─sdc1            3.6T              fspool zfs_member  /dev/sdc1
└─sdc9              8M                                 /dev/sdc9
sdd               2.7T CDB202102202                    /dev/sdd                          TerraMaster
├─sdd1            2.7T              fspool zfs_member  /dev/sdd1
└─sdd9              8M                                 /dev/sdd9
sde               3.6T BDB202102202                    /dev/sde                          TerraMaster
mmcblk0          29.1G 0x4efa2725                      /dev/mmcblk0
├─mmcblk0p1       512M                     vfat        /dev/mmcblk0p1
├─mmcblk0p2      27.7G                     ext4        /dev/mmcblk0p2
└─mmcblk0p3       977M                     swap        /dev/mmcblk0p3
mmcblk0boot0        4M 0x4efa2725                      /dev/mmcblk0boot0
mmcblk0boot1        4M 0x4efa2725                      /dev/mmcblk0boot1
</code></pre>
<h4 id="finding-the-drive-makemodel-and-serial-number">Finding the drive make,model and serial number</h4>
<p>To find out the drive information use <code>smartctl</code>:</p>
<pre class="terminal scroll"><code>smartctl -i &quot;$DRIVE_PATH&quot; | grep &#39;Model\|Capacity\|Serial&#39;</code></pre>
<p>where <code>DRIVE_PATH</code> is the path to the new drive. Eg: <code>/dev/sdc</code>.</p>
<p>You should get some output of the form:</p>
<pre class="command scrollx"><code>Model Family:     Western Digital Red
Device Model:     WDC WD30EFRX-68AX9N0
Serial Number:    WD-WCC1T0934440
User Capacity:    3,000,592,982,016 bytes [3.00 TB]</code></pre>
<h4 id="finding-the-disk-id">Finding the disk id</h4>
<p>You need to find the disk id of the drive that failed. You can do that by running <code>by-id</code>:</p>
<pre class="command scrollx"><code>DRIVE_NAME=&quot;YOUR_DRIVE_NAME&quot;
DRIVE_ID=$(ls -l /dev/disk/by-id/ | grep &quot;$DRIVE_NAME&quot; | grep -v &#39;\-part&#39; | grep &#39;scsi-&#39; | cu    t -d&#39; &#39; -f10)
echo &quot;Drive Id:&quot;
while IFS= read -r d; do
  echo &quot;$d&quot;
done &lt;&lt;&lt; &quot;$DRIVE_ID&quot;</code></pre>
<p>Ensure to replace <code>YOUR_DRIVE_NAME</code> with your drive name. Eg. <code>sdc</code>.</p>
<p>You should get an output of the form:</p>
<pre class="command scrollx"><code>Drive Id:
scsi-35000000000000001
scsi-STDAS_TerraMaster_ADB202102202</code></pre>
<p>One of these <code>drive id</code>s should match that failed <code>drive id</code> you noted down <a href="#verify-the-status-of-the-drive">Verify the status of the drive</a>.</p>
<h3 id="replacing-the-physical-drive">Replacing the physical drive</h3>
<p><img src="https://media.giphy.com/media/bnDYyn2HMzqpDEUecP/giphy.gif" /></p>
<ol type="1">
<li>The first thing to do is <code>offline</code> the drive. That ensures that ZFS takes it out of the pool. You can offline the drive with:</li>
</ol>
<pre class="terminal scroll"><code>sudo zpool offline &lt;YOUR POOL NAME&gt; &lt;DRIVE_ID&gt;</code></pre>
<p>For example, in the above scenario <code>STDAS_TerraMaster_ADB202102202</code> was the faulty drive:</p>
<pre class="terminal scrollx"><code>sudo zpool offline YOUR_POOL_NAME STDAS_TerraMaster_ADB202102202</code></pre>
<ul>
<li>Shutdown your machine that has the ZFS pool</li>
</ul>
<p>In the past I’ve seen ZFS get confused when you change drives while everything is online. This is an optional step but I do it for my piece of mind.</p>
<p><code>Note</code>: After a reboot your <code>drive mappings</code> can change. Eg. <code>/dev/sdd</code> can become <code>/dev/sde</code>, but your <code>drive id</code> will be the same: <code>STDAS_TerraMaster_ADB202102202</code>.</p>
<ul>
<li>Turn off the <code>TerraMaster D4-300</code>.</li>
<li>Remove the faulty drive from enclosure.</li>
</ul>
<p>How do you know which drive to remove?</p>
<p>I have a rudimentary labelling scheme where I map each drive make, model, serial number and size to the slot on the TerraMaster D4-300. I have this as postit notes on top of the enclosure.</p>
<p>For example:</p>
<blockquote>
<p>Slot 1: Model Western Digital Red, WDC WD30EFRX-68AX9N0, WD-WCC1T0934440, 4TB</p>
</blockquote>
<blockquote>
<p>Slot 2: ..</p>
</blockquote>
<blockquote>
<p>Slot 3: ..</p>
</blockquote>
<blockquote>
<p>Slot 4: ..</p>
</blockquote>
<ul>
<li>Insert the replacement drive into caddy and put it into the enclosure.</li>
<li>Turn on the <code>TerraMaster D4-300</code>.</li>
</ul>
<blockquote>
<p>Another note is that I can’t seem to cold boot <code>TerraMaster D4-300</code> with all the drives inserted. I am not sure if this is an issue with the <code>TerraMaster D4-300</code> itself or whether I’ve got some other issue with power etc. What I end up doing here is taking all the drives out and inserting them in one at a time until I hear each one boot up. Then I insert the next drive and so on.</p>
</blockquote>
<ul>
<li>Turn your machine back on.</li>
<li>Once your machine boots (and if you got this far, things are looking good), we need to find out some information about the replacement drive such as drive mappings, drive id etc.</li>
</ul>
<h3 id="get-information-about-the-replacement-drive">Get information about the replacement drive</h3>
<p>Find out details about the replacement drive to ensure you’re replacing with the correct drive.</p>
<h4 id="find-the-drive-id-and-mappings-1">Find the drive id and mappings</h4>
<p>Find the drive id for the new drive with <code>lsblk</code>:</p>
<pre class="terminal scroll"><code>lsblk -o NAME,SIZE,SERIAL,LABEL,FSTYPE,PATH,MODEL</code></pre>
<p>which will have an output similar to:</p>
<pre class="command scrollx"><code>NAME              SIZE SERIAL       LABEL  FSTYPE      PATH                              MODEL
loop0            63.3M                     squashfs    /dev/loop0
loop1            63.3M                     squashfs    /dev/loop1
loop2           111.9M                     squashfs    /dev/loop2
loop3            49.8M                     squashfs    /dev/loop3
loop4            53.2M                     squashfs    /dev/loop4
sda             931.5G 2250E693A93F                    /dev/sda                          CT1000BX500SSD1
├─sda1              1G                     vfat        /dev/sda1
├─sda2              2G                     ext4        /dev/sda2
└─sda3          928.5G                     LVM2_member /dev/sda3
  └─ubuntu--vg-ubuntu--lv
                928.5G                     ext4        /dev/mapper/ubuntu--vg-ubuntu--lv
sdb               2.7T 9DB202102202                    /dev/sdb                          TerraMaster
├─sdb1            2.7T              fspool zfs_member  /dev/sdb1
└─sdb9              8M                                 /dev/sdb9
sdc               3.6T ADB202102202                    /dev/sdc                          TerraMaster
├─sdc1            3.6T              fspool zfs_member  /dev/sdc1
└─sdc9              8M                                 /dev/sdc9
sdd               2.7T CDB202102202                    /dev/sdd                          TerraMaster
├─sdd1            2.7T              fspool zfs_member  /dev/sdd1
└─sdd9              8M                                 /dev/sdd9
sde               3.6T BDB202102202                    /dev/sde                          TerraMaster
mmcblk0          29.1G 0x4efa2725                      /dev/mmcblk0
├─mmcblk0p1       512M                     vfat        /dev/mmcblk0p1
├─mmcblk0p2      27.7G                     ext4        /dev/mmcblk0p2
└─mmcblk0p3       977M                     swap        /dev/mmcblk0p3
mmcblk0boot0        4M 0x4efa2725                      /dev/mmcblk0boot0
mmcblk0boot1        4M 0x4efa2725                      /dev/mmcblk0boot1
</code></pre>
<h4 id="finding-the-drive-make-model-and-serial-number">Finding the drive make, model and serial number</h4>
<p>To ensure you’re replacing the correct drive find out the drive information with <code>smartctl</code>:</p>
<pre class="terminal scroll"><code>smartctl -i &quot;$DRIVE_PATH&quot; | grep &#39;Model\|Capacity\|Serial&#39;</code></pre>
<p>where <code>DRIVE_PATH</code> is the path to the new drive. Eg: <code>/dev/sdc</code>.</p>
<p>You should get some output of the form:</p>
<pre class="command scrollx"><code>Model Family:     Western Digital Red
Device Model:     WDC WD30EFRX-68AX9N0
Serial Number:    WD-WCC1T0934440
User Capacity:    3,000,592,982,016 bytes [3.00 TB]</code></pre>
<h4 id="finding-the-disk-id-1">Finding the disk id</h4>
<p>You need to find the disk id of the drive you want to replace. You can do that by running <code>by-id</code>:</p>
<pre class="command scrollx"><code>DRIVE_NAME=&quot;YOUR_DRIVE_NAME&quot;
DRIVE_ID=$(ls -l /dev/disk/by-id/ | grep &quot;$DRIVE_NAME&quot; | grep -v &#39;\-part&#39; | grep &#39;scsi-&#39; | cu    t -d&#39; &#39; -f10)
echo &quot;Drive Id:&quot;
while IFS= read -r d; do
  echo &quot;$d&quot;
done &lt;&lt;&lt; &quot;$DRIVE_ID&quot;</code></pre>
<p>Ensure to replace <code>YOUR_DRIVE_NAME</code> with your drive name. Eg. <code>sdc</code>.</p>
<p>You should get an output of the form:</p>
<pre class="command scrollx"><code>Drive Id:
scsi-35000000000000001
scsi-STDAS_TerraMaster_ADB202102202</code></pre>
<p>You can use any of the ids returned returned to do the ZFS drive replacement. I usually use the <code>scsi-STDAS_TerraMaster_</code> version.</p>
<h3 id="replacing-the-drive-in-the-zfs-pool">Replacing the drive in the ZFS Pool</h3>
<p><img src="https://media.giphy.com/media/ISX4R2mMMWys0/giphy.gif" /></p>
<p>Now that we have all the information we need, we can finally replace the drive in the ZFS pool with <code>zpool replace</code>:</p>
<pre class="terminal scroll"><code>sudo zpool replace &lt;YOUR POOL NAME&gt; &lt;OLD_ID&gt; &lt;NEW DRIVE ID&gt;</code></pre>
<p>For example:</p>
<pre class="terminal scrollx"><code>sudo zpool replace &lt;YOUR POOL NAME&gt; scsi-STDAS_TerraMaster_ADB202102202 /dev/disk/by-id/scsi-STDAS_TerraMaster_ADB202102202</code></pre>
<p>If all goes well, when you do a <code>zpool status &lt;YOUR POOL NAME&gt;</code> you should see :</p>
<pre class="command scrollx"><code>  pool: &lt;YOUR POOL NAME&gt;
 state: DEGRADED
status: One or more devices is currently being resilvered.  The pool will
        continue to function, possibly in a degraded state.
action: Wait for the resilver to complete.
  scan: resilver in progress since Sun Nov 26 06:05:37 2023
        374G scanned at 46.8G/s, 16.0M issued at 2.00M/s, 1.41T total
        0B resilvered, 0.00% done, no estimated completion time
config:

        NAME                                       STATE     READ WRITE CKSUM
        YOUR POOL NAME                             DEGRADED     0     0     0
          raidz1-0                                 DEGRADED     0     0     0
            scsi-STDAS_TerraMaster_9DB202102202    ONLINE       0     0     0
            replacing-1                            DEGRADED     0     0     0
              old                                  OFFLINE      0     0     0
              scsi-STDAS_TerraMaster_ADB202102202  ONLINE       0     0     0
            scsi-STDAS_TerraMaster_BDB202102202    ONLINE       0     0     0
            scsi-STDAS_TerraMaster_CDB202102202    ONLINE       0     0     0

errors: No known data errors</code></pre>
<p>Note that the <code>action</code> states that:</p>
<blockquote>
<p>One or more devices is currently being resilvered</p>
</blockquote>
<p>and the <code>scan</code> states that:</p>
<blockquote>
<p>resilver in progress</p>
</blockquote>
<p>and it states that a replacement is active:</p>
<pre class="command scrollx"><code>            replacing-1                            DEGRADED     0     0     0
              old                                  OFFLINE      0     0     0
              scsi-STDAS_TerraMaster_ADB202102202  ONLINE       0     0     0</code></pre>
<p>Now in a few hours, depending on how much data you have, you should be back good!</p>]]></description>
    <pubDate>Sun, 26 Nov 2023 00:00:00 UT</pubDate>
    <guid>https://blog.ssanj.net/posts/2023-11-26-how-to-replace-a-failing-drive-on-a-zfs-pool-in-a-terramaster-d4-300.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>Package Control Is Missing On Sublime Text 4 On macOSX</title>
    <link>https://blog.ssanj.net/posts/2023-11-01-package-control-is-missing-on-sublime-text-4-on-macos.html</link>
    <description><![CDATA[<p>We use <a href="https://packagecontrol.io/installation">Package Control</a> to install most packages we need with <a href="https://www.sublimetext.com">Sublime Text</a>. While there are other ways this is
the most convenient and provides access to the packages listed on <a href="https://packagecontrol.io">packagecontrol.io</a>.</p>
<p>Recently when I tried to install a new package and launched the Command Palette with <code>CMD</code>+<code>SHIFT</code>+<code>P</code>, I was surprised
to find that I couldn’t find the Package Control commands.</p>
<p>I opened the console panel with <code>^</code>+<code>`</code>, to look for any errors. I found an error related to the ctypes not loading:</p>
<pre class="terminal scrollx"><code>Traceback (most recent call last):
  File &quot;../Library/Application Support/Sublime Text/Installed Packages/Package Control.sublime-package/package_control/deps/oscrypto/_openssl/_libcrypto_ctypes.py&quot;, line 305, in &lt;module&gt;
  File &quot;./python3.3/ctypes/__init__.py&quot;, line 366, in __getattr__
  File &quot;./python3.3/ctypes/__init__.py&quot;, line 371, in __getitem__
AttributeError: dlsym(0x7f876fc44440, EVP_PKEY_size): symbol not found</code></pre>
<p>Cryptic.</p>
<p>My current setup is:</p>
<table>
<thead>
<tr class="header">
<th>Software</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>macOS version</td>
<td><code>Ventura 13.4.1</code></td>
</tr>
<tr class="even">
<td>Sublime Text version</td>
<td><code>Build 4152</code></td>
</tr>
</tbody>
</table>
<p>After a bit of digging around on <a href="https://github.com/sublimehq/sublime_text/issues">Sublime Text Issues</a> I came across <a href="https://github.com/sublimehq/sublime_text/issues/6037">Package Control Commands Missing</a> issue which linked to <a href="https://github.com/wbond/package_control/issues/1612">[ST3/4] Package Control not working on macOS</a> issue on Package Control.</p>
<p>As far as I can tell the issue was related to an OpenSSL version mismatch. While Sublime Text ships with its own
OpenSSL library, Package Control relies on the OpenSSL version provided by the OS - macOS in this case.</p>
<p>The <a href="https://github.com/wbond/package_control/issues/1612#issuecomment-1643609833">workaround</a> that worked for me was:</p>
<ol type="1">
<li><a href="https://github.com/wbond/package_control/releases/download/4.0.0-beta2/Package.Control.sublime-package">Download</a> the latest release (beta) of Package Control</li>
<li>Close Sublime Text</li>
<li>Open a terminal and go to your <code>Installed Packages</code> folder for Sublime Text. This can be found at <code>/Users/YOUR_USER/Library/Application Support/Sublime Text/Installed Packages</code>. You can also use <code>Sublime Text</code> &gt; <code>Settings...</code> &gt; <code>Browse Packages...</code> from the menu and go back one up directory to locate the <code>Installed Packages</code> folder.</li>
<li>Backup your <code>Package Control.sublime-package</code> which should be found under the <code>Installed Packages</code> folder.</li>
<li>Copy the <code>Package.Control.sublime-package</code> you downloaded in step one to the <code>Installed Packages</code> folder. Rename it to <code>Package Control.sublime-package</code>. Notice how you renamed a <code>Package.Control</code> to a <code>Package Control</code>.</li>
<li>Restart Sublime Text</li>
</ol>
<p>Now hopefully that fixes your Package Control issues. If not check back on the linked issues for other resolutions.</p>]]></description>
    <pubDate>Wed, 01 Nov 2023 00:00:00 UT</pubDate>
    <guid>https://blog.ssanj.net/posts/2023-11-01-package-control-is-missing-on-sublime-text-4-on-macos.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>How To Flash Libre Firmware on to an LG Bluray Drive on macOSX</title>
    <link>https://blog.ssanj.net/posts/2023-10-02-how-to-flash-libre-firmware-on-to-a-lg-bluray-drive-on-macosx.html</link>
    <description><![CDATA[<p>I recently wanted to update the firmware of my <a href="https://www.amazon.com.au/gp/product/B00E7B08MS/">LG WH16NS40</a> to the <a href="https://forum.makemkv.com/forum/viewtopic.php?t=18856">LibreDrive</a> firmware. This would allow the drive to read discs from all regions and also allow for faster read access. It is also needed to read UHD discs.</p>
<p>My MakeMKV drive details before the update:</p>
<pre class="terminal scrollx"><code>Drive Information
OS device name: /dev/rdisk5
Current profile: BD-ROM
Manufacturer: HL-DT-ST
Product: BD-RE WH16NS40
Revision: 1.05
Serial number: M00M1PE1426
Firmware date: 2120-05-06 14:40
Bus encryption flags: 17
Highest AACS version: 78

LibreDrive Information
Status: Possible (with patched firmware)
Drive platform: MT1959
Harware support: Yes
Firmware support: No
Firmware type: Original (patched version available)
Firmware version: 1.05
DVD all regions: Possible (with patched firmware)
BD raw data read: Possible (with patched firmware)
BD raw metadata read: Possible (with patched firmware)
Unrestricted read speed: Possible (with patched firmware)

No disc inserted</code></pre>
<p>To see if your drive is supported look for the <code>Status: Possible (with patched firmware)</code> comment. The <a href="https://forum.makemkv.com/forum/viewtopic.php?f=16&amp;t=19634">MakeMKV forums</a> have a full list of LibreDrive firmware supported drives, if you want to purchase a new one.</p>
<p>As always this information is for reading and encoding discs you own and not for any other purposes.</p>
<p>Also use at your own risk; these steps worked for me and it may not work for you even if you have the same drive. Check the MakeMKV forums for more information if you are unsure.</p>
<p><img src="https://media.giphy.com/media/RHOwWKH5OY7buuGHNi/giphy.gif" /></p>
<p>This is a summary of steps from various MakeMKV forums posts and the <a href="https://www.youtube.com/watch?v=jyQV1aPlbow">“Ultra HAX0R” GUIDE V2 for encrypted firmware to Make your Drive UHD friendly</a> YouTube video.</p>
<p>Before you start, ensure the value of your <code>Drive platform</code> is <code>MT1959</code>:</p>
<pre class="terminal scrollx"><code>Drive platform: MT1959</code></pre>
<h2 id="steps">Steps</h2>
<ol type="1">
<li><p>Download and extract the <a href="https://www.makemkv.com/download/mk-firmware-pack-20200720.zip">all you need firmware pack</a></p></li>
<li><p>Locate the firmware for your drive model in the pack. For my drive it was at <code>mk-firmware-pack-20200720/MK/HL-DT-ST/WH16NS40-NS50/HL-DT-ST-BD-RE_WH16NS40-NS50-1.05-NM00900-212005061440.bin</code>.</p>
<p>The date on the firmware should roughly match that displayed in the MakeMKV drive details. In the MakeMKV details section the firmware date was listed as <code>Firmware date: 2120-05-06 14:40</code>, which maps to <code>212005061440</code>, which is the date at the end of the bin file: <code>-212005061440.bin</code>.</p>
<p>Generally the format seems to be:</p>
<p><code>TYPE_OF_DRIVE</code>-<code>DRIVE_MODEL</code>-<code>FIRMWARE_VERSION</code>-<code>NOT_SURE_WHAT_THIS_IS</code>_<code>DATE</code>.bin</p>
<p>For my drive is it:</p>
<p><code>HL-DT-ST-BD-RE-WH16NS40-NS50-1.05-NM00900-212005061440.bin</code></p>
<p><br/></p></li>
<li><p>The <code>Ultra HAX0R" GUIDE V2 for encrypted firmware to Make your Drive UHD friendly</code> mentions that some newer firmware needs to be flashed encrypted. A rudimentary list is given below. Please check the MakeMKV forums for a more updated list.</p>
<p>Know Encrypted firmware:</p>
<ul>
<li>WH16NS60 1.03</li>
<li>WH16NS40 1.05 &lt;– my firmware</li>
<li>WH14NS40 1.05</li>
<li>BH16NS55 1.05</li>
<li>BU40N 1.04</li>
</ul></li>
</ol>
<p><br/></p>
<ol start="4" type="1">
<li>Find location of MKV installation; usually it’s under <code>/Applications/MakeMKV.app</code></li>
<li>Look for an executable named <code>makemkvcon</code> under the MakeMVK installation folder above: <code>/Applications/MakeMKV.app/Contents/MacOS/makemkvcon</code></li>
<li>Find the name of the drive you want flash with:</li>
</ol>
<pre class="terminal scrollx"><code>makemkvcon f -l</code></pre>
<p>On my machine it’s <code>/IOBDServices/8A6BA6DF</code>:</p>
<pre class="terminal scrollx"><code>00: /IOBDServices/8A6BA6DF
  HL-DT-ST_BD-RE__WH16NS40_1.05_212005061440_M00M1PE1426</code></pre>
<ol start="7" type="1">
<li>Verify the drive can be used with the tool using the following:</li>
</ol>
<pre class="terminal scrollx"><code>makemkvcon f -d DRIVE help</code></pre>
<p>For example:</p>
<pre class="terminal scrollx"><code>makemkvcon f -d /IOBDServices/8A6BA6DF help</code></pre>
<p>You should see something similar to the following:</p>
<pre class="terminal scrollx"><code>MTK19xx firmware module v1.30

Commands:

  dump [auto|full|user]
  Dumps firmware image
    dump full      - dumps full rom image (if not disabled in firmware)
    dump user      - dumps non-volatile user data
    dump auto      - dumps full image if possible, user data otherwise

  rawflash [&lt;flag&gt;,&lt;flag=value&gt;,...]
    Sends the image and flashing flags to drive
    for flashing in self-update mode
  flags:
    main           - flashes main firmware (this is the default)
    full           - flashes boot loader and main firmware (Caution!!!)
    de             - sets DE byte in image
    enc            - encrypts firmware before sending to drive
    slim           - force USB slim drive handshake</code></pre>
<ol start="8" type="1">
<li>Run the following command to flash the new firmware to your drive. Use the <code>enc</code> parameter if your drive is listed as having encrypted firmware as mentioned above. Check the forums if you’re unsure about your drive.</li>
</ol>
<p><img src="https://media.giphy.com/media/MFIsOqzodLr7ewnkUb/giphy.gif" /></p>
<pre class="terminal scrollx"><code> makemkvcon f --all-yes -d /IOBDServices/8A6BA6DF rawflash enc -i LOCATION_OF_FIRMWARE/LG-BD-RE-WH16NS40/HL-DT-ST-BD-RE_WH16NS40-NS50-1.05-NM00900-212005061440.bin</code></pre>
<p>Example output:</p>
<pre class="terminal scrollx"><code>Reading input file LG-BD-RE-WH16NS40/HL-DT-ST-BD-RE_WH16NS40-NS50-1.05-NM00900-212005061440.bin
Flashing flags = 0x0 : 0 0 0 0 : ---- ---- ---- ----
Sending image in encrypted format
Current Drive ID: HL-DT-ST_BD-RE__WH16NS40_1.05_212005061440_M00M1PE1426
Ready to write drive flash memory. (auto confirmed)
Operation started: Sending flash image to drive
 100% Operation finished
Operation started: Programming flash
 100% Operation finished

Program Flash NG 06/29/00

Command produced error code 0x82062900
</code></pre>
<p>It looks like it encountered an error:</p>
<pre class="terminal scrollx"><code>Command produced error code 0x82062900</code></pre>
<p><img src="https://media.giphy.com/media/l0Iy7ukGEfG2JUKTC/giphy.gif" /></p>
<p>A quick look through the MakeMKV forums mentions that if you see <code>Command produced error code 0x82062900</code> it can be <a href="https://forum.makemkv.com/forum/viewtopic.php?f=16&amp;t=22896&amp;p=138110&amp;hilit=Command+produced+error+code+0x82062900#p138110">safely ignored</a>. Phew!</p>
<ol start="9" type="1">
<li>Launch MakeMKV and you should see LibreDrive support enabled:</li>
</ol>
<p><img src="/images/2023-10-02-how-to-flash-libre-firmware-on-to-a-lg-bluray-drive-on-macosx/libre-drive-support.png" /></p>
<ol start="10" type="1">
<li>Use your drive through MakeMKV and ensure it’s working as expected.</li>
</ol>
<p>I managed to read a Bluray disc at faster speeds than usual, at least for some of the time. I have yet to try discs from different regions.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://forum.makemkv.com/forum/viewtopic.php?t=19113">Flashing-drives-on-macos</a></li>
<li><a href="https://www.makemkv.com/download/mk-firmware-pack-20200720.zip">All you need firmware pack</a></li>
<li><a href="https://blog.paco.to/2023/ripping-bluray-disks-free-easy/">Ripping Bluray Disc</a></li>
<li><a href="https://www.reddit.com/r/makemkv/comments/mvz5h8/ultimate_uhd_drives_flashing_guide_updated_2021/">Reddit guide to flashing drives</a></li>
<li><a href="https://www.youtube.com/watch?v=jyQV1aPlbow">“Ultra HAX0R” GUIDE V2 for encrypted firmware to Make your Drive UHD friendly</a></li>
<li><a href="https://www.amazon.com.au/gp/product/B00E7B08MS/">LG WH16NS40</a></li>
</ul>]]></description>
    <pubDate>Mon, 02 Oct 2023 00:00:00 UT</pubDate>
    <guid>https://blog.ssanj.net/posts/2023-10-02-how-to-flash-libre-firmware-on-to-a-lg-bluray-drive-on-macosx.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>How to see Stdout When Running Tests in Rust</title>
    <link>https://blog.ssanj.net/posts/2023-09-24-how-to-see-stdout-when-running-tests-in-rust.html</link>
    <description><![CDATA[<p>When coming to Rust from other languages, you expect certain frameworks to behave the same. One such instance, is that if you write to stdout through something like <code>println!</code> when running a test, you expect to see the output when the test is run.</p>
<p>By default Rust captures <code>stdout</code> and <code>stderr</code> when you run a test. Actually this applies only to tests that pass. If a test fails then both <code>stdout</code> and <code>stderr</code> are written out so you may have more information to fix the failing test.</p>
<blockquote>
<p>In hindsight I think this is a good default, because who hasn’t see a test suite dumping out copious amounts of content to <code>stdout</code>? In the end this output is usually ignored and it just becomes noise. And you have to sit through just in case a test fails and you need to see all things the test was doing before it failed.</p>
</blockquote>
<p>If you want to always write the contents of <code>stdout</code> and <code>stderr</code> then you can run tests with the <code>--nocapture</code> flag:</p>
<pre class="terminal"><code>cargo test -- --nocapture</code></pre>
<p>From the <a href="https://doc.rust-lang.org/rustc/tests/index.html#--nocapture">docs</a>:</p>
<blockquote>
<p>—-nocapture</p>
<p>Does not capture the stdout and stderr of the test, and allows tests to print to the console. Usually the output is captured, and only displayed if the test fails.</p>
</blockquote>
<p>This is fine if you’re are running a single test, but if you are running multiple tests in parallel then the output can be interleaved. This can make it hard to follow what’s actually going on.</p>
<p>The recommended option, if you need all test output in order, is to use the <code>--show-output</code> flag:</p>
<pre class="terminal"><code>cargo test -- --show-output</code></pre>
<p>The downside of the above is that all the output is written out <em>after</em> all the tests have completed instead of <em>while</em> the tests are running.</p>
<p>From the <a href="https://doc.rust-lang.org/rustc/tests/index.html#--show-output">docs</a></p>
<blockquote>
<p>—-show-output</p>
<p>Displays the stdout and stderr of successful tests after all tests have run.</p>
<p>Contrast this with —-nocapture which allows tests to print while they are running, which can cause interleaved output if there are multiple tests running in parallel, —-show-output ensures the output is contiguous, but requires waiting for all tests to finish.</p>
</blockquote>]]></description>
    <pubDate>Sun, 24 Sep 2023 00:00:00 UT</pubDate>
    <guid>https://blog.ssanj.net/posts/2023-09-24-how-to-see-stdout-when-running-tests-in-rust.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>How to run a Scheduled Script on macOSX</title>
    <link>https://blog.ssanj.net/posts/2023-05-31-how-to-run-a-scheduled-script-on-macOSX.html</link>
    <description><![CDATA[<p>At the risk of stating the obvious: macOS has its own way of doing things. When I wanted to run a scheduled script using
Cron, the standard response seemed to be that <a href="https://apple.stackexchange.com/questions/12819/why-is-cron-being-deprecated">Crontab is deprecated</a> and to use <code>launchd</code> instead.</p>
<figure>
<img src="https://media.giphy.com/media/I2a5q9dyo9CaU9BtEY/giphy.gif" alt="sigh" />
<figcaption aria-hidden="true">sigh</figcaption>
</figure>
<p>There are two main types of <code>Job</code>s that can be run through <code>launchd</code>:</p>
<ul>
<li><code>Agent</code>s - Which run as the currently logged in user</li>
<li><code>Daemon</code>s - Which run as any user specified (such as root)</li>
</ul>
<p>Jobs are defined in terms of <code>plist</code> files. <code>plist</code> files are XML files which can be registered with the <code>launchd</code> system.
There’s an excellent guide at <a href="https://www.launchd.info/">launchd.info</a> on how to setup all things <code>launchd</code> if you want to know more.</p>
<p>Below are the steps required to setup a simple <code>launchd</code> <code>Agent</code> to run a script at a given time each day.</p>
<h2 id="define-the-job">Define the Job</h2>
<p><code>Agent</code> <code>Job</code> definitions are stored at <code>~/Library/LaunchAgents</code>. The file name of <code>Job</code> definition file is of the form:</p>
<p><code>&lt;NAMESPACE&gt;.&lt;SCRIPT&gt;.plist</code></p>
<p>The <code>NAMESPACE</code> can be something unique to your computer such as a reversed domain name.
<code>SCRIPT</code> is the name of your script.</p>
<p><strong>Note</strong>: <em>This is the format I use. Feel free to change this up as you like.</em></p>
<p>For example to create a <code>backup</code> script for a computer at <code>machinex.ssanj.net</code>, we would create the following <code>plist</code>:</p>
<pre class="terminal scrollx"><code>~/Library/LaunchAgents/net.ssanj.machinex.backup.plist</code></pre>
<details>
<summary>
Here is a simple <code>Job</code> definition for a script that should run daily at some time:
</summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode xml scrollx"><code class="sourceCode xml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> <span class="dt">plist</span> PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;<span class="dt">&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">plist</span><span class="ot"> version=</span><span class="st">&quot;1.0&quot;</span>&gt;</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">dict</span>&gt;</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;Label&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">string</span>&gt;NAMESPACE.SCRIPT&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;WorkingDirectory&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">string</span>&gt;YOUR_WORKING_DIRECTORY&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;StandardOutPath&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">string</span>&gt;PATH_TO_YOUR_STDOUT_FILE&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;StandardErrorPath&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">string</span>&gt;PATH_TO_YOUR_STDERR_FILE&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;ProgramArguments&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">array</span>&gt;</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">string</span>&gt;PATH_TO_YOUR_SCRIPT&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">array</span>&gt;</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;StartCalendarInterval&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">dict</span>&gt;</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">key</span>&gt;Hour&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">integer</span>&gt;HOUR_TO_RUN_AT&lt;/<span class="kw">integer</span>&gt;</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">key</span>&gt;Minute&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">integer</span>&gt;MINUTE_WIHIN_HOUR_TO_RUN_AT&lt;/<span class="kw">integer</span>&gt;</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">dict</span>&gt;</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">dict</span>&gt;</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">plist</span>&gt;</span></code></pre></div>
</details>
<details>
<summary>
For example:
</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode xml scrollx"><code class="sourceCode xml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> <span class="dt">plist</span> PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;<span class="dt">&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">plist</span><span class="ot"> version=</span><span class="st">&quot;1.0&quot;</span>&gt;</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">dict</span>&gt;</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;Label&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">string</span>&gt;net.ssanj.machinex.backup&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;WorkingDirectory&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">string</span>&gt;/Users/sanj/backups&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;StandardOutPath&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">string</span>&gt;/Users/sanj/backups/logs/backup.stdout&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;StandardErrorPath&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">string</span>&gt;/Users/sanj/backups/logs/backup.stderr&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;ProgramArguments&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">array</span>&gt;</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">string</span>&gt;/Users/sanj/backups/backup.sh&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">array</span>&gt;</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;StartCalendarInterval&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">dict</span>&gt;</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">key</span>&gt;Hour&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">integer</span>&gt;10&lt;/<span class="kw">integer</span>&gt;</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">key</span>&gt;Minute&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">integer</span>&gt;30&lt;/<span class="kw">integer</span>&gt;</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">dict</span>&gt;</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">key</span>&gt;EnvironmentVariables&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">dict</span>&gt;</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>             &lt;<span class="kw">key</span>&gt;PATH&lt;/<span class="kw">key</span>&gt;</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>             &lt;<span class="kw">string</span>&gt;/opt/homebrew/bin:/opt/homebrew/sbin:/Users/sanj/bin:/bin:/usr/bin:/usr/local/bin&lt;/<span class="kw">string</span>&gt;</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">dict</span>&gt;</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">dict</span>&gt;</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">plist</span>&gt;</span></code></pre></div>
</details>
<p>There are many more parameters that can be customised to suite your needs. Have a look at <a href="https://www.launchd.info/">launchd.info</a> for more.</p>
<h2 id="job-manipulation">Job Manipulation</h2>
<p>You can manipulate <code>Job</code> characteristics using the <a href="https://support.apple.com/en-au/guide/terminal/apdc6c1077b-5d5d-4d35-9c19-60f2397b2369/mac">launchctl</a> command.</p>
<h3 id="activate-job">Activate Job</h3>
<p>To activate the <code>Job</code> use the <code>load</code> subcommand:</p>
<pre class="terminal scrollx"><code>launchctl load ~/Library/LaunchAgents/&lt;NAMESPACE&gt;.&lt;SCRIPT&gt;.plist</code></pre>
<h3 id="verify-job">Verify Job</h3>
<p>To verify the <code>Job</code> is activated use the <code>list</code> subcommand:</p>
<pre class="terminal scrollx"><code>launchctl list &lt;NAMESPACE&gt;.&lt;SCRIPT&gt;</code></pre>
<p>If this fails ensure you have loaded the correct <code>Job</code> and there are no issues with the <code>plist</code> file.</p>
<h3 id="deactivate-job">Deactivate Job</h3>
<p>To deactivate the <code>Job</code> use the <code>unload</code> subcommand:</p>
<pre class="terminal scrollx"><code>launchctl unload ~/Library/LaunchAgents/&lt;NAMESPACE&gt;.&lt;SCRIPT&gt;.plist</code></pre>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>Ensure to check your <code>StandardOutPath</code> and <code>StandardErrorPath</code> files for any errors should your script fail to run as expected. Also check that your script is correctly defined in the <code>plist</code> file and has appropriate execution rights etc.</p>
<figure>
<img src="https://media.giphy.com/media/xTiTnirRhNvRJiSf96/giphy.gif" alt="Godspeed" />
<figcaption aria-hidden="true">Godspeed</figcaption>
</figure>]]></description>
    <pubDate>Wed, 31 May 2023 00:00:00 UT</pubDate>
    <guid>https://blog.ssanj.net/posts/2023-05-31-how-to-run-a-scheduled-script-on-macOSX.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>Thanks for the Feedback - Douglas Stone & Sheila Heen</title>
    <link>https://blog.ssanj.net/posts/2023-05-24-thanks-for-the-feedback-douglas-stone-sheila-heen.html</link>
    <description><![CDATA[<p>Ideas from the book <a href="https://www.amazon.com.au/Thanks-Feedback-Science-Receiving-Well/dp/0670922633/">Thanks for the Feedback</a></p>
<ul>
<li>Our need for acceptance and our need to improve are both affected by feedback. Often these are competing needs.</li>
<li>Actively seeking out feedback in a work environment can lead to significant positive gains if handled properly.</li>
<li>Our inherent triggers are barriers to us hearing feedback, accepting it and learning from it.</li>
<li>Try to ensure that you understand feedback before accepting or rejecting it.</li>
</ul>
<h2 id="types-of-feedback">Types of Feedback</h2>
<table>
<thead>
<tr class="header">
<th>Type of Feedback</th>
<th>Giver’s Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Appreciation</td>
<td>Thank, motivate and connect</td>
</tr>
<tr class="even">
<td>Coaching</td>
<td>Improve capabilities and identify blind spots</td>
</tr>
<tr class="odd">
<td>Evaluation</td>
<td>Rating or decision making</td>
</tr>
</tbody>
</table>
<ul>
<li>Ensure you know which type of feedback is being given.</li>
<li>Explicitly ask for the type that you are after to avoid confusion.</li>
<li>If you’re giving feedback check with the receiver that the feedback is being received in the type requested.</li>
<li>Clarify what the feedback means without jumping into conclusions See <a href="#additional-prompts">Additional Prompts</a></li>
<li>Feedback is subjective to the person giving it. It’s shaped by their experiences and temperament. Ask for examples. Find out what “good” looks like in the future.</li>
<li>All feedback is Data + Judgement call (based on their experience of the world) -&gt; Label -&gt; Future consequences (as they see it)</li>
</ul>
<h2 id="how-others-see-your-actions">How Others see your Actions</h2>
<h3 id="the-gap-map">The Gap Map</h3>
<p><img src="/images/2023-05-24-thanks-for-the-feedback-douglas-stone-sheila-heen/the-gap-map-2023-05-24-2137.png" width="600" /></p>
<ul>
<li>We focus on our intentions in a situation. Others focus on the effect our actions have on them in the same situation.</li>
<li>We blame the situation for our failure. Others blame our character for the failure.</li>
<li>We downplay our emotions in a situation while others experience them in an amplified way.</li>
</ul>
<h2 id="blind-spots">Blind Spots</h2>
<ul>
<li>You can get honest feedback from someone that dislikes you or with someone you don’t get along with.</li>
<li>Ask the people you have the hardest time with to give you feedback.</li>
<li>Discuss separate topics separately. Identify the different streams and call them out. Focus on one stream at a time.</li>
<li>Each of us only sees one side of the problem.</li>
<li>Each of us is involved in the problem to different degrees.</li>
<li>Notice if you are reacting to the other person.</li>
<li>The three issues of a relationship system:
<ol type="1">
<li>Differences - Are the difference between us causing problems?</li>
<li>Roles - Is this a result of the roles we play?</li>
<li>Processes - Are processes, politics, physical environment etc making the problem worse?</li>
</ol></li>
</ul>
<blockquote>
<p>when it comes to stories about yourself, you get what you Google</p>
</blockquote>
<ul>
<li>Look for the good or look for the bad. You’ll always find something to answer you query.</li>
</ul>
<h2 id="feedback">Feedback</h2>
<ul>
<li>How you perceive feedback is based on three things:
<ul>
<li>Baseline - how happy or sad are we generally</li>
<li>Swing - How far off the base line are you pushed by positive or negative events</li>
<li>Sustain and Recovery - How long are you pushed away from your baseline due to a positive or negative event?</li>
</ul></li>
</ul>
<p>Feedback Quadrant</p>
<table>
<tr>
<th>
</th>
<th scope="col">
Long Sustain of Positive
</th>
<th scope="col">
Short Sustain of Positive
</th>
</tr>
<tr>
<th scope="row">
Quick Recovery from Negative
</th>
<td>
Low risk, high reward. “I love feedback”
</td>
<td>
Low risk, low reward. “No big deal either way”
</td>
</tr>
<tr>
<th scope="row">
Slow Recovery from Negative
</th>
<td>
High risk, high reward. “I’m hopeful but fearful”
</td>
<td>
High risk, low reward. “I hate feedback”
</td>
</tr>
</table>
<p><img src="/images/2023-05-24-thanks-for-the-feedback-douglas-stone-sheila-heen/feedback-quadrant-2023-05-24-2112.png" width="800" /></p>
<ul>
<li>We can extend the positive feelings we get from positive feedback by recalling it regularly from memory.</li>
<li>Feelings exaggerate feedback.</li>
<li>Figure out how you typically react to feedback (do you get defensive or appreciative?)</li>
<li>Check in with yourself during a feedback session to see how you are doing.</li>
<li>Notice how you embellish the story.</li>
<li>Things to keep in mind:
<ul>
<li><strong>Time</strong> - The present doesn’t change the past and <strong>may</strong> determine the future.</li>
<li><strong>Specificity</strong> - Being bad at one thing does not make you bad at everything. Just because you’re bad at something now, doesn’t mean you’ll always be bad at it.</li>
<li><strong>People</strong> - Just because one person doesn’t like us doesn’t mean that everyone doesn’t like us. People’s views change over time.</li>
</ul></li>
<li>Our predictions of the future are often wrong.</li>
<li>Imagine the feedback is not about you but of someone else. What advice would you give that person on how to respond?</li>
<li>Ask: “How significant this feedback would be X years from now?”</li>
</ul>
<blockquote>
<p>Tragedy + Time = Comedy</p>
</blockquote>
<ul>
<li>See your life as an amusing play. Don’t take everything so seriously.</li>
<li>You can’t control what other people think of you.</li>
</ul>
<h2 id="second-score">Second Score</h2>
<p>The first score is the feedback itself. The second is the score you give yourself for handling the feedback, and your subsequent improvements (if any).</p>
<h2 id="setting-boundaries">Setting Boundaries</h2>
<ul>
<li>Set limits on feedback. You can dictate the time, frequency or say no to the way it’s delivered.</li>
</ul>
<blockquote>
<p>Unhelpful feedback is useless: relentless unhelpful feedback is destructive</p>
</blockquote>
<ul>
<li>If the person doesn’t care about the effect of feedback on you or is not listening, then there is something wrong with the dynamic.</li>
<li>Let the person giving you feedback know the kind of feedback you do want.</li>
<li>Use <code>And</code> instead of <code>But</code>. <code>And</code> signifies that two things are true not just one.</li>
</ul>
<blockquote>
<p>I have been afraid to talk to you about this <em>and</em> it’s important to me to be honest with you</p>
</blockquote>
<ul>
<li>The <a href="https://en.wikipedia.org/wiki/J_curve">J curve</a>: A J curve is any of a variety of J-shaped diagrams where a curve initially falls, then steeply rises above the starting point.</li>
</ul>
<blockquote>
<p>Things might get worse before they get better.</p>
</blockquote>
<p><img src="/images/2023-05-24-thanks-for-the-feedback-douglas-stone-sheila-heen/jcurve-2023-05-24-0940.png" width="350"
/></p>
<ul>
<li>Try on different feedback for a while (eg. A couple of weeks). If it’s not working discard it.</li>
<li>Make it easy for people to give you feedback. Don’t demand that it be delivered in a specific way.</li>
<li>Feedback should be specific doing your current job more effectively.</li>
<li>Have a balanced view.</li>
</ul>
<p>Ask:</p>
<blockquote>
<p>What’s wrong with this feedback?</p>
</blockquote>
<p>Then ask:</p>
<blockquote>
<p>What’s right about this feedback?</p>
</blockquote>
<ul>
<li>You don’t always have to accept feedback.</li>
<li>Encourage people to think about the feedback and their second score.</li>
<li>Ask people to coach you on how to give better feedback.</li>
</ul>
<h2 id="additional-prompts">Additional Prompts</h2>
<ul>
<li>Can you give me an example?</li>
<li>Can you help me understand your feedback?</li>
<li>What did that mean to you?</li>
<li>What do you see that’s getting in my own way?</li>
<li>How did that impact you?</li>
<li>What’s most upsetting to you and why?</li>
<li>What could I do to help me improve?</li>
<li>What am I contributing to the problem between us?</li>
<li>What does this mean for me?</li>
<li>What will happen next?</li>
<li>What is expected of me?</li>
<li>Given where I am now, what should I do next?</li>
<li>I wonder if this feedback sits in my blind spot?</li>
<li>Have I heard this feedback before?</li>
<li>What will happen if I follow this feedback?</li>
<li>Is this about helping me grow and improve?</li>
<li>Is this something about our relationship dynamics?</li>
<li>What do I feel?</li>
<li>What’s the story I am telling?</li>
<li>What’s the actual feedback?</li>
<li>What is the feedback not about?</li>
</ul>]]></description>
    <pubDate>Wed, 24 May 2023 00:00:00 UT</pubDate>
    <guid>https://blog.ssanj.net/posts/2023-05-24-thanks-for-the-feedback-douglas-stone-sheila-heen.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>Change Cockpit Launch Port on Ubuntu Server</title>
    <link>https://blog.ssanj.net/posts/2023-03-22-change-copilot-launch-port-on-ubuntu-server.html</link>
    <description><![CDATA[<p><a href="https://cockpit-project.org/">Cockpit</a> runs on the popular port 9090. Chances are that you are going to have a port conflict if you have a couple of other services running. This will lead to Cockpit failing to start.</p>
<p>If you suspect this is the case you can verify it by running:</p>
<pre class="terminal scrollx"><code>sudo systemctl status cockpit.socket</code></pre>
<p>or by tailing the syslog:</p>
<pre class="terminal scrollx"><code>tail /var/log/syslog</code></pre>
<p>If you do see any errors about Cockpit not starting due to a port conflict, it’s quite easy to rectify. These instructions are for Ubuntu Server Jammy (22.04.2).</p>
<ol type="1">
<li>Create or edit the <code>/etc/systemd/system/cockpit.socket.d/listen.conf</code> file</li>
<li>Change the <code>ListenStream</code> option to match your required port</li>
</ol>
<p>The default option will be similar to:</p>
<pre class="config scrollx"><code>[Socket]
ListenStream=
ListenStream=443</code></pre>
<p>Change it to match your required port:</p>
<pre class="config scrollx"><code>[Socket]
ListenStream=
ListenStream=&lt;YOUR_NEW_PORT&gt;</code></pre>
<p>Note: the empty <code>ListenStream=</code> directive is needed to reset the previous value of this field. You can find more information about this on the <a href="https://cockpit-project.org/guide/latest/listen">Cockpit documentation</a></p>
<ol start="3" type="1">
<li>Finally, restart the services to make the change take effect:</li>
</ol>
<pre class="terminal scrollx"><code>sudo systemctl daemon-reload
sudo systemctl restart cockpit.socket</code></pre>]]></description>
    <pubDate>Wed, 22 Mar 2023 00:00:00 UT</pubDate>
    <guid>https://blog.ssanj.net/posts/2023-03-22-change-copilot-launch-port-on-ubuntu-server.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>Docker Compose Fails with Network Has Active Endpoints Error</title>
    <link>https://blog.ssanj.net/posts/2023-03-13-docker-compose-fails-with-network-has-active-endpoints-error.html</link>
    <description><![CDATA[<p>While running <code>docker compose down</code> on a docker compose stack, I came across this error:</p>
<blockquote>
<p>network <ID> has active endpoints</p>
</blockquote>
<p>Now if I listed the docker networks with:</p>
<pre class="terminal scrollx"><code>docker network ls</code></pre>
<p>I could see the offending network listed:</p>
<pre class="terminal scrollx"><code>NETWORK ID     NAME                           DRIVER    SCOPE
2222a222222a   &lt;OFFENDING NETWORK NAME&gt;       bridge    local</code></pre>
<p>Now I could probably fix this by removing the offending network with:</p>
<pre class="terminal scrollx"><code>docker network rm &lt;OFFENDING NETWORK NAME&gt;</code></pre>
<p>A quick <a href="https://stackoverflow.com/questions/42842277/docker-compose-down-default-network-error">Google</a> pointed me in the right direction to get things working as expected. The network I was trying to remove was being used by an orphaned container.</p>
<p>Running the following fixed the issue:</p>
<pre class="terminal scrollx"><code>docker compose down --remove-orphans</code></pre>
<p>This can occur if you run <code>docker run</code> or equivalent without the <code>--rm</code> parameter, where container is not removed after the command exits.</p>]]></description>
    <pubDate>Mon, 13 Mar 2023 00:00:00 UT</pubDate>
    <guid>https://blog.ssanj.net/posts/2023-03-13-docker-compose-fails-with-network-has-active-endpoints-error.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>How To Connect The Brother Hl-2170W To Wifi on macOSX</title>
    <link>https://blog.ssanj.net/posts/2023-01-11-how-to-connect-the-brother-hl-2170w-to-wifi.html</link>
    <description><![CDATA[<p>I recently wanted to connect my <a href="https://support.brother.com/g/b/spec.aspx?c=us&amp;lang=en&amp;prod=hl2170w_all">Brother HL-2170W</a> laser printer to my Wifi network. I had always used the wired Ethernet
connection prior. The <a href="https://support.brother.com/g/s/id/htmldoc/printer/cv_hl2140/eng/html/nug/index.html">Network User’s Guide</a> mentioned installing a Brother application to configure the printer to use Wifi:</p>
<blockquote>
<p>To connect your printer to your wireless network, you need to follow the steps in the Quick Setup Guide or the Network User’s Guide. We recommend that you use the Brother installer application on the CD-ROM which we have provided with the printer. By using this application, you can easily connect your printer to your wireless network and install the network software and printer driver which you need to complete the configuration of your printer for a wireless network. You will be guided by the on-screen instructions until you are able to use your Brother wireless network printer.</p>
</blockquote>
<p>Have a read of the <a href="https://support.brother.com/g/s/id/htmldoc/printer/cv_hl2140/eng/html/index.html">HL-2170W manual</a> for more specific information.</p>
<p>Given how old this printer was, I didn’t fancy my chances of getting their software to work on the current version of macOSX (12.6.3). Also MacBooks have not shipped with a CD-ROM for many years, so using the CD-ROM was not a viable option. I also didn’t see the utility mentioned available for download on their download site, so that was a no go. :|</p>
<p>Most network printers have some sort of web admin application where you can update settings. I hit the IP address of the
printer in a browser: <code>http://printer_ip_address</code> and was greeted by an admin panel:</p>
<figure>
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-admin-panel.png" alt="Admin Panel" />
<figcaption aria-hidden="true">Admin Panel</figcaption>
</figure>
<p>If you don’t know what the IP address of your printer is you have two options:</p>
<ol type="1">
<li>Find the DHCP address of your printer from your Router. This is assuming that the printer is using DHCP from your router.</li>
<li>Press the “Go” button (the big white button on the bottom left side of your printer) three times and the printer should printer out
a bunch of statistics about the printer along with its IP address.</li>
</ol>
<figure>
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/go-button.png" alt="Go Button" />
<figcaption aria-hidden="true">Go Button</figcaption>
</figure>
<h2 id="update-the-admin-and-user-passwords">Update the admin and user Passwords</h2>
<p>The default admin credentials to the admin settings (red key) are:</p>
<ul>
<li>login: admin</li>
<li>password: access</li>
</ul>
<p>The default user credentials to the user settings (green key) are:</p>
<ul>
<li>login: user</li>
<li>password: access</li>
</ul>
<figure>
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-key-settings.png" alt="Setting Types" />
<figcaption aria-hidden="true">Setting Types</figcaption>
</figure>
<p>It’s a good idea to change the above credentials to something stronger.</p>
<p>One issue I ran across when entering long or complex passwords (over 20 alphanumeric and symbolic characters), was that the system would accept it but you would not be able to log into the admin with those updated credentials. Boo! If this happens you will need to reset your printer to factory defaults. See <a href="#reset-printer-to-factory-defaults">Reset Printer to Factory Defaults</a> for details.</p>
<p>What seems to work best is a short alphanumeric password. I tried up to seven characters and left it at that. It may support higher lengths but given that I had already had to reset my printer multiple times, I chose to stop there.</p>
<p>While this is not great, it’s better than the default combinations.</p>
<h2 id="update-firmware">Update Firmware</h2>
<p>Next it would be good to update the printer to its latest firmware to get any bug fixes and security patches etc.</p>
<p>You can download the latest (1.17 as of writing this) from <a href="https://support.brother.com/g/b/downloadtop.aspx?c=au&amp;lang=en&amp;prod=hl2170w_all">Brother’s 2170W Downloads page</a>. Please choose the OS version you want to download the firmware for.</p>
<p>For macOSX, the latest macOSX version is <a href="https://support.brother.com/g/b/downloadlist.aspx?c=au&amp;lang=en&amp;prod=hl2170w_all&amp;os=10060">10.15.x</a>. It seemed to work on macOSX 12.6.3 without a hitch.</p>
<h2 id="activate-wifi">Activate Wifi</h2>
<ul>
<li>Log into the admin panel as the admin user</li>
<li>Choose the <code>Network Configuration</code> link</li>
</ul>
<figure>
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-admin-panel-choose-network-configuration.png" alt="Network Configuration" />
<figcaption aria-hidden="true">Network Configuration</figcaption>
</figure>
<ul>
<li>Choose the <code>Wireless</code> interface</li>
<li>Verify that the Wireless interface is <code>Inactive</code></li>
<li>Choose the <code>Configure Wireless</code> link</li>
</ul>
<figure>
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-admin-panel-wireless-network-configuration.png" alt="Configure Wireless" />
<figcaption aria-hidden="true">Configure Wireless</figcaption>
</figure>
<ul>
<li>Choose the following settings:</li>
</ul>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 23%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="header">
<th>Setting</th>
<th>Value</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Communication Mode</td>
<td><code>Infrastructure Mode</code></td>
<td>-</td>
</tr>
<tr class="even">
<td>Wireless Network Name (SSID)</td>
<td>-</td>
<td><code>Browse</code> to choose your SSID and channel. This can take a while</td>
</tr>
<tr class="odd">
<td>Authentication Method</td>
<td>WPA/WPA2-PSK</td>
<td>Or your authentication method</td>
</tr>
<tr class="even">
<td>Encryption Mode</td>
<td>AES</td>
<td>or your encryption mode</td>
</tr>
<tr class="odd">
<td>Passphrase</td>
<td><strong>Your Wifi Password</strong></td>
<td>-</td>
</tr>
</tbody>
</table>
<figure>
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-wifi-settings.png" alt="Wifi Settings" />
<figcaption aria-hidden="true">Wifi Settings</figcaption>
</figure>
<ul>
<li>Click <code>Submit</code></li>
<li>Wait for the following message to display:</li>
</ul>
<figure>
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-wifi-settings-saved.png" alt="Confirmation-1" />
<figcaption aria-hidden="true">Confirmation-1</figcaption>
</figure>
<ul>
<li>Wait for the second confirmation message to display:</li>
</ul>
<figure>
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-wifi-settings-enable-wireless-confirmation.png" alt="Confirmation-2" />
<figcaption aria-hidden="true">Confirmation-2</figcaption>
</figure>
<ul>
<li>Click <code>Yes</code>. This disables your wired Ethernet connection to the printer</li>
<li>Wait for the third confirmation message:</li>
</ul>
<figure>
<img src="/images/how-to-connect-the-brother-h12170w-to-wifi/brother-2170w-wifi-settings-wireless-restart.png" alt="Confirmation-3" />
<figcaption aria-hidden="true">Confirmation-3</figcaption>
</figure>
<ul>
<li>Unplug the Ethernet cable and restart the printer</li>
<li>Give the printer a few minutes to connect to your wireless network</li>
<li>Find the IP address of the printer from your Router</li>
<li>Try and open the admin panel again using your new IP address: <code>http://&lt;wifi_ip_address&gt;</code></li>
</ul>
<p>If you can access the admin panel of the printer you’re all set! Well done! If you can’t see the <a href="#troubleshooting">troubleshooting</a> section.</p>
<p>Once you’re satisfied your printer is working correctly, assign a static IP address to MAC address of your printer’s wireless network card through your router. This ensures that the printer will always get the same IP address.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>If the printer does not turn up as a wireless client on your router’s DHCP lease table, something’s gone wrong! Oh noes!
Since you’ve switched to the Wireless interface, your wired network interface does not work. Your only option is to <a href="#reset-printer-to-factory-defaults">Reset Printer to Factory Defaults</a> and try the steps again, ensuring all your Wifi connection details are correct.</p>
<p>I had to do this number of times so I feel your pain.</p>
<h2 id="reset-printer-to-factory-defaults">Reset Printer to Factory Defaults</h2>
<p>If you need to <a href="https://support.brother.com/g/s/id/htmldoc/printer/cv_hl2140/eng/html/ug/index.html?page=chapter4_3_4.html&amp;search=reset&amp;mySearch=reset">reset your printer</a> to factory defaults by doing the following:</p>
<ol type="1">
<li>Turn off the printer</li>
<li>Make sure that the front cover is closed and the power cord is plugged in</li>
<li>Hold down the Go button as you turn on the power switch. Keep the Go button pressed down until the Toner, Drum and Error LEDs light up. Release the Go button. Make sure that all the LEDs turn off</li>
<li>Press the Go button seven times. Make sure that all the LEDs light up to indicate the print server has been reset to its default settings</li>
</ol>
<h2 id="links">Links</h2>
<ul>
<li><a href="https://discussions.apple.com/thread/7408889">set up a Brother HL2170W to print wireless to Mac book Air</a></li>
</ul>]]></description>
    <pubDate>Wed, 11 Jan 2023 00:00:00 UT</pubDate>
    <guid>https://blog.ssanj.net/posts/2023-01-11-how-to-connect-the-brother-hl-2170w-to-wifi.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>
<item>
    <title>macOS Loses Connection To Bluetooth Mouse</title>
    <link>https://blog.ssanj.net/posts/2022-11-16-macos-loses-connection-to-bluetooth-mouse.html</link>
    <description><![CDATA[<p>I am not a big fan of using Bluetooth for connecting to peripherals. They inevitably stop working at some point and
you’re left without a working keyboard or mouse or both.</p>
<p>Recently I suspended my scepticism and purchased the <a href="https://www.logitech.com/en-au/products/mice/lift-vertical-ergonomic-mouse-mac.910-006470.html">Logitech Lift for Mac</a>. I was getting some RSI and wanted to try out this vertical mouse.</p>
<figure>
<img src="/images/macos-loses-connection-to-bluetooth-mouse/logitech-lift-for-mac.png" alt="Logitech Lift for Mac" />
<figcaption aria-hidden="true">Logitech Lift for Mac</figcaption>
</figure>
<p>The mouse is exceptional. It was working really well, until one day, as expected, the mouse could not be detected by macOS (Monterey).</p>
<blockquote>
<p>Curse your sudden but inevitable betrayal!</p>
</blockquote>
<p>Since I knew this day would come, I had a handy wired USB mouse close by. Surprisingly even after disabling and enabling
Bluetooth the mouse would not pair on its previous channel.</p>
<p>I changed channels and finally got the mouse to pair. This was quite annoying as now I had two channels bound to
the same computer. I did some Googling and found that <a href="https://apple.stackexchange.com/questions/251842/how-to-restart-bluetooth-service-from-command-line">killing the Bluetooth daemon</a> seemed to solve the problem. Once the daemon is killed, a new instance is automatically started.</p>
<h2 id="script-it">Script it</h2>
<p>I created a small Bash script to do that. In order to use the script I had use <code>gnu-sed</code> as opposed to the default <code>sed</code> implementation that ships with macOS, because I wanted to do some Regex replacements.</p>
<p>You can install it via <a href="https://brew.sh/">brew</a>:</p>
<pre class="terminal scrollx"><code>brew install gnu-sed</code></pre>
<p>If you want to make <code>gnu-sed</code> your default <code>sed</code>, then you can just add it to your path as mentioned in <a href="https://medium.com/@bramblexu/install-gnu-sed-on-mac-os-and-set-it-as-default-7c17ef1b8f64">this</a> article.</p>
<p>The kill script: <code>kill-bluetooth.sh</code> is as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash scrollx"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="va">PROC_ID</span><span class="op">=</span><span class="va">$(</span><span class="fu">ps</span> aux <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&#39;bluetoothd&#39;</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-v</span> <span class="st">&#39;grep&#39;</span> <span class="kw">|</span> <span class="ex">/usr/local/opt/gnu-sed/libexec/gnubin/sed</span> <span class="at">-E</span> <span class="st">&#39;s/\s+/ /g&#39;</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;bluetoothd Proc Id: </span><span class="va">$PROC_ID</span><span class="st">&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> kill <span class="at">-9</span> <span class="st">&quot;</span><span class="va">$PROC_ID</span><span class="st">&quot;</span></span></code></pre></div>
<p>These are the steps followed in the script:</p>
<ol type="1">
<li>Find any processes named “bluetoothd” (<code>ps aux | grep 'bluetoothd'</code>)</li>
<li>Unfortunately this also returns the grep we ran above. Exclude it. (<code>grep -v 'grep'</code>)</li>
<li>Any time we have more than a single space, replace it with a single space (<code>sed -E 's/\s+/ /g'</code>)</li>
<li>Split the output by spaces and get the second field which is the process id(<code>cut -d' ' -f2</code>)</li>
<li>Assign the process id to <code>PROC_ID</code></li>
<li>Write out <code>PROC_ID</code> to the terminal (<code>echo "bluetoothd Proc Id: $PROC_ID"</code>)</li>
<li>Kill the process with the process id of <code>PROC_ID</code> (<code>sudo kill -9 "$PROC_ID"</code>)</li>
</ol>
<p>I’ve explicitly specified the path to the <code>gnu-sed</code> implementation because I want to run this script through <a href="https://www.alfredapp.com/">Alfred</a>. More on that later.</p>
<p>Running the above script fixes the problem when Bluetooth fails to detect my mouse!</p>
<figure>
<img src="https://media.giphy.com/media/uJw7UcWYutgQM/giphy.gif" alt="Hooray" />
<figcaption aria-hidden="true">Hooray</figcaption>
</figure>
<h2 id="make-alfred-do-it">Make Alfred do it</h2>
<p>But what if we could make it even easier? And we can, by running it through an <a href="https://www.alfredapp.com/help/workflows/actions/run-script/">Alfred Workflow script</a>.</p>
<p>One thing we will need is to give the script administrative privileges in order to run the <code>sudo</code> command. We can do this by wrapping it in an <a href="https://developer.apple.com/library/archive/technotes/tn2065/_index.html#//apple_ref/doc/uid/DTS10003093-CH1-TNTAG1-HOW_DO_I_PASS_AN_APPLESCRIPT_VARIABLE_TO_MY_SHELL_COMMAND_">AppleScript</a>:</p>
<pre class="command scrollx"><code>do shell script &quot;/bin/bash PATH_TO_SCRIPT/kill-bluetooth.sh&quot; with administrator privileges</code></pre>
<figure>
<img src="/images/macos-loses-connection-to-bluetooth-mouse/alfred-workflow-script.png" alt="Alfred Workflow Script" />
<figcaption aria-hidden="true">Alfred Workflow Script</figcaption>
</figure>
<p>This will now prompt you for the administrator password when running the script.</p>
<p>And now you can simply define a keyword to such as “Relaunch Bluetooth” to launch your Alfred Workflow and restart your <code>bluetoothd</code> daemon.</p>
<figure>
<img src="/images/macos-loses-connection-to-bluetooth-mouse/alfred-workflow.png" alt="Alfred Workflow" />
<figcaption aria-hidden="true">Alfred Workflow</figcaption>
</figure>
<figure>
<img src="/images/macos-loses-connection-to-bluetooth-mouse/relaunch-bluetooth.png" alt="Relaunch Bluetooth" />
<figcaption aria-hidden="true">Relaunch Bluetooth</figcaption>
</figure>]]></description>
    <pubDate>Wed, 16 Nov 2022 00:00:00 UT</pubDate>
    <guid>https://blog.ssanj.net/posts/2022-11-16-macos-loses-connection-to-bluetooth-mouse.html</guid>
    <dc:creator>sanjiv sahayam</dc:creator>
</item>

    </channel>
</rss>
